
> rest-express@1.0.0 test:run
> vitest --run tests/integration/api.test.ts tests/integration/documents.test.ts


[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mC:/software/cyberdocgen[39m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:38:30.023Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:38:30.023Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"b79f35ca-4430-4bcd-9bc3-6c1d26bc45ee","spanId":"26ba69d1","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.170Z"}
[32m2026-01-17T15:38:30.172Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.172Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:38:30.178Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"b79f35ca-4430-4bcd-9bc3-6c1d26bc45ee","spanId":"26ba69d1","method":"GET","path":"/","statusCode":200,"duration":16,"timestamp":"2026-01-17T15:38:30.186Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"4edf82f6-7fa3-4238-aa15-9d89de59d722","spanId":"bcce14fd","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.203Z"}
[32m2026-01-17T15:38:30.203Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.203Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:38:30.204Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:38:30.208Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"4edf82f6-7fa3-4238-aa15-9d89de59d722","spanId":"bcce14fd","method":"GET","path":"/","statusCode":200,"duration":6,"timestamp":"2026-01-17T15:38:30.209Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"0a0f74e4-47a3-4ca7-ae45-a217fbb7992b","spanId":"a8db1779","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.230Z"}
[32m2026-01-17T15:38:30.231Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.231Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:38:30.231Z [WARN] Unknown API route accessed {"path":"/document-templates/iso-001","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"0a0f74e4-47a3-4ca7-ae45-a217fbb7992b","spanId":"a8db1779","method":"GET","path":"/iso-001","statusCode":200,"duration":2,"timestamp":"2026-01-17T15:38:30.232Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:38:30.232Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.232Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return AI health status
2026-01-17T15:38:30.235Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"0ba24ade-69b8-4ad0-8530-5f1b5c4d5d17","spanId":"445235ab","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.241Z"}
[32m2026-01-17T15:38:30.242Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.242Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"739835b2-fd00-4db7-9004-2d9687e5ef7c","spanId":"58a21ad0","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.243Z"}
[32m2026-01-17T15:38:30.244Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.244Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:38:30.242Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"0ba24ade-69b8-4ad0-8530-5f1b5c4d5d17","spanId":"445235ab","method":"GET","path":"/api/auth/user","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:38:30.247Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
2026-01-17T15:38:30.244Z [WARN] Unknown API route accessed {"path":"/documents/generate","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"739835b2-fd00-4db7-9004-2d9687e5ef7c","spanId":"58a21ad0","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:38:30.248Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"07f1d966-3bbe-4703-8795-e7d8dc3b69c4","spanId":"29da611b","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.255Z"}
[32m2026-01-17T15:38:30.255Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.255Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
2026-01-17T15:38:30.256Z [WARN] Unknown API route accessed {"path":"/documents/upload-and-extract","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"07f1d966-3bbe-4703-8795-e7d8dc3b69c4","spanId":"29da611b","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:38:30.258Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"85e0a916-6aa2-41db-b352-b18ce5bfffec","spanId":"f01e137b","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.262Z"}
[32m2026-01-17T15:38:30.262Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.262Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"c35be55f-63ca-465d-8042-78dcd13f4673","spanId":"566e0751","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.263Z"}
[32m2026-01-17T15:38:30.264Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.264Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
2026-01-17T15:38:30.263Z [WARN] Unknown API route accessed {"path":"/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"85e0a916-6aa2-41db-b352-b18ce5bfffec","spanId":"f01e137b","method":"POST","path":"/export-document","statusCode":200,"duration":3,"timestamp":"2026-01-17T15:38:30.265Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for company profiles
2026-01-17T15:38:30.264Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"c35be55f-63ca-465d-8042-78dcd13f4673","spanId":"566e0751","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:38:30.266Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"38eba537-ff8f-4fc6-b9d3-c2fa6886076e","spanId":"ed5d06fb","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.276Z"}
[32m2026-01-17T15:38:30.276Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.276Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"34438146-24c6-4a80-bed5-227c13ee620a","spanId":"e88354f8","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.276Z"}
[32m2026-01-17T15:38:30.276Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.276Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
2026-01-17T15:38:30.276Z [WARN] Unknown API route accessed {"path":"/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for documents
2026-01-17T15:38:30.277Z [WARN] Unknown API route accessed {"path":"/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"38eba537-ff8f-4fc6-b9d3-c2fa6886076e","spanId":"ed5d06fb","method":"POST","path":"/export-document","statusCode":400,"duration":1,"timestamp":"2026-01-17T15:38:30.277Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"34438146-24c6-4a80-bed5-227c13ee620a","spanId":"e88354f8","method":"GET","path":"/api/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:38:30.278Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"aee12316-5be3-498f-8aee-abc1628c9550","spanId":"69bac7b9","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.281Z"}
[32m2026-01-17T15:38:30.281Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.281Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document AI Generation > should reject generation request without framework
2026-01-17T15:38:30.281Z [WARN] Unknown API route accessed {"path":"/generate-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"aee12316-5be3-498f-8aee-abc1628c9550","spanId":"69bac7b9","method":"POST","path":"/api/generate-document","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:38:30.282Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_start","traceId":"1c6ca09c-ba04-4912-aa5d-0372ff134e80","spanId":"488f0477","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.287Z"}
[32m2026-01-17T15:38:30.287Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.287Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
2026-01-17T15:38:30.288Z [WARN] Unknown API route accessed {"path":"/analyze-document-quality","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_end","traceId":"1c6ca09c-ba04-4912-aa5d-0372ff134e80","spanId":"488f0477","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:38:30.289Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"b7662092-af81-4683-a778-e2a7b3e685e3","spanId":"ac323ef7","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.289Z"}
[32m2026-01-17T15:38:30.289Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.289Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
2026-01-17T15:38:30.289Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"b7662092-af81-4683-a778-e2a7b3e685e3","spanId":"ac323ef7","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:38:30.290Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 297[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"9c4ba020-a420-44e4-80f5-fa44657ff162","spanId":"2689a357","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.296Z"}
[32m2026-01-17T15:38:30.296Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.296Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version history
2026-01-17T15:38:30.297Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"9c4ba020-a420-44e4-80f5-fa44657ff162","spanId":"2689a357","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:38:30.304Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"1b52b5d7-eb72-47d5-b277-69262a1f3176","spanId":"f062e384","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.309Z"}
[32m2026-01-17T15:38:30.309Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.309Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
2026-01-17T15:38:30.309Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"1b52b5d7-eb72-47d5-b277-69262a1f3176","spanId":"f062e384","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:38:30.310Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"a57bf43c-a21c-49ff-8653-c6b536d74bbc","spanId":"ccee5eae","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.313Z"}
[32m2026-01-17T15:38:30.313Z [INFO] POST /api/documents/test-id/versions/version-id/restore {"method":"POST","url":"/api/documents/test-id/versions/version-id/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.313Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
2026-01-17T15:38:30.313Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/version-id/restore","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"a57bf43c-a21c-49ff-8653-c6b536d74bbc","spanId":"ccee5eae","method":"POST","path":"/documents/test-id/versions/version-id/restore","statusCode":400,"duration":1,"timestamp":"2026-01-17T15:38:30.314Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"3cba1835-a7f8-4a17-af4f-922296f2e454","spanId":"49334d97","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.317Z"}
[32m2026-01-17T15:38:30.317Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.317Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Comparison > should require authentication for version comparison
2026-01-17T15:38:30.317Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/1/compare/2","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"3cba1835-a7f8-4a17-af4f-922296f2e454","spanId":"49334d97","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:38:30.318Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"399eb715-4049-4af2-9f89-ff8b144d540a","spanId":"1645640e","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.321Z"}
[32m2026-01-17T15:38:30.321Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.321Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should save a document with valid data
2026-01-17T15:38:30.321Z [WARN] Unknown API route accessed {"path":"/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"399eb715-4049-4af2-9f89-ff8b144d540a","spanId":"1645640e","method":"POST","path":"/api/save-document","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:38:30.322Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"63f74440-ec2a-4292-ae32-24302feb53ad","spanId":"06de3454","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:38:30.324Z"}
[32m2026-01-17T15:38:30.325Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:38:30.325Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should reject save request without required fields
2026-01-17T15:38:30.325Z [WARN] Unknown API route accessed {"path":"/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"63f74440-ec2a-4292-ae32-24302feb53ad","spanId":"06de3454","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:38:30.326Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 332[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[32m 39[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[32m 34[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 5[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 200, 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[32m 5[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 4[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 4[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 2 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
AssertionError: expected [ 200, 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/documents.test.ts:120:31
    118|         });
    119| 
    120|       expect([200, 500, 503]).toContain(response.status);
       |                               ^
    121|     });
    122|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/2]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/2]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (2)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m18 passed[39m[22m[90m (20)[39m
[2m   Start at [22m 07:38:26
[2m   Duration [22m 3.46s[2m (transform 806ms, setup 302ms, collect 4.02s, tests 629ms, environment 0ms, prepare 1.21s)[22m

