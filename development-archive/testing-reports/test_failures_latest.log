
> rest-express@1.0.0 test
> vitest


[1m[44m DEV [49m[22m [34mv3.2.4 [39m[90mC:/software/cyberdocgen[39m

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/ai/evaluation-suite.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 11[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/unit/logger.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/unit/validation.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/unit/documents.test.ts [2m([22m[2m23 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/workflow-integration.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/critical-user-flows.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 16[2mms[22m[39m
stderr | tests/integration/health.test.ts > Health Check Endpoints > GET /health > should return health status
2026-01-17T15:28:56.406Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > GET /health > should include check results
2026-01-17T15:28:56.453Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > GET /health > should return overall status based on checks
2026-01-17T15:28:56.474Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > GET /ready > should return readiness status
2026-01-17T15:28:56.486Z [ERROR] Database health check failed {"error":"Unknown error"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/unit/aiGuardrails.test.ts [2m([22m[2m40 tests[22m[2m)[22m[32m 254[2mms[22m[39m
stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.605Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.606Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.607Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.608Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.609Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.611Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.612Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.613Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.614Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/health.test.ts > Health Check Endpoints > Health check reliability > should not crash on concurrent health checks
2026-01-17T15:28:56.615Z [ERROR] Database health check failed {"error":"Unknown error"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/health.test.ts [2m([22m[2m8 tests[22m[2m)[22m[33m 335[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/unit/gap-analysis.test.ts [2m([22m[2m17 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/unit/aiOrchestrator.test.ts [2m([22m[2m27 tests[22m[2m)[22m[32m 35[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/unit/storage.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/unit/auth.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 18[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:28:58.766Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:28:58.767Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:28:58.767Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:28:58.768Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:28:58.768Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:28:59.100Z [ERROR] Unhandled application error {"path":"/api/document-templates","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
2026-01-17T15:28:59.114Z [ERROR] Unhandled application error {"path":"/api/organizations","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for user profile
2026-01-17T15:28:59.120Z [ERROR] Unhandled application error {"path":"/api/auth/user","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for /api/auth/user
2026-01-17T15:28:59.124Z [ERROR] Unhandled application error {"path":"/api/auth/user","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:28:59.123Z [ERROR] Unhandled application error {"path":"/api/gap-analysis","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:28:59.128Z [ERROR] Unhandled application error {"path":"/api/document-templates","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication to list organizations
2026-01-17T15:28:59.127Z [ERROR] Unhandled application error {"path":"/api/organizations","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for company profiles
2026-01-17T15:28:59.132Z [ERROR] Unhandled application error {"path":"/api/company-profiles","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for /api/company-profiles
2026-01-17T15:28:59.135Z [ERROR] Unhandled application error {"path":"/api/company-profiles","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
2026-01-17T15:28:59.139Z [ERROR] Unhandled application error {"path":"/api/company-profiles","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for documents
2026-01-17T15:28:59.143Z [ERROR] Unhandled application error {"path":"/api/documents","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication to get company profile
2026-01-17T15:28:59.145Z [ERROR] Unhandled application error {"path":"/api/company-profiles","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:28:59.152Z [ERROR] Unhandled application error {"path":"/api/company-profiles/1","method":"PATCH","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
2026-01-17T15:28:59.155Z [ERROR] Unhandled application error {"path":"/api/documents/generate","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
2026-01-17T15:28:59.160Z [ERROR] Unhandled application error {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
2026-01-17T15:28:59.162Z [ERROR] Unhandled application error {"path":"/api/documents/upload-and-extract","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
2026-01-17T15:28:59.161Z [ERROR] Unhandled application error {"path":"/api/ai/generate","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
2026-01-17T15:28:59.164Z [ERROR] Unhandled application error {"path":"/api/documents/generate","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
2026-01-17T15:28:59.165Z [ERROR] Unhandled application error {"path":"/api/company-profiles","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[33m 403[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return system health status[32m 31[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return AI health status[32m 6[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for user profile[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for company profiles[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for documents[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m API Integration Tests[2m > [22mData Validation[2m > [22mshould validate company profile creation payload[39m[32m 22[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
2026-01-17T15:28:59.169Z [ERROR] Unhandled application error {"path":"/api/export-document","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:28:59.169Z [ERROR] Unhandled application error {"path":"/api/analyze-compliance-gaps","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
2026-01-17T15:28:59.169Z [ERROR] Unhandled application error {"path":"/api/ai/analyze","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:28:59.172Z [ERROR] Unhandled application error {"path":"/api/gap-analysis","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
2026-01-17T15:28:59.178Z [ERROR] Unhandled application error {"path":"/api/export-document","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:28:59.179Z [ERROR] Unhandled application error {"path":"/api/gap-analysis","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:28:59.180Z [ERROR] Unhandled application error {"path":"/api/audit-logs","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document AI Generation > should reject generation request without framework
2026-01-17T15:28:59.186Z [ERROR] Unhandled application error {"path":"/api/generate-document","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:28:59.186Z [ERROR] Unhandled application error {"path":"/api/evidence","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
2026-01-17T15:28:59.188Z [ERROR] Unhandled application error {"path":"/api/auth/mfa/setup","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
2026-01-17T15:28:59.194Z [ERROR] Unhandled application error {"path":"/api/analyze-document-quality","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:28:59.191Z [ERROR] Unhandled application error {"path":"/api/gap-analysis","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Session Handling > should return 401 for invalid session
2026-01-17T15:28:59.197Z [ERROR] Unhandled application error {"path":"/api/auth/user","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:28:59.197Z [ERROR] Unhandled application error {"path":"/api/evidence","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:28:59.204Z [ERROR] Unhandled application error {"path":"/api/gap-analysis","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:28:59.205Z [ERROR] Unhandled application error {"path":"/api/controls/approvals","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version history
2026-01-17T15:28:59.206Z [ERROR] Unhandled application error {"path":"/api/documents/test-id/versions","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:28:59.211Z [ERROR] Unhandled application error {"path":"/api/controls/1/approve","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:28:59.211Z [ERROR] Unhandled application error {"path":"/api/gap-analysis","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[33m 451[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 34[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[39m[32m 29[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(10) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 4[2mms[22m[39m
stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:28:59.217Z [ERROR] Unhandled application error {"path":"/api/audit-trail","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Document Quality for Compliance > should analyze document quality against framework
2026-01-17T15:28:59.219Z [ERROR] Unhandled application error {"path":"/api/analyze-document-quality","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
2026-01-17T15:28:59.220Z [ERROR] Unhandled application error {"path":"/api/documents/test-id/versions","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to get audit entry details
2026-01-17T15:28:59.223Z [ERROR] Unhandled application error {"path":"/api/audit-trail/1","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
2026-01-17T15:28:59.226Z [ERROR] Unhandled application error {"path":"/api/documents/test-id/versions/version-id/restore","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for report access
2026-01-17T15:28:59.227Z [ERROR] Unhandled application error {"path":"/api/gap-analysis/reports","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:28:59.230Z [ERROR] Unhandled application error {"path":"/api/auditor/documents","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Comparison > should require authentication for version comparison
2026-01-17T15:28:59.233Z [ERROR] Unhandled application error {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for specific report
2026-01-17T15:28:59.236Z [ERROR] Unhandled application error {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:28:59.236Z [ERROR] Unhandled application error {"path":"/api/auditor/overview","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should save a document with valid data
2026-01-17T15:28:59.238Z [ERROR] Unhandled application error {"path":"/api/save-document","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
2026-01-17T15:28:59.244Z [ERROR] Unhandled application error {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:28:59.243Z [ERROR] Unhandled application error {"path":"/api/auditor/export","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should reject save request without required fields
2026-01-17T15:28:59.244Z [ERROR] Unhandled application error {"path":"/api/save-document","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m10 failed[39m[2m)[22m[33m 482[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[39m[32m 49[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 200 "OK", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 200 "OK", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[39m[32m 26[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 200 "OK", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 400 "Bad Request", got 500 "Internal Server Error"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 6[2mms[22m[39m
stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:28:59.250Z [ERROR] Unhandled application error {"path":"/api/gap-analysis","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:28:59.252Z [ERROR] Unhandled application error {"path":"/api/assess-risk","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis by framework
2026-01-17T15:28:59.258Z [ERROR] Unhandled application error {"path":"/api/gap-analysis/ISO27001","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:28:59.260Z [ERROR] Unhandled application error {"path":"/api/calculate-compliance-score","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Document to Audit Trail > should require authentication to track document changes
2026-01-17T15:28:59.265Z [ERROR] Unhandled application error {"path":"/api/documents/1/history","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
2026-01-17T15:28:59.266Z [ERROR] Unhandled application error {"path":"/api/ai/analyze-gaps","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:28:59.273Z [ERROR] Unhandled application error {"path":"/api/evidence/1/controls","method":"POST","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
2026-01-17T15:28:59.276Z [ERROR] Unhandled application error {"path":"/api/frameworks/SOC2/controls","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:28:59.279Z [ERROR] Unhandled application error {"path":"/api/ai/stats","method":"GET","error":"Login sessions require session support. Did you forget to use `express-session` middleware?","stack":"Error: Login sessions require session support. Did you forget to use `express-session` middleware?\n    at SessionStrategy.authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\strategies\\session.js:97:41)\n    at attempt (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:378:16)\n    at authenticate (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\authenticate.js:379:7)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at trim_prefix (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:328:13)\n    at C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:286:9\n    at Function.process_params (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at initialize (C:\\software\\cyberdocgen\\node_modules\\passport\\lib\\middleware\\initialize.js:98:5)\n    at Layer.handle [as handle_request] (C:\\software\\cyberdocgen\\node_modules\\express\\lib\\router\\layer.js:95:5)"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m10 failed[39m[2m)[22m[33m 515[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[39m[32m 79[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 500 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[39m[32m 12[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 500 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 500 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 500 to be 401 // Object.is equality[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 6[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 401, 404 ] to include 500[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 6[2mms[22m[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m21 failed[39m[2m)[22m[33m 522[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[39m[32m 50[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 500 "Internal Server Error"[39m
stderr | tests/components/ErrorBoundary.test.tsx > ErrorBoundary > should hide error message in production mode
[2026-01-17T15:28:59.291Z] [WARN] Failed to fetch CSRF token

 [32mÎ“Â£Ã´[39m [30m[45m components [49m[39m tests/components/ErrorBoundary.test.tsx [2m([22m[2m9 tests[22m[2m)[22m[33m 469[2mms[22m[39m
stderr | tests/components/dashboard.test.tsx > Dashboard Component > Initial Rendering > should render dashboard title
Warning: A suspended resource finished loading inside a test, but the event was not wrapped in act(...).

When testing, code that resolves suspended data should be wrapped into act(...):

act(() => {
  /* finish loading suspended data */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
Warning: A suspended resource finished loading inside a test, but the event was not wrapped in act(...).

When testing, code that resolves suspended data should be wrapped into act(...):

act(() => {
  /* finish loading suspended data */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act
Warning: A suspended resource finished loading inside a test, but the event was not wrapped in act(...).

When testing, code that resolves suspended data should be wrapped into act(...):

act(() => {
  /* finish loading suspended data */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act

 [32mÎ“Â£Ã´[39m [30m[45m components [49m[39m tests/components/ai-components.test.tsx [2m([22m[2m48 tests[22m[2m)[22m[33m 1897[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[45m components [49m[39m tests/components/dashboard.test.tsx [2m([22m[2m37 tests[22m[2m)[22m[33m 1631[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[45m components [49m[39m tests/components/documents.test.tsx [2m([22m[2m44 tests[22m[2m)[22m[33m 5076[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Documents Page[2m > [22mEmpty States[2m > [22mshould display message when no documents match filters [33m 419[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Documents Page[2m > [22mSearch Functionality[2m > [22mshould filter documents by title search [33m 329[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Documents Page[2m > [22mSearch Functionality[2m > [22mshould filter documents by description search [33m 309[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Documents Page[2m > [22mSearch Functionality[2m > [22mshould perform case-insensitive search [33m 356[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Documents Page[2m > [22mStatus Filter[2m > [22mshould reset to all documents when selecting "All Status" [33m 402[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Documents Page[2m > [22mCombined Filters[2m > [22mshould apply both search and status filters [33m 357[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[45m components [49m[39m tests/components/gap-analysis.test.tsx [2m([22m[2m56 tests[22m[2m)[22m[33m 5370[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Gap Analysis Page[2m > [22mInitial Rendering[2m > [22mshould render page header with title [33m 487[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Gap Analysis Page[2m > [22mAnalysis Filters[2m > [22mshould filter categories by selection [33m 302[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Gap Analysis Page[2m > [22mAnalysis Filters[2m > [22mshould reset filters when selecting "All" [33m 518[2mms[22m[39m
stderr | tests/components/ai-doc-generator.test.tsx > AI Document Generator Page > Step 5: Generation Results > should show loading state during generation
Not implemented: HTMLFormElement's requestSubmit() method

stderr | tests/components/ai-doc-generator.test.tsx > AI Document Generator Page > Step 5: Generation Results > should show error state on generation failure
Not implemented: HTMLFormElement's requestSubmit() method

stderr | tests/components/ai-doc-generator.test.tsx > AI Document Generator Page > Step 5: Generation Results > should show completed state with generated documents
Not implemented: HTMLFormElement's requestSubmit() method

 [32mÎ“Â£Ã´[39m [30m[45m components [49m[39m tests/components/ai-doc-generator.test.tsx [2m([22m[2m44 tests[22m[2m)[22m[33m 48980[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 1: Company Basics[2m > [22mshould require all fields to proceed [33m 317[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 1: Company Basics[2m > [22mshould allow valid company name input [33m 341[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 1: Company Basics[2m > [22mshould allow headquarters input [33m 402[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 1: Company Basics[2m > [22mshould proceed to step 2 with valid data [33m 1069[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 2: Infrastructure & Security[2m > [22mshould render infrastructure fields [33m 1069[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 2: Infrastructure & Security[2m > [22mshould render all cloud provider checkboxes [33m 1163[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 2: Infrastructure & Security[2m > [22mshould allow selecting multiple cloud providers [33m 1132[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 2: Infrastructure & Security[2m > [22mshould require at least one cloud provider [33m 989[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 2: Infrastructure & Security[2m > [22mshould allow data classification selection [33m 1224[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 2: Infrastructure & Security[2m > [22mshould allow business applications input [33m 1813[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 2: Infrastructure & Security[2m > [22mshould allow going back to step 1 [33m 915[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 2: Infrastructure & Security[2m > [22mshould proceed to step 3 with valid data [33m 1738[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 3: Framework Selection[2m > [22mshould render framework selection fields [33m 1734[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 3: Framework Selection[2m > [22mshould allow selecting multiple frameworks [33m 1829[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 3: Framework Selection[2m > [22mshould show SOC2 trust principles when SOC2 is selected [33m 1689[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 3: Framework Selection[2m > [22mshould hide SOC2 trust principles when SOC2 is deselected [33m 1864[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 3: Framework Selection[2m > [22mshould show FedRAMP level when FedRAMP is selected [33m 1800[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 3: Framework Selection[2m > [22mshould allow selecting FedRAMP level [33m 1873[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 3: Framework Selection[2m > [22mshould require at least one framework [33m 1844[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 3: Framework Selection[2m > [22mshould proceed to step 4 with valid data [33m 1769[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 4: Review & Generate[2m > [22mshould display company information review [33m 1879[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 4: Review & Generate[2m > [22mshould display infrastructure review [33m 1925[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 4: Review & Generate[2m > [22mshould display selected frameworks [33m 1845[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 4: Review & Generate[2m > [22mshould show estimated document count [33m 1877[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 4: Review & Generate[2m > [22mshould render generate button [33m 1853[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 4: Review & Generate[2m > [22mshould only show previous button, not next [33m 1810[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 4: Review & Generate[2m > [22mshould allow going back to step 3 [33m 1859[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 5: Generation Results[2m > [22mshould show loading state during generation [33m 1881[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 5: Generation Results[2m > [22mshould show error state on generation failure [33m 1890[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mStep 5: Generation Results[2m > [22mshould show completed state with generated documents [33m 1923[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mForm Validation[2m > [22mshould validate business applications minimum length [33m 1207[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m AI Document Generator Page[2m > [22mNavigation[2m > [22mshould maintain form data when navigating back and forth [33m 1053[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 53 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for user profile
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/api.test.ts:47:10
     45|       await request(app)
     46|         .get('/api/auth/user')
     47|         .expect(401);
       |          ^
     48|     });
     49| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/53]Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for company profiles
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/api.test.ts:53:10
     51|       await request(app)
     52|         .get('/api/company-profiles')
     53|         .expect(401);
       |          ^
     54|     });
     55| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/53]Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for documents
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/api.test.ts:59:10
     57|       await request(app)
     58|         .get('/api/documents')
     59|         .expect(401);
       |          ^
     60|     });
     61|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/53]Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/api.test.ts:74:10
     72|         .post('/api/company-profiles')
     73|         .send(invalidPayload)
     74|         .expect(401); // Will be 401 due to auth, but would be 400 witÎ“Ã‡Âª
       |          ^
     75|     });
     76|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/53]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for /api/auth/user
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/auth.test.ts:44:10
     42|       await request(app)
     43|         .get('/api/auth/user')
     44|         .expect(401);
       |          ^
     45|     });
     46| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/53]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for /api/company-profiles
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/auth.test.ts:50:10
     48|       await request(app)
     49|         .get('/api/company-profiles')
     50|         .expect(401);
       |          ^
     51|     });
     52| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/53]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/auth.test.ts:61:10
     59|           category: 'policy'
     60|         })
     61|         .expect(401);
       |          ^
     62|     });
     63| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/53]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/auth.test.ts:71:10
     69|           companyProfileId: 'test-id'
     70|         })
     71|         .expect(401);
       |          ^
     72|     });
     73| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/53]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/auth.test.ts:77:10
     75|       await request(app)
     76|         .get('/api/audit-logs')
     77|         .expect(401);
       |          ^
     78|     });
     79| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[9/53]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[10/53]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Session Handling > should return 401 for invalid session
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/auth.test.ts:92:10
     90|         .get('/api/auth/user')
     91|         .set('Cookie', 'session=invalid-session-token')
     92|         .expect(401);
       |          ^
     93|     });
     94|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[11/53]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(10) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[12/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:26:10
     24|       const response = await request(app)
     25|         .get('/api/document-templates')
     26|         .expect(200);
       |          ^
     27| 
     28|       expect(response.body).toHaveProperty('templates');
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[13/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:35:10
     33|       const templatesResponse = await request(app)
     34|         .get('/api/document-templates')
     35|         .expect(200);
       |          ^
     36| 
     37|       if (templatesResponse.body.templates && templatesResponse.body.tÎ“Ã‡Âª
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[14/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:57:10
     55|           category: 'policy'
     56|         })
     57|         .expect(401);
       |          ^
     58|     });
     59| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[15/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:66:10
     64|           files: []
     65|         })
     66|         .expect(401);
       |          ^
     67|     });
     68|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[16/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
Error: expected 200 "OK", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:79:10
     77|           filename: 'test-doc'
     78|         })
     79|         .expect(200);
       |          ^
     80| 
     81|       expect(response.headers['content-type']).toContain('text/markdowÎ“Ã‡Âª
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[17/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
Error: expected 400 "Bad Request", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:90:10
     88|           format: 'md'
     89|         })
     90|         .expect(400);
       |          ^
     91|     });
     92|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[18/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version history
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:128:10
    126|       await request(app)
    127|         .get('/api/documents/test-id/versions')
    128|         .expect(401);
       |          ^
    129|     });
    130| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[19/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:138:10
    136|           changeDescription: 'Updated policy'
    137|         })
    138|         .expect(401);
       |          ^
    139|     });
    140| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[20/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[21/53]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Comparison > should require authentication for version comparison
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/documents.test.ts:152:10
    150|       await request(app)
    151|         .get('/api/documents/test-id/versions/1/compare/2')
    152|         .expect(401);
       |          ^
    153|     });
    154|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[22/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:32:12
     30|             size: 'medium'
     31|           })
     32|           .expect(401);
       |            ^
     33|       });
     34| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[23/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication to list organizations
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:38:12
     36|         await request(app)
     37|           .get('/api/organizations')
     38|           .expect(401);
       |            ^
     39|       });
     40|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[24/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:55:12
     53|           .post('/api/company-profiles')
     54|           .send(profileData)
     55|           .expect(401);
       |            ^
     56|       });
     57| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[25/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication to get company profile
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:61:12
     59|         await request(app)
     60|           .get('/api/company-profiles')
     61|           .expect(401);
       |            ^
     62|       });
     63|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[26/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:72:12
     70|             complianceFrameworks: ['ISO 27001', 'SOC 2', 'FedRAMP']
     71|           })
     72|           .expect(401);
       |            ^
     73|       });
     74|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[27/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[28/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[29/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:120:12
    118|             description: 'Test evidence document'
    119|           })
    120|           .expect(401);
       |            ^
    121|       });
    122| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[30/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:126:12
    124|         await request(app)
    125|           .get('/api/evidence')
    126|           .expect(401);
       |            ^
    127|       });
    128|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[31/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:134:12
    132|         await request(app)
    133|           .get('/api/controls/approvals')
    134|           .expect(401);
       |            ^
    135|       });
    136| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[32/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:144:12
    142|             comments: 'Approved after review'
    143|           })
    144|           .expect(401);
       |            ^
    145|       });
    146|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[33/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:154:12
    152|         await request(app)
    153|           .get('/api/audit-trail')
    154|           .expect(401);
       |            ^
    155|       });
    156| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[34/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to get audit entry details
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:160:12
    158|         await request(app)
    159|           .get('/api/audit-trail/1')
    160|           .expect(401);
       |            ^
    161|       });
    162|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[35/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:168:12
    166|         await request(app)
    167|           .get('/api/auditor/documents')
    168|           .expect(401);
       |            ^
    169|       });
    170| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[36/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:174:12
    172|         await request(app)
    173|           .get('/api/auditor/overview')
    174|           .expect(401);
       |            ^
    175|       });
    176| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[37/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:180:12
    178|         await request(app)
    179|           .get('/api/auditor/export')
    180|           .expect(401);
       |            ^
    181|       });
    182|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[38/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:188:12
    186|         await request(app)
    187|           .get('/api/gap-analysis')
    188|           .expect(401);
       |            ^
    189|       });
    190| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[39/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis by framework
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:194:12
    192|         await request(app)
    193|           .get('/api/gap-analysis/ISO27001')
    194|           .expect(401);
       |            ^
    195|       });
    196|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[40/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Document to Audit Trail > should require authentication to track document changes
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:204:12
    202|         await request(app)
    203|           .get('/api/documents/1/history')
    204|           .expect(401);
       |            ^
    205|       });
    206|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[41/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:215:12
    213|             controlIds: ['CC6.1', 'CC6.7']
    214|           })
    215|           .expect(401);
       |            ^
    216|       });
    217|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[42/53]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:223:12
    221|         await request(app)
    222|           .get('/api/ai/stats')
    223|           .expect(401);
       |            ^
    224|       });
    225|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[43/53]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:30:10
     28|           companyProfileId: 'test-profile-id'
     29|         })
     30|         .expect(401);
       |          ^
     31|     });
     32| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[44/53]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:39:10
     37|           status: 'in_progress'
     38|         })
     39|         .expect(401);
       |          ^
     40|     });
     41|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[45/53]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
AssertionError: expected 500 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 500

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:74:33
     72|           });
     73| 
     74|         expect(response.status).toBe(401);
       |                                 ^
     75|       });
     76|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[46/53]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for report access
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:111:10
    109|       await request(app)
    110|         .get('/api/gap-analysis/reports')
    111|         .expect(401);
       |          ^
    112|     });
    113| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[47/53]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for specific report
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:117:10
    115|       await request(app)
    116|         .get('/api/gap-analysis/reports/test-report-id')
    117|         .expect(401);
       |          ^
    118|     });
    119|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[48/53]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
Error: expected 401 "Unauthorized", got 500 "Internal Server Error"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:129:10
    127|           completedAt: new Date().toISOString()
    128|         })
    129|         .expect(401);
       |          ^
    130|     });
    131|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[49/53]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected [ 401, 404 ] to include 500
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:184:26
    182|         });
    183| 
    184|       expect([401, 404]).toContain(response.status);
       |                          ^
    185|     });
    186|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[50/53]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m18 passed[39m[22m[90m (23)[39m
[2m      Tests [22m [1m[31m53 failed[39m[22m[2m | [22m[1m[32m462 passed[39m[22m[90m (515)[39m
[2m   Start at [22m 07:28:53
[2m   Duration [22m 54.27s[2m (transform 3.71s, setup 6.29s, collect 32.86s, tests 66.54s, environment 8.88s, prepare 9.59s)[22m

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:31:39.250Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:31:39.271Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:31:39.271Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:31:39.280Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:31:39.313Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"086ae146-519b-47b3-ad3b-4ad769efaf31","spanId":"5c463d54","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.403Z"}
{"type":"request_end","traceId":"086ae146-519b-47b3-ad3b-4ad769efaf31","spanId":"5c463d54","method":"POST","path":"/api/organizations","statusCode":403,"duration":15,"timestamp":"2026-01-17T15:31:39.418Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
2026-01-17T15:31:39.405Z [WARN] CSRF token missing {"path":"/api/organizations","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"5645dc21-49a1-4a82-acf0-a1268bd43df1","spanId":"e5b7449a","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.417Z"}
[32m2026-01-17T15:31:39.421Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.421Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return system health status
[22m[39m[32m2026-01-17T15:31:39.424Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.424Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:31:39.432Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"c0b0e643-69c0-40c7-9e8c-f875fe20007a","spanId":"16de4a51","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.437Z"}
[32m2026-01-17T15:31:39.440Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.440Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:31:39.466Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.466Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return AI health status
2026-01-17T15:31:39.469Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T15:31:39.469Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.469Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"9acce283-f8b2-4284-b584-9be364f86ecd","spanId":"608fff6a","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.437Z"}
{"type":"request_end","traceId":"9acce283-f8b2-4284-b584-9be364f86ecd","spanId":"608fff6a","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":33,"timestamp":"2026-01-17T15:31:39.470Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:31:39.440Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication to list organizations
2026-01-17T15:31:39.470Z [WARN] Unknown API route accessed {"path":"/organizations","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"8452c509-0f6f-4355-87a8-56f42a644b70","spanId":"ba815ecf","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.492Z"}
{"type":"request_end","traceId":"8452c509-0f6f-4355-87a8-56f42a644b70","spanId":"ba815ecf","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:31:39.495Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
2026-01-17T15:31:39.492Z [WARN] CSRF token missing {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"c0b0e643-69c0-40c7-9e8c-f875fe20007a","spanId":"16de4a51","method":"GET","path":"/api/organizations","statusCode":401,"duration":61,"timestamp":"2026-01-17T15:31:39.498Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"5645dc21-49a1-4a82-acf0-a1268bd43df1","spanId":"e5b7449a","method":"GET","path":"/","statusCode":200,"duration":83,"timestamp":"2026-01-17T15:31:39.500Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return AI health status
2026-01-17T15:31:39.503Z [ERROR] Unhandled application error {"path":"/api/ai/health","method":"GET","error":"","stack":"AggregateError: \n    at C:\\software\\cyberdocgen\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:322:21)\n    at PGStore._rawEnsureSessionStoreTable (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:177:19)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:315:7)"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:31:39.504Z [ERROR] Unhandled application error {"path":"/api/document-templates","method":"GET","error":"","stack":"AggregateError: \n    at C:\\software\\cyberdocgen\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:322:21)\n    at PGStore._rawEnsureSessionStoreTable (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:177:19)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:315:7)"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"dd8f275e-7189-4fdb-9e4a-8aaedf3f825c","spanId":"eaa752ea","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.511Z"}
{"type":"request_end","traceId":"dd8f275e-7189-4fdb-9e4a-8aaedf3f825c","spanId":"eaa752ea","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:31:39.514Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:31:39.512Z [WARN] CSRF token missing {"path":"/api/analyze-compliance-gaps","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"53cc3e3d-986f-4a47-9fdd-b8010cb9a384","spanId":"e0287452","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.514Z"}
[32m2026-01-17T15:31:39.515Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.515Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:31:39.516Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.516Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"8b746d3c-d9fc-4886-b494-370174ea30ec","spanId":"cb92e6e3","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.514Z"}
{"type":"request_end","traceId":"8b746d3c-d9fc-4886-b494-370174ea30ec","spanId":"cb92e6e3","method":"POST","path":"/api/company-profiles","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.516Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:31:39.516Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
2026-01-17T15:31:39.515Z [WARN] CSRF token missing {"path":"/api/company-profiles","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"53cc3e3d-986f-4a47-9fdd-b8010cb9a384","spanId":"e0287452","method":"GET","path":"/api/auth/user","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:31:39.519Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to AI health endpoint
2026-01-17T15:31:39.518Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"649f7907-6017-428c-9b8c-40bcef1c0afb","spanId":"6272abea","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.525Z"}
[32m2026-01-17T15:31:39.526Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.526Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:31:39.527Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"2816f188-486a-44e9-9a6a-432023965224","spanId":"516ddce4","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.527Z"}
{"type":"request_end","traceId":"2816f188-486a-44e9-9a6a-432023965224","spanId":"516ddce4","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.528Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"2c8a2e0c-6301-4fba-920f-fac75107c1a5","spanId":"4e52e671","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.528Z"}
[32m2026-01-17T15:31:39.528Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.528Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"8b430526-3f1f-4a0c-a8b4-fb701b622345","spanId":"8788fd7b","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.529Z"}
[32m2026-01-17T15:31:39.530Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.530Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:31:39.527Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for company profiles
2026-01-17T15:31:39.530Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication to get company profile
2026-01-17T15:31:39.531Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"2c8a2e0c-6301-4fba-920f-fac75107c1a5","spanId":"4e52e671","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:31:39.532Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"8b430526-3f1f-4a0c-a8b4-fb701b622345","spanId":"8788fd7b","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:31:39.533Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"649f7907-6017-428c-9b8c-40bcef1c0afb","spanId":"6272abea","method":"GET","path":"/","statusCode":200,"duration":13,"timestamp":"2026-01-17T15:31:39.538Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:31:39.539Z [ERROR] Unhandled application error {"path":"/api/document-templates","method":"GET","error":"","stack":"AggregateError: \n    at C:\\software\\cyberdocgen\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:322:21)\n    at PGStore._rawEnsureSessionStoreTable (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:177:19)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:315:7)"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"4ace04a8-3d68-4c53-9308-aad089f94984","spanId":"64f32125","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.539Z"}
[32m2026-01-17T15:31:39.539Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.539Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"111ea119-2ce1-484f-9389-fd3d5cae0162","spanId":"0a9a3400","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.541Z"}
{"type":"request_end","traceId":"111ea119-2ce1-484f-9389-fd3d5cae0162","spanId":"0a9a3400","method":"PATCH","path":"/api/company-profiles/1","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:31:39.544Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for documents
2026-01-17T15:31:39.540Z [WARN] Unknown API route accessed {"path":"/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:31:39.542Z [WARN] CSRF token missing {"path":"/api/company-profiles/1","method":"PATCH","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"d48f515a-855f-4056-9151-9bbe00affe87","spanId":"e95a27de","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.543Z"}
{"type":"request_end","traceId":"d48f515a-855f-4056-9151-9bbe00affe87","spanId":"e95a27de","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.545Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:31:39.544Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"4ace04a8-3d68-4c53-9308-aad089f94984","spanId":"64f32125","method":"GET","path":"/api/documents","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:31:39.545Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to AI health endpoint
2026-01-17T15:31:39.548Z [ERROR] Unhandled application error {"path":"/api/ai/health","method":"GET","error":"","stack":"AggregateError: \n    at C:\\software\\cyberdocgen\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:322:21)\n    at PGStore._rawEnsureSessionStoreTable (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:177:19)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:315:7)"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"0df5fe21-b027-4c2f-833e-f531aa3290d1","spanId":"2e8f2d2e","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.550Z"}
{"type":"request_end","traceId":"0df5fe21-b027-4c2f-833e-f531aa3290d1","spanId":"2e8f2d2e","method":"POST","path":"/api/ai/generate","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.552Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
2026-01-17T15:31:39.551Z [WARN] CSRF token missing {"path":"/api/ai/generate","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"422c8a9c-5724-4d17-9861-cbe793f578d5","spanId":"cab36e7f","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.558Z"}
[32m2026-01-17T15:31:39.568Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.568Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"22b9857d-9440-411e-85b2-cf9b4c4b5e51","spanId":"6ce67ad0","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.569Z"}
{"type":"request_end","traceId":"22b9857d-9440-411e-85b2-cf9b4c4b5e51","spanId":"6ce67ad0","method":"POST","path":"/api/ai/analyze","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.571Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
2026-01-17T15:31:39.570Z [WARN] CSRF token missing {"path":"/api/ai/analyze","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:31:39.569Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"422c8a9c-5724-4d17-9861-cbe793f578d5","spanId":"cab36e7f","method":"GET","path":"/api/auth/user","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:31:39.572Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"70491499-75dc-4150-941a-9974fbf13983","spanId":"ece3b2d5","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.571Z"}
{"type":"request_end","traceId":"70491499-75dc-4150-941a-9974fbf13983","spanId":"ece3b2d5","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.573Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:31:39.572Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:31:39.582Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.582Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"c5539dca-8532-428f-95fa-20ac8f43eaa1","spanId":"2cfff244","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.581Z"}
{"type":"request_end","traceId":"c5539dca-8532-428f-95fa-20ac8f43eaa1","spanId":"2cfff244","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.582Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:31:39.581Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"0054ae16-126f-480f-9f0f-9cf93a37ba63","spanId":"faa9d8a5","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.581Z"}
{"type":"request_end","traceId":"0054ae16-126f-480f-9f0f-9cf93a37ba63","spanId":"faa9d8a5","method":"POST","path":"/api/company-profiles","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.583Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
2026-01-17T15:31:39.582Z [WARN] CSRF token missing {"path":"/api/company-profiles","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should return AI service health status
2026-01-17T15:31:39.583Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should return AI service health status
2026-01-17T15:31:39.586Z [ERROR] Unhandled application error {"path":"/api/ai/health","method":"GET","error":"","stack":"AggregateError: \n    at C:\\software\\cyberdocgen\\node_modules\\pg-pool\\index.js:45:11\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:322:21)\n    at PGStore._rawEnsureSessionStoreTable (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:177:19)\n    at PGStore._asyncQuery (C:\\software\\cyberdocgen\\node_modules\\connect-pg-simple\\index.js:315:7)"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"de89bad2-f740-45d5-8407-c7d8927e5abc","spanId":"9258c23f","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.586Z"}
{"type":"request_end","traceId":"de89bad2-f740-45d5-8407-c7d8927e5abc","spanId":"9258c23f","method":"POST","path":"/api/documents/generate","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.588Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
2026-01-17T15:31:39.586Z [WARN] CSRF token missing {"path":"/api/documents/generate","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 413[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return system health status[32m 85[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return AI health status[32m 53[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for user profile[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for company profiles[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for documents[32m 13[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m API Integration Tests[2m > [22mData Validation[2m > [22mshould validate company profile creation payload[39m[32m 40[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"fd42a441-98f8-42b1-a5c5-fe00de83af96","spanId":"d3a57a42","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.589Z"}
[32m2026-01-17T15:31:39.590Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.590Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"032065b4-62f5-4baf-aebc-676ee740e086","spanId":"022e7129","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.593Z"}
{"type":"request_end","traceId":"032065b4-62f5-4baf-aebc-676ee740e086","spanId":"022e7129","method":"POST","path":"/api/analyze-document-quality","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.595Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Document Quality for Compliance > should analyze document quality against framework
2026-01-17T15:31:39.594Z [WARN] CSRF token missing {"path":"/api/analyze-document-quality","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for /api/company-profiles
2026-01-17T15:31:39.593Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"b5917c2f-9391-404e-8ee9-cd09be9cb6b6","spanId":"84102cb6","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.594Z"}
{"type":"request_end","traceId":"b5917c2f-9391-404e-8ee9-cd09be9cb6b6","spanId":"84102cb6","method":"POST","path":"/api/evidence","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.596Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:31:39.594Z [WARN] CSRF token missing {"path":"/api/evidence","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"fd42a441-98f8-42b1-a5c5-fe00de83af96","spanId":"d3a57a42","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:31:39.597Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"6b94bb93-823e-4f2c-ba3b-903afd4433c6","spanId":"0e8b2d35","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.601Z"}
{"type":"request_end","traceId":"6b94bb93-823e-4f2c-ba3b-903afd4433c6","spanId":"0e8b2d35","method":"POST","path":"/api/documents/upload-and-extract","statusCode":403,"duration":6,"timestamp":"2026-01-17T15:31:39.607Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
2026-01-17T15:31:39.602Z [WARN] CSRF token missing {"path":"/api/documents/upload-and-extract","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"d808933e-6898-4114-8d62-78cce8c86baf","spanId":"c28b98d9","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.609Z"}
[32m2026-01-17T15:31:39.609Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.609Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:31:39.610Z [WARN] Unknown API route accessed {"path":"/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"d808933e-6898-4114-8d62-78cce8c86baf","spanId":"c28b98d9","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:31:39.611Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"a1e02912-614e-476f-843a-ff8bf16902ac","spanId":"53c68800","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.611Z"}
[32m2026-01-17T15:31:39.613Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.613Z"}[0m


[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"e35e19ff-db46-4db1-af10-3aa1bd8ae504","spanId":"0d26c3ec","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.626Z"}
{"type":"request_end","traceId":"e35e19ff-db46-4db1-af10-3aa1bd8ae504","spanId":"0d26c3ec","method":"POST","path":"/api/documents/generate","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:31:39.629Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"218565f3-d193-4959-92ae-1df2cd010c5a","spanId":"98f09b87","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.634Z"}
[32m2026-01-17T15:31:39.635Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.635Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"989efe13-110e-4de2-a408-42a61a09e082","spanId":"df6459f5","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.638Z"}
{"type":"request_end","traceId":"989efe13-110e-4de2-a408-42a61a09e082","spanId":"df6459f5","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.639Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"218565f3-d193-4959-92ae-1df2cd010c5a","spanId":"98f09b87","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:31:39.638Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for report access
2026-01-17T15:31:39.623Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
2026-01-17T15:31:39.627Z [WARN] CSRF token missing {"path":"/api/documents/generate","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:31:39.636Z [WARN] Unknown API route accessed {"path":"/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:31:39.639Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"86b6c0f0-34d7-4a43-a673-0f72bbfe9974","spanId":"a4baf147","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.647Z"}
{"type":"request_end","traceId":"86b6c0f0-34d7-4a43-a673-0f72bbfe9974","spanId":"a4baf147","method":"POST","path":"/api/controls/1/approve","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.648Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:31:39.648Z [WARN] CSRF token missing {"path":"/api/controls/1/approve","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"5a0e9621-5961-4968-835b-36178d8ac2f9","spanId":"9e726431","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.651Z"}
[32m2026-01-17T15:31:39.651Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.651Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"643acb3c-9a56-432b-a4b3-b03ac4786808","spanId":"13083b88","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.650Z"}
{"type":"request_end","traceId":"643acb3c-9a56-432b-a4b3-b03ac4786808","spanId":"13083b88","method":"POST","path":"/api/export-document","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.652Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
2026-01-17T15:31:39.651Z [WARN] CSRF token missing {"path":"/api/export-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:31:39.652Z [WARN] Unknown API route accessed {"path":"/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"1cba3196-03c6-474b-86f5-64a9bb10662b","spanId":"5466c68b","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.653Z"}
[32m2026-01-17T15:31:39.653Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.653Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"5a0e9621-5961-4968-835b-36178d8ac2f9","spanId":"9e726431","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:31:39.654Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:31:39.654Z [WARN] Unknown API route accessed {"path":"/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"1cba3196-03c6-474b-86f5-64a9bb10662b","spanId":"5466c68b","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:31:39.656Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"a1e02912-614e-476f-843a-ff8bf16902ac","spanId":"53c68800","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":47,"timestamp":"2026-01-17T15:31:39.658Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"1cc54550-abfd-445c-9f79-5844875f31fd","spanId":"8cbee47b","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.658Z"}
{"type":"request_end","traceId":"1cc54550-abfd-445c-9f79-5844875f31fd","spanId":"8cbee47b","method":"POST","path":"/api/export-document","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.659Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
2026-01-17T15:31:39.658Z [WARN] CSRF token missing {"path":"/api/export-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"7a4feb71-bb29-4919-8491-c4b1a5926019","spanId":"6bf9e78f","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.660Z"}
{"type":"request_end","traceId":"7a4feb71-bb29-4919-8491-c4b1a5926019","spanId":"6bf9e78f","method":"POST","path":"/api/auth/mfa/setup","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.661Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
2026-01-17T15:31:39.660Z [WARN] CSRF token missing {"path":"/api/auth/mfa/setup","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"eca156e7-5633-4f4e-9304-31f0bb7c7aa1","spanId":"984c8106","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.662Z"}
[32m2026-01-17T15:31:39.663Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.663Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to get audit entry details
2026-01-17T15:31:39.663Z [WARN] Unknown API route accessed {"path":"/audit-trail/1","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"eca156e7-5633-4f4e-9304-31f0bb7c7aa1","spanId":"984c8106","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:31:39.667Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"b4d0131d-4990-4e49-9586-8524f67a2a9d","spanId":"21f40f3c","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.668Z"}
[32m2026-01-17T15:31:39.669Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.669Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for specific report
2026-01-17T15:31:39.670Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports/test-report-id","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"7764de18-61dc-45c6-938b-dd13a8dba3bf","spanId":"1ffe1f1f","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.671Z"}
[32m2026-01-17T15:31:39.672Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.672Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"b4d0131d-4990-4e49-9586-8524f67a2a9d","spanId":"21f40f3c","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:31:39.673Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"9cabd861-d41a-4c79-8e8b-8d5075adefb1","spanId":"eb3a2bdb","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.674Z"}
[32m2026-01-17T15:31:39.675Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.675Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:31:39.675Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"7764de18-61dc-45c6-938b-dd13a8dba3bf","spanId":"1ffe1f1f","method":"GET","path":"/api/auth/user","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:31:39.676Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:31:39.676Z [WARN] Unknown API route accessed {"path":"/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"9cabd861-d41a-4c79-8e8b-8d5075adefb1","spanId":"eb3a2bdb","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:31:39.677Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"a0cac50b-9433-4be5-bcbe-648cdef7734e","spanId":"94286dc7","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.676Z"}
{"type":"request_end","traceId":"a0cac50b-9433-4be5-bcbe-648cdef7734e","spanId":"94286dc7","method":"POST","path":"/api/generate-document","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.678Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document AI Generation > should reject generation request without framework
2026-01-17T15:31:39.677Z [WARN] CSRF token missing {"path":"/api/generate-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"26c54c41-35bc-4213-b8a9-5a23915aca0a","spanId":"cafff71e","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.684Z"}
{"type":"request_end","traceId":"26c54c41-35bc-4213-b8a9-5a23915aca0a","spanId":"cafff71e","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.685Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
2026-01-17T15:31:39.685Z [WARN] CSRF token missing {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"47f269b2-ae00-41ad-adde-f507fd664c34","spanId":"2d4afc3d","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.688Z"}
[32m2026-01-17T15:31:39.689Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.689Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:31:39.689Z [WARN] Unknown API route accessed {"path":"/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T15:31:39.690Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.690Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"47f269b2-ae00-41ad-adde-f507fd664c34","spanId":"2d4afc3d","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:31:39.691Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"3ac89595-a5e7-449b-92db-0f95f8661ae1","spanId":"54dc18b7","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.690Z"}
{"type":"request_end","traceId":"3ac89595-a5e7-449b-92db-0f95f8661ae1","spanId":"54dc18b7","method":"POST","path":"/api/assess-risk","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.691Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:31:39.690Z [WARN] CSRF token missing {"path":"/api/assess-risk","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_start","traceId":"a4994b7c-df43-4e41-a97c-288bf914f754","spanId":"1940f56c","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.690Z"}
{"type":"request_end","traceId":"a4994b7c-df43-4e41-a97c-288bf914f754","spanId":"1940f56c","method":"POST","path":"/api/analyze-document-quality","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.692Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
2026-01-17T15:31:39.691Z [WARN] CSRF token missing {"path":"/api/analyze-document-quality","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"33c745d3-4026-486e-848d-6b823102ca1d","spanId":"afda1a98","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.697Z"}
[32m2026-01-17T15:31:39.697Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.697Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:31:39.698Z [WARN] Unknown API route accessed {"path":"/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"b8048ca9-cb7d-49aa-8585-c4747bd10b1a","spanId":"dd574dcb","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.697Z"}
{"type":"request_end","traceId":"b8048ca9-cb7d-49aa-8585-c4747bd10b1a","spanId":"dd574dcb","method":"POST","path":"/api/calculate-compliance-score","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.698Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:31:39.697Z [WARN] CSRF token missing {"path":"/api/calculate-compliance-score","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"33c745d3-4026-486e-848d-6b823102ca1d","spanId":"afda1a98","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:31:39.699Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"cc67f3c0-b7c4-41ab-a32c-a2828d62c122","spanId":"668e18d4","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.711Z"}
[32m2026-01-17T15:31:39.712Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.712Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T15:31:39.713Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.713Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:31:39.712Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"19201610-2626-412f-8dde-797f82e80361","spanId":"9f62e6d1","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.711Z"}
{"type":"request_end","traceId":"19201610-2626-412f-8dde-797f82e80361","spanId":"9f62e6d1","method":"POST","path":"/api/ai/analyze-gaps","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:31:39.714Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"cc67f3c0-b7c4-41ab-a32c-a2828d62c122","spanId":"668e18d4","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:31:39.714Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
2026-01-17T15:31:39.712Z [WARN] CSRF token missing {"path":"/api/ai/analyze-gaps","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"c140b6c9-e275-4e96-99e3-0c6e26dd7af9","spanId":"6673096f","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.714Z"}
[32m2026-01-17T15:31:39.716Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.716Z"}[0m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[33m 494[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 65[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 47[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 21[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 24[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[39m[32m 35[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 15[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 15[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 22[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 18[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"9aea6cab-1b0f-447b-acfa-71483d77c38e","spanId":"c5319a02","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.719Z"}
[32m2026-01-17T15:31:39.720Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.720Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version history
2026-01-17T15:31:39.717Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis by framework
2026-01-17T15:31:39.720Z [WARN] Unknown API route accessed {"path":"/gap-analysis/ISO27001","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"146aa335-aee4-4d77-9c6a-f8ee307605a6","spanId":"22cebad6","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.720Z"}
[32m2026-01-17T15:31:39.720Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.720Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"9aea6cab-1b0f-447b-acfa-71483d77c38e","spanId":"c5319a02","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:31:39.721Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"c140b6c9-e275-4e96-99e3-0c6e26dd7af9","spanId":"6673096f","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:31:39.721Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
2026-01-17T15:31:39.722Z [WARN] Unknown API route accessed {"path":"/frameworks/SOC2/controls","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"146aa335-aee4-4d77-9c6a-f8ee307605a6","spanId":"22cebad6","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":7,"timestamp":"2026-01-17T15:31:39.727Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"1b2e20a8-9df5-4595-bd51-5a9ebc89d960","spanId":"e56ca5d0","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.729Z"}
[32m2026-01-17T15:31:39.730Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.730Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Document to Audit Trail > should require authentication to track document changes
2026-01-17T15:31:39.731Z [WARN] Unknown API route accessed {"path":"/documents/1/history","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m9 failed[39m[2m)[22m[33m 535[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[39m[32m 98[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 20[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 403[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[39m[32m 14[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[39m[32m 28[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 64[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 15[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 17[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 401, 404 ] to include 403[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 12[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"62c9212d-d47c-45b1-9889-41dcd90e2022","spanId":"9b93965c","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.731Z"}
{"type":"request_end","traceId":"62c9212d-d47c-45b1-9889-41dcd90e2022","spanId":"9b93965c","method":"POST","path":"/api/documents/test-id/versions","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:31:39.734Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
2026-01-17T15:31:39.731Z [WARN] CSRF token missing {"path":"/api/documents/test-id/versions","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"1b2e20a8-9df5-4595-bd51-5a9ebc89d960","spanId":"e56ca5d0","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:31:39.736Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"4ddcee6e-e600-48f1-b84b-7083ef300074","spanId":"cc6e6dd1","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.739Z"}
{"type":"request_end","traceId":"4ddcee6e-e600-48f1-b84b-7083ef300074","spanId":"cc6e6dd1","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:31:39.741Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
2026-01-17T15:31:39.740Z [WARN] CSRF token missing {"path":"/api/documents/test-id/versions/version-id/restore","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"42363df3-7957-43a8-bfe3-db2c445cbccf","spanId":"67107824","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.741Z"}
{"type":"request_end","traceId":"42363df3-7957-43a8-bfe3-db2c445cbccf","spanId":"67107824","method":"POST","path":"/api/evidence/1/controls","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.742Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:31:39.741Z [WARN] CSRF token missing {"path":"/api/evidence/1/controls","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"ca500b98-d2bb-44e0-98a7-8d4a72e873f9","spanId":"973caec7","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.746Z"}
[32m2026-01-17T15:31:39.747Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.747Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"a9bd8b06-5ad3-4c89-a27f-c4fe84654ade","spanId":"19389c90","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.747Z"}
[32m2026-01-17T15:31:39.748Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:31:39.748Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:31:39.749Z [WARN] Unknown API route accessed {"path":"/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Comparison > should require authentication for version comparison
2026-01-17T15:31:39.749Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/1/compare/2","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"ca500b98-d2bb-44e0-98a7-8d4a72e873f9","spanId":"973caec7","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:31:39.751Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"a9bd8b06-5ad3-4c89-a27f-c4fe84654ade","spanId":"19389c90","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:31:39.752Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"df3ff6e2-cb90-4db2-9c31-2e6e95adf063","spanId":"d6d409a1","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.758Z"}
{"type":"request_end","traceId":"df3ff6e2-cb90-4db2-9c31-2e6e95adf063","spanId":"d6d409a1","method":"POST","path":"/api/save-document","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:31:39.760Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should save a document with valid data
2026-01-17T15:31:39.758Z [WARN] CSRF token missing {"path":"/api/save-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[33m 572[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[39m[32m 69[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 71[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[39m[32m 21[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 11[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 17[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 15[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 26[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 14[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 13[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"0efa781f-2393-45e5-8e8c-25f28ca7096c","spanId":"da8d26a9","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:31:39.773Z"}
{"type":"request_end","traceId":"0efa781f-2393-45e5-8e8c-25f28ca7096c","spanId":"da8d26a9","method":"POST","path":"/api/save-document","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:31:39.774Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should reject save request without required fields
2026-01-17T15:31:39.774Z [WARN] CSRF token missing {"path":"/api/save-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[33m 570[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[39m[32m 132[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[32m 28[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[39m[32m 47[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[39m[32m 15[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[39m[32m 44[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 200 "OK", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 400 "Bad Request", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 14[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[39m[32m 21[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 200, 500, 503 ] to include 403[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[32m 25[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 6[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 30 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
AssertionError: expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"
 Î“Â¥Â» tests/integration/documents.test.ts:28:29
     26|         .expect(200);
     27| 
     28|       expect(response.body).toHaveProperty('templates');
       |                             ^
     29|       expect(Array.isArray(response.body.templates)).toBe(true);
     30|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:57:10
     55|           category: 'policy'
     56|         })
     57|         .expect(401);
       |          ^
     58|     });
     59| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:66:10
     64|           files: []
     65|         })
     66|         .expect(401);
       |          ^
     67|     });
     68|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
Error: expected 200 "OK", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:79:10
     77|           filename: 'test-doc'
     78|         })
     79|         .expect(200);
       |          ^
     80| 
     81|       expect(response.headers['content-type']).toContain('text/markdowÎ“Ã‡Âª
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
Error: expected 400 "Bad Request", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:90:10
     88|           format: 'md'
     89|         })
     90|         .expect(400);
       |          ^
     91|     });
     92|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
AssertionError: expected [ 200, 500, 503 ] to include 403
 Î“Â¥Â» tests/integration/documents.test.ts:120:31
    118|         });
    119| 
    120|       expect([200, 500, 503]).toContain(response.status);
       |                               ^
    121|     });
    122|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:138:10
    136|           changeDescription: 'Updated policy'
    137|         })
    138|         .expect(401);
       |          ^
    139|     });
    140| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:30:10
     28|           companyProfileId: 'test-profile-id'
     29|         })
     30|         .expect(401);
       |          ^
     31|     });
     32| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[9/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:39:10
     37|           status: 'in_progress'
     38|         })
     39|         .expect(401);
       |          ^
     40|     });
     41|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[10/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
AssertionError: expected [ 500, 503 ] to include 403
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:57:28
     55|         expect(response.body).toHaveProperty('recommendations');
     56|       } else {
     57|         expect([500, 503]).toContain(response.status);
       |                            ^
     58|       }
     59|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[11/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
AssertionError: expected 403 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 403

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:74:33
     72|           });
     73| 
     74|         expect(response.status).toBe(401);
       |                                 ^
     75|       });
     76|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[12/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:129:10
    127|           completedAt: new Date().toISOString()
    128|         })
    129|         .expect(401);
       |          ^
    130|     });
    131|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[13/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected [ 401, 404 ] to include 403
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:184:26
    182|         });
    183| 
    184|       expect([401, 404]).toContain(response.status);
       |                          ^
    185|     });
    186|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[14/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:32:12
     30|             size: 'medium'
     31|           })
     32|           .expect(401);
       |            ^
     33|       });
     34| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[15/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:55:12
     53|           .post('/api/company-profiles')
     54|           .send(profileData)
     55|           .expect(401);
       |            ^
     56|       });
     57| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[16/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:72:12
     70|             complianceFrameworks: ['ISO 27001', 'SOC 2', 'FedRAMP']
     71|           })
     72|           .expect(401);
       |            ^
     73|       });
     74|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[17/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[18/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[19/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:120:12
    118|             description: 'Test evidence document'
    119|           })
    120|           .expect(401);
       |            ^
    121|       });
    122| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[20/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:144:12
    142|             comments: 'Approved after review'
    143|           })
    144|           .expect(401);
       |            ^
    145|       });
    146|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[21/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:215:12
    213|             controlIds: ['CC6.1', 'CC6.7']
    214|           })
    215|           .expect(401);
       |            ^
    216|       });
    217|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[22/30]Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/api.test.ts:74:10
     72|         .post('/api/company-profiles')
     73|         .send(invalidPayload)
     74|         .expect(401); // Will be 401 due to auth, but would be 400 witÎ“Ã‡Âª
       |          ^
     75|     });
     76|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[23/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/auth.test.ts:61:10
     59|           category: 'policy'
     60|         })
     61|         .expect(401);
       |          ^
     62|     });
     63| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[24/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/auth.test.ts:71:10
     69|           companyProfileId: 'test-id'
     70|         })
     71|         .expect(401);
       |          ^
     72|     });
     73| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[25/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[26/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[27/30]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m30 failed[39m[22m[2m | [22m[1m[32m38 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:31:36
[2m   Duration [22m 17.39s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:32:17.327Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:32:17.355Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:32:17.359Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:32:17.369Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:32:17.371Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"37061332-467b-4211-af42-04df122e1376","spanId":"69ed3515","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.452Z"}
{"type":"request_end","traceId":"37061332-467b-4211-af42-04df122e1376","spanId":"69ed3515","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":11,"timestamp":"2026-01-17T15:32:17.463Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:32:17.455Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return system health status
[22m[39m[32m2026-01-17T15:32:17.463Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.463Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T15:32:17.476Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.476Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"c76c7475-d3de-4c48-890a-b053fe61687e","spanId":"e8560129","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.477Z"}
[32m2026-01-17T15:32:17.481Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.481Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"b95074a6-435b-45b1-9eba-715119310499","spanId":"06618445","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.480Z"}
{"type":"request_end","traceId":"b95074a6-435b-45b1-9eba-715119310499","spanId":"06618445","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:32:17.483Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
2026-01-17T15:32:17.480Z [WARN] CSRF token missing {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"153342f5-1a4a-46f7-9ac0-e9c914da5325","spanId":"1576e94f","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.489Z"}
{"type":"request_end","traceId":"153342f5-1a4a-46f7-9ac0-e9c914da5325","spanId":"1576e94f","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.491Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:32:17.490Z [WARN] CSRF token missing {"path":"/api/analyze-compliance-gaps","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"66707ac1-1c5b-4179-b84d-559b72837f8e","spanId":"89a0d98b","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.479Z"}
{"type":"request_end","traceId":"66707ac1-1c5b-4179-b84d-559b72837f8e","spanId":"89a0d98b","method":"POST","path":"/api/organizations","statusCode":403,"duration":12,"timestamp":"2026-01-17T15:32:17.491Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
2026-01-17T15:32:17.483Z [WARN] CSRF token missing {"path":"/api/organizations","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:32:17.492Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:32:17.498Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.498Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return AI health status
2026-01-17T15:32:17.500Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:32:17.502Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.502Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"793e4671-e22b-447b-ac6e-a5e430b52413","spanId":"a4d65988","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.502Z"}
{"type":"request_end","traceId":"793e4671-e22b-447b-ac6e-a5e430b52413","spanId":"a4d65988","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":4,"timestamp":"2026-01-17T15:32:17.506Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:32:17.503Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to AI health endpoint
2026-01-17T15:32:17.504Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"9dd21db1-93d1-4659-a736-7f31f3ace127","spanId":"dc5bbfa0","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.511Z"}
[32m2026-01-17T15:32:17.514Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.514Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"db01ce1e-761b-47fd-b00e-29bbeeee62b3","spanId":"bb0c06d2","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.517Z"}
{"type":"request_end","traceId":"db01ce1e-761b-47fd-b00e-29bbeeee62b3","spanId":"bb0c06d2","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.518Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:32:17.517Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"1e84eedd-0c70-4ca9-8ea7-436114504645","spanId":"e331759b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.523Z"}
{"type":"request_end","traceId":"1e84eedd-0c70-4ca9-8ea7-436114504645","spanId":"e331759b","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.525Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:32:17.524Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"c76c7475-d3de-4c48-890a-b053fe61687e","spanId":"e8560129","method":"GET","path":"/","statusCode":200,"duration":48,"timestamp":"2026-01-17T15:32:17.525Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"edbb4a2d-e9e4-4377-8c72-5a7e048e82ad","spanId":"8bf7facd","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.526Z"}
[32m2026-01-17T15:32:17.527Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.527Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication to list organizations
2026-01-17T15:32:17.523Z [WARN] Unknown API route accessed {"path":"/organizations","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"f3627ae3-3b14-4f05-901a-0bb8deb21910","spanId":"766bf987","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.528Z"}
[32m2026-01-17T15:32:17.528Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.528Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"d0fa86c0-bce3-4790-a14a-8af5142262ce","spanId":"d6740d7a","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.529Z"}
{"type":"request_end","traceId":"d0fa86c0-bce3-4790-a14a-8af5142262ce","spanId":"d6740d7a","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.531Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:32:17.530Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:32:17.528Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:32:17.529Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"edbb4a2d-e9e4-4377-8c72-5a7e048e82ad","spanId":"8bf7facd","method":"GET","path":"/api/auth/user","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:32:17.540Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"f3627ae3-3b14-4f05-901a-0bb8deb21910","spanId":"766bf987","method":"GET","path":"/api/auth/user","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:32:17.541Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Document Quality for Compliance > should analyze document quality against framework
2026-01-17T15:32:17.543Z [WARN] CSRF token missing {"path":"/api/analyze-document-quality","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"9f8849d6-7209-48dc-990f-fe04d8898eee","spanId":"ecf63c0c","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.543Z"}
{"type":"request_end","traceId":"9f8849d6-7209-48dc-990f-fe04d8898eee","spanId":"ecf63c0c","method":"POST","path":"/api/analyze-document-quality","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.544Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"9dd21db1-93d1-4659-a736-7f31f3ace127","spanId":"dc5bbfa0","method":"GET","path":"/api/organizations","statusCode":401,"duration":34,"timestamp":"2026-01-17T15:32:17.545Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"d0fce7fd-eb0a-4632-9578-f7091705433f","spanId":"b69fd506","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.547Z"}
[32m2026-01-17T15:32:17.547Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.547Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"adfeffa6-c163-4ca1-968a-d9fa57d7e02d","spanId":"9e7c81dd","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.547Z"}
[32m2026-01-17T15:32:17.548Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.548Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for company profiles
2026-01-17T15:32:17.548Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for /api/company-profiles
2026-01-17T15:32:17.549Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"d0fce7fd-eb0a-4632-9578-f7091705433f","spanId":"b69fd506","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:32:17.551Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"adfeffa6-c163-4ca1-968a-d9fa57d7e02d","spanId":"9e7c81dd","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:17.551Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"411fc669-85f5-4afa-a2b1-50b90dbd3dce","spanId":"25ccf156","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.550Z"}
[32m2026-01-17T15:32:17.552Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.552Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"9a573804-f719-48c2-8919-5f6a7407acf9","spanId":"85df65a6","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.552Z"}
[32m2026-01-17T15:32:17.553Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.553Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:32:17.554Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"8e8cff6f-ecc8-4f21-934f-32ae79bd333b","spanId":"b2e7b098","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.553Z"}
{"type":"request_end","traceId":"8e8cff6f-ecc8-4f21-934f-32ae79bd333b","spanId":"b2e7b098","method":"POST","path":"/api/company-profiles","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.555Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
2026-01-17T15:32:17.554Z [WARN] CSRF token missing {"path":"/api/company-profiles","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"7fb665d3-e701-40d0-8c63-fc44816bac0d","spanId":"2e3cd750","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.556Z"}
[32m2026-01-17T15:32:17.556Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.556Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for documents
2026-01-17T15:32:17.557Z [WARN] Unknown API route accessed {"path":"/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"7fb665d3-e701-40d0-8c63-fc44816bac0d","spanId":"2e3cd750","method":"GET","path":"/api/documents","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:17.560Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"f9a4b78e-6011-4e4a-9412-58081a80976a","spanId":"8f184789","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.561Z"}
[32m2026-01-17T15:32:17.562Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.562Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication to get company profile
2026-01-17T15:32:17.563Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"f9a4b78e-6011-4e4a-9412-58081a80976a","spanId":"8f184789","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:17.565Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"9a573804-f719-48c2-8919-5f6a7407acf9","spanId":"85df65a6","method":"GET","path":"/","statusCode":200,"duration":19,"timestamp":"2026-01-17T15:32:17.571Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for report access
2026-01-17T15:32:17.564Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"a7533a5f-073a-4c5e-a5a9-b80d38dd23d1","spanId":"a73c1478","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.577Z"}
{"type":"request_end","traceId":"a7533a5f-073a-4c5e-a5a9-b80d38dd23d1","spanId":"a73c1478","method":"POST","path":"/api/documents/generate","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:32:17.580Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"84bcacca-7875-4498-a7d6-86cb5508cf1d","spanId":"2328312d","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.578Z"}
{"type":"request_end","traceId":"84bcacca-7875-4498-a7d6-86cb5508cf1d","spanId":"2328312d","method":"PATCH","path":"/api/company-profiles/1","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.580Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
2026-01-17T15:32:17.577Z [WARN] CSRF token missing {"path":"/api/documents/generate","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:32:17.579Z [WARN] CSRF token missing {"path":"/api/company-profiles/1","method":"PATCH","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"411fc669-85f5-4afa-a2b1-50b90dbd3dce","spanId":"25ccf156","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":32,"timestamp":"2026-01-17T15:32:17.582Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"a6e123ea-b5f6-41a9-a606-153598ef4911","spanId":"3051a6ea","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.586Z"}
{"type":"request_end","traceId":"a6e123ea-b5f6-41a9-a606-153598ef4911","spanId":"3051a6ea","method":"POST","path":"/api/ai/generate","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.587Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
2026-01-17T15:32:17.586Z [WARN] CSRF token missing {"path":"/api/ai/generate","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"b5cecd3e-bde5-4b23-962b-29abb9677157","spanId":"c94def43","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.585Z"}
{"type":"request_end","traceId":"b5cecd3e-bde5-4b23-962b-29abb9677157","spanId":"c94def43","method":"POST","path":"/api/company-profiles","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:32:17.588Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
2026-01-17T15:32:17.585Z [WARN] CSRF token missing {"path":"/api/company-profiles","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"0e4e043c-63cf-4eae-8eb1-8477acf27129","spanId":"91e2801a","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.588Z"}
{"type":"request_end","traceId":"0e4e043c-63cf-4eae-8eb1-8477acf27129","spanId":"91e2801a","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.589Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:32:17.588Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"b7829dbc-2b31-4b35-a144-ea05e7c83457","spanId":"36aaa633","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.592Z"}
[32m2026-01-17T15:32:17.593Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.593Z"}[0m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 298[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return system health status[32m 54[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return AI health status[32m 29[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for user profile[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for company profiles[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for documents[32m 10[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m API Integration Tests[2m > [22mData Validation[2m > [22mshould validate company profile creation payload[39m[32m 29[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for specific report
2026-01-17T15:32:17.594Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports/test-report-id","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"b5ce01e8-9c8f-4cec-8e34-636a172f69e6","spanId":"79dfc7d0","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.595Z"}
[32m2026-01-17T15:32:17.595Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.595Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"659725b9-5778-488b-a4cd-2a0bbcd1421c","spanId":"b00ac862","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.595Z"}
{"type":"request_end","traceId":"659725b9-5778-488b-a4cd-2a0bbcd1421c","spanId":"b00ac862","method":"POST","path":"/api/ai/analyze","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.596Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"b7829dbc-2b31-4b35-a144-ea05e7c83457","spanId":"36aaa633","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:17.596Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:32:17.596Z [WARN] Unknown API route accessed {"path":"/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
2026-01-17T15:32:17.595Z [WARN] CSRF token missing {"path":"/api/ai/analyze","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"b5ce01e8-9c8f-4cec-8e34-636a172f69e6","spanId":"79dfc7d0","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:32:17.606Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:32:17.611Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.611Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"b3416624-1701-4ad9-ae42-7e629d8a5a58","spanId":"ff024611","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.610Z"}
{"type":"request_end","traceId":"b3416624-1701-4ad9-ae42-7e629d8a5a58","spanId":"ff024611","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.611Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
2026-01-17T15:32:17.610Z [WARN] CSRF token missing {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should return AI service health status
2026-01-17T15:32:17.612Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"7622e968-c82d-4f86-af6c-aa22d88d5526","spanId":"e794d48a","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.608Z"}
{"type":"request_end","traceId":"7622e968-c82d-4f86-af6c-aa22d88d5526","spanId":"e794d48a","method":"POST","path":"/api/documents/generate","statusCode":403,"duration":5,"timestamp":"2026-01-17T15:32:17.613Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
2026-01-17T15:32:17.609Z [WARN] CSRF token missing {"path":"/api/documents/generate","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"4c96dcc6-3a02-415a-9542-908ea3e942c7","spanId":"c575f28a","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.612Z"}
{"type":"request_end","traceId":"4c96dcc6-3a02-415a-9542-908ea3e942c7","spanId":"c575f28a","method":"POST","path":"/api/auth/mfa/setup","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.614Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
2026-01-17T15:32:17.612Z [WARN] CSRF token missing {"path":"/api/auth/mfa/setup","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"fe72c5c5-ec43-4cc4-984d-ff1d69102997","spanId":"ce87a52d","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.616Z"}
{"type":"request_end","traceId":"fe72c5c5-ec43-4cc4-984d-ff1d69102997","spanId":"ce87a52d","method":"POST","path":"/api/assess-risk","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.617Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:32:17.616Z [WARN] CSRF token missing {"path":"/api/assess-risk","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"e4bd219f-6168-497b-b9c3-f6039b6bea6f","spanId":"5f226409","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.620Z"}
{"type":"request_end","traceId":"e4bd219f-6168-497b-b9c3-f6039b6bea6f","spanId":"5f226409","method":"POST","path":"/api/documents/upload-and-extract","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.622Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
2026-01-17T15:32:17.621Z [WARN] CSRF token missing {"path":"/api/documents/upload-and-extract","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"68e78366-91c9-4a6b-ba76-ce8ae73ac902","spanId":"ad63a73e","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.625Z"}
{"type":"request_end","traceId":"68e78366-91c9-4a6b-ba76-ce8ae73ac902","spanId":"ad63a73e","method":"POST","path":"/api/calculate-compliance-score","statusCode":403,"duration":5,"timestamp":"2026-01-17T15:32:17.630Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:32:17.625Z [WARN] CSRF token missing {"path":"/api/calculate-compliance-score","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"d37bc89b-7278-4312-99a1-e6563096de53","spanId":"2d4ad960","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.625Z"}
[32m2026-01-17T15:32:17.631Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.631Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:32:17.632Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"2a9b2d07-99f6-4c92-8c58-eb00135fdbe2","spanId":"bf147b1f","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.623Z"}
{"type":"request_end","traceId":"2a9b2d07-99f6-4c92-8c58-eb00135fdbe2","spanId":"bf147b1f","method":"POST","path":"/api/evidence","statusCode":403,"duration":10,"timestamp":"2026-01-17T15:32:17.633Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:32:17.624Z [WARN] CSRF token missing {"path":"/api/evidence","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"1676587b-e924-494e-be5a-7054fb184d1d","spanId":"461175c2","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.632Z"}
{"type":"request_end","traceId":"1676587b-e924-494e-be5a-7054fb184d1d","spanId":"461175c2","method":"POST","path":"/api/export-document","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.634Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"d37bc89b-7278-4312-99a1-e6563096de53","spanId":"2d4ad960","method":"GET","path":"/api/auth/user","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:32:17.634Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"f53afb04-b00d-4e87-983f-841648031b87","spanId":"435128fa","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.635Z"}
{"type":"request_end","traceId":"f53afb04-b00d-4e87-983f-841648031b87","spanId":"435128fa","method":"POST","path":"/api/ai/analyze-gaps","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.637Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"bf548366-edd3-43fb-891e-e3885b4bbcb2","spanId":"2e24a374","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.642Z"}
[32m2026-01-17T15:32:17.645Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.645Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
2026-01-17T15:32:17.633Z [WARN] CSRF token missing {"path":"/api/export-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
2026-01-17T15:32:17.635Z [WARN] CSRF token missing {"path":"/api/ai/analyze-gaps","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"207dbfc8-f267-4e55-bd88-7ae38066c63e","spanId":"8dc76dd0","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.640Z"}
{"type":"request_end","traceId":"207dbfc8-f267-4e55-bd88-7ae38066c63e","spanId":"8dc76dd0","method":"POST","path":"/api/export-document","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.641Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T15:32:17.641Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.641Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"a25b6e1e-700d-44c2-be05-f259dfee7de0","spanId":"f7c64648","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.641Z"}
[32m2026-01-17T15:32:17.642Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.642Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:32:17.646Z [WARN] Unknown API route accessed {"path":"/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
2026-01-17T15:32:17.640Z [WARN] CSRF token missing {"path":"/api/export-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
2026-01-17T15:32:17.645Z [WARN] Unknown API route accessed {"path":"/frameworks/SOC2/controls","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"a25b6e1e-700d-44c2-be05-f259dfee7de0","spanId":"f7c64648","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":6,"timestamp":"2026-01-17T15:32:17.647Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"bf548366-edd3-43fb-891e-e3885b4bbcb2","spanId":"2e24a374","method":"GET","path":"/api/evidence","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:32:17.649Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m9 failed[39m[2m)[22m[33m 377[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[39m[32m 68[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 12[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 403[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[39m[32m 14[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 38[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 21[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 401, 404 ] to include 403[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 9[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"d902829c-8b47-409d-9885-463318813795","spanId":"dc97d0ca","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.650Z"}
{"type":"request_end","traceId":"d902829c-8b47-409d-9885-463318813795","spanId":"dc97d0ca","method":"POST","path":"/api/generate-document","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:17.652Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document AI Generation > should reject generation request without framework
2026-01-17T15:32:17.651Z [WARN] CSRF token missing {"path":"/api/generate-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T15:32:17.654Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.654Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"58bceb5e-108a-4502-90f7-9dae9375ec52","spanId":"43d981f5","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.654Z"}
[32m2026-01-17T15:32:17.655Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.655Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:32:17.655Z [WARN] Unknown API route accessed {"path":"/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"58bceb5e-108a-4502-90f7-9dae9375ec52","spanId":"43d981f5","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:32:17.660Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_start","traceId":"3846ee71-eb95-432b-92ed-2edec98eae68","spanId":"6cf3a470","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.657Z"}
{"type":"request_end","traceId":"3846ee71-eb95-432b-92ed-2edec98eae68","spanId":"6cf3a470","method":"POST","path":"/api/analyze-document-quality","statusCode":403,"duration":4,"timestamp":"2026-01-17T15:32:17.661Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
2026-01-17T15:32:17.657Z [WARN] CSRF token missing {"path":"/api/analyze-document-quality","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[33m 346[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 47[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 21[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[39m[32m 30[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 17[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 21[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(19) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 7[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"7a563c1b-ea25-4f03-a41f-2d8768e3cdcd","spanId":"a72fea52","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.664Z"}
{"type":"request_end","traceId":"7a563c1b-ea25-4f03-a41f-2d8768e3cdcd","spanId":"a72fea52","method":"POST","path":"/api/controls/1/approve","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.665Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:32:17.665Z [WARN] CSRF token missing {"path":"/api/controls/1/approve","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"bed62d69-23d7-47c0-89db-42cefd130400","spanId":"bfae5edf","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.670Z"}
[32m2026-01-17T15:32:17.671Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.671Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:32:17.671Z [WARN] Unknown API route accessed {"path":"/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"b050d14c-4814-49d0-a3ff-b40cea54871e","spanId":"6bd297b5","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.672Z"}
[32m2026-01-17T15:32:17.672Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.672Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"bed62d69-23d7-47c0-89db-42cefd130400","spanId":"bfae5edf","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:32:17.676Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version history
2026-01-17T15:32:17.676Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"b050d14c-4814-49d0-a3ff-b40cea54871e","spanId":"6bd297b5","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:32:17.680Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"6890c9af-1330-4cf0-9aba-c6510ce2ab92","spanId":"4da6e2c4","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.680Z"}
[32m2026-01-17T15:32:17.680Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.680Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to get audit entry details
2026-01-17T15:32:17.681Z [WARN] Unknown API route accessed {"path":"/audit-trail/1","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"6890c9af-1330-4cf0-9aba-c6510ce2ab92","spanId":"4da6e2c4","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:17.683Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"8a89c3aa-c48e-4917-a1e6-2afccf69de32","spanId":"5799f8e8","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.691Z"}
[32m2026-01-17T15:32:17.692Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.692Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:32:17.692Z [WARN] Unknown API route accessed {"path":"/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"8a89c3aa-c48e-4917-a1e6-2afccf69de32","spanId":"5799f8e8","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:17.694Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"ea568cfb-c878-48c8-a471-a7e4669b904a","spanId":"f34bfafe","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.694Z"}
{"type":"request_end","traceId":"ea568cfb-c878-48c8-a471-a7e4669b904a","spanId":"f34bfafe","method":"POST","path":"/api/documents/test-id/versions","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.695Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
2026-01-17T15:32:17.694Z [WARN] CSRF token missing {"path":"/api/documents/test-id/versions","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"17ac2b96-1b26-4305-a258-62fab655db90","spanId":"71236dd8","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.698Z"}
[32m2026-01-17T15:32:17.699Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.699Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:32:17.699Z [WARN] Unknown API route accessed {"path":"/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"17ac2b96-1b26-4305-a258-62fab655db90","spanId":"71236dd8","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:17.702Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"d5fce9da-1e49-437e-9d2d-6b8521d6b49c","spanId":"1c51e10e","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.701Z"}
{"type":"request_end","traceId":"d5fce9da-1e49-437e-9d2d-6b8521d6b49c","spanId":"1c51e10e","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.702Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
2026-01-17T15:32:17.701Z [WARN] CSRF token missing {"path":"/api/documents/test-id/versions/version-id/restore","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"0332eb3a-64ee-4e1f-b492-326c837f73e5","spanId":"5aa2d6bd","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.713Z"}
[32m2026-01-17T15:32:17.714Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.714Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"d6592958-e385-4e06-98e1-e07ffc1dc514","spanId":"1cd55dbb","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.714Z"}
[32m2026-01-17T15:32:17.715Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.715Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Comparison > should require authentication for version comparison
2026-01-17T15:32:17.715Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/1/compare/2","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:32:17.715Z [WARN] Unknown API route accessed {"path":"/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"0332eb3a-64ee-4e1f-b492-326c837f73e5","spanId":"5aa2d6bd","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:17.717Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"d6592958-e385-4e06-98e1-e07ffc1dc514","spanId":"1cd55dbb","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:17.717Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"05577c10-6635-42c7-b9bd-b6d3f322bd1d","spanId":"27fba31c","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.720Z"}
{"type":"request_end","traceId":"05577c10-6635-42c7-b9bd-b6d3f322bd1d","spanId":"27fba31c","method":"POST","path":"/api/save-document","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.721Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should save a document with valid data
2026-01-17T15:32:17.720Z [WARN] CSRF token missing {"path":"/api/save-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"b98d3647-dd26-4a75-9cc4-2e1c8db7c0c1","spanId":"916fa8c6","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.725Z"}
{"type":"request_end","traceId":"b98d3647-dd26-4a75-9cc4-2e1c8db7c0c1","spanId":"916fa8c6","method":"POST","path":"/api/save-document","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.726Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should reject save request without required fields
2026-01-17T15:32:17.725Z [WARN] CSRF token missing {"path":"/api/save-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"bb906792-1eed-4265-a77a-da38334a2d98","spanId":"a458cd95","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.726Z"}
[32m2026-01-17T15:32:17.727Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.727Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:32:17.727Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"bb906792-1eed-4265-a77a-da38334a2d98","spanId":"a458cd95","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:17.729Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[33m 413[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[39m[32m 94[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[32m 33[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[39m[32m 34[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[39m[32m 12[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 200 "OK", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 400 "Bad Request", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 6[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 200, 500, 503 ] to include 403[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[32m 19[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 5[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"852f71fe-3632-4291-bbe8-c9918b1a957c","spanId":"bbbc5d63","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.733Z"}
[32m2026-01-17T15:32:17.734Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.734Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis by framework
2026-01-17T15:32:17.734Z [WARN] Unknown API route accessed {"path":"/gap-analysis/ISO27001","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"852f71fe-3632-4291-bbe8-c9918b1a957c","spanId":"bbbc5d63","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:32:17.742Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"0ff9ebf5-85ae-4c11-8b3d-89c42cd5bf89","spanId":"8c118745","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.746Z"}
[32m2026-01-17T15:32:17.746Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.746Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Document to Audit Trail > should require authentication to track document changes
2026-01-17T15:32:17.747Z [WARN] Unknown API route accessed {"path":"/documents/1/history","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"0ff9ebf5-85ae-4c11-8b3d-89c42cd5bf89","spanId":"8c118745","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:17.749Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"3e8174b4-ff35-470f-acec-16e297b9155b","spanId":"cbc9915d","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.755Z"}
{"type":"request_end","traceId":"3e8174b4-ff35-470f-acec-16e297b9155b","spanId":"cbc9915d","method":"POST","path":"/api/evidence/1/controls","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:17.756Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:32:17.756Z [WARN] CSRF token missing {"path":"/api/evidence/1/controls","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"8db3e08c-2a05-4c57-a97d-eb369e6fb6e7","spanId":"7f037e2a","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:17.761Z"}
[32m2026-01-17T15:32:17.762Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:17.762Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:32:17.762Z [WARN] Unknown API route accessed {"path":"/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"8db3e08c-2a05-4c57-a97d-eb369e6fb6e7","spanId":"7f037e2a","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:17.765Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[33m 461[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[39m[32m 66[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 43[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 14[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 17[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 11[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[39m[32m 19[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 10[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 8[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 30 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
AssertionError: expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"
 Î“Â¥Â» tests/integration/documents.test.ts:28:29
     26|         .expect(200);
     27| 
     28|       expect(response.body).toHaveProperty('templates');
       |                             ^
     29|       expect(Array.isArray(response.body.templates)).toBe(true);
     30|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:57:10
     55|           category: 'policy'
     56|         })
     57|         .expect(401);
       |          ^
     58|     });
     59| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:66:10
     64|           files: []
     65|         })
     66|         .expect(401);
       |          ^
     67|     });
     68|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
Error: expected 200 "OK", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:79:10
     77|           filename: 'test-doc'
     78|         })
     79|         .expect(200);
       |          ^
     80| 
     81|       expect(response.headers['content-type']).toContain('text/markdowÎ“Ã‡Âª
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
Error: expected 400 "Bad Request", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:90:10
     88|           format: 'md'
     89|         })
     90|         .expect(400);
       |          ^
     91|     });
     92|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
AssertionError: expected [ 200, 500, 503 ] to include 403
 Î“Â¥Â» tests/integration/documents.test.ts:120:31
    118|         });
    119| 
    120|       expect([200, 500, 503]).toContain(response.status);
       |                               ^
    121|     });
    122|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:138:10
    136|           changeDescription: 'Updated policy'
    137|         })
    138|         .expect(401);
       |          ^
    139|     });
    140| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:30:10
     28|           companyProfileId: 'test-profile-id'
     29|         })
     30|         .expect(401);
       |          ^
     31|     });
     32| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[9/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:39:10
     37|           status: 'in_progress'
     38|         })
     39|         .expect(401);
       |          ^
     40|     });
     41|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[10/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
AssertionError: expected [ 500, 503 ] to include 403
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:57:28
     55|         expect(response.body).toHaveProperty('recommendations');
     56|       } else {
     57|         expect([500, 503]).toContain(response.status);
       |                            ^
     58|       }
     59|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[11/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
AssertionError: expected 403 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 403

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:74:33
     72|           });
     73| 
     74|         expect(response.status).toBe(401);
       |                                 ^
     75|       });
     76|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[12/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:129:10
    127|           completedAt: new Date().toISOString()
    128|         })
    129|         .expect(401);
       |          ^
    130|     });
    131|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[13/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected [ 401, 404 ] to include 403
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:184:26
    182|         });
    183| 
    184|       expect([401, 404]).toContain(response.status);
       |                          ^
    185|     });
    186|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[14/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:32:12
     30|             size: 'medium'
     31|           })
     32|           .expect(401);
       |            ^
     33|       });
     34| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[15/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:55:12
     53|           .post('/api/company-profiles')
     54|           .send(profileData)
     55|           .expect(401);
       |            ^
     56|       });
     57| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[16/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:72:12
     70|             complianceFrameworks: ['ISO 27001', 'SOC 2', 'FedRAMP']
     71|           })
     72|           .expect(401);
       |            ^
     73|       });
     74|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[17/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[18/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[19/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:120:12
    118|             description: 'Test evidence document'
    119|           })
    120|           .expect(401);
       |            ^
    121|       });
    122| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[20/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:144:12
    142|             comments: 'Approved after review'
    143|           })
    144|           .expect(401);
       |            ^
    145|       });
    146|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[21/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:215:12
    213|             controlIds: ['CC6.1', 'CC6.7']
    214|           })
    215|           .expect(401);
       |            ^
    216|       });
    217|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[22/30]Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/api.test.ts:74:10
     72|         .post('/api/company-profiles')
     73|         .send(invalidPayload)
     74|         .expect(401); // Will be 401 due to auth, but would be 400 witÎ“Ã‡Âª
       |          ^
     75|     });
     76|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[23/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/auth.test.ts:61:10
     59|           category: 'policy'
     60|         })
     61|         .expect(401);
       |          ^
     62|     });
     63| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[24/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis

Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/auth.test.ts:71:10
     69|           companyProfileId: 'test-id'
     70|         })
     71|         .expect(401);
       |          ^
     72|     });
     73| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[25/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[26/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(19) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[27/30]Î“Ã„Â»

[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m30 failed[39m[22m[2m | [22m[1m[32m38 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:32:14
[2m   Duration [22m 15.86s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m


Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Suites 5 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts [ tests/integration/documents.test.ts ]
 FAIL   unit  tests/integration/gap-analysis.test.ts [ tests/integration/gap-analysis.test.ts ]
 FAIL   unit  tests/integration/e2e-flows.test.ts [ tests/integration/e2e-flows.test.ts ]
 FAIL   unit  tests/integration/api.test.ts [ tests/integration/api.test.ts ]
 FAIL   unit  tests/integration/auth.test.ts [ tests/integration/auth.test.ts ]
Error: Transform failed with 1 error:
C:/software/cyberdocgen/server/routes.ts:197:4: ERROR: Expected ":" but found ";"
  Plugin: vite:esbuild
  File: C:/software/cyberdocgen/server/routes.ts:197:4
  
  Expected ":" but found ";"
  195|        const errorMessage = error instanceof Error ?  process.on('unhandledRejection', (reason) => {
  196|      logger.error('Unhandled rejection', { reason: String(reason) });
  197|    });
     |      ^
  198|      res.status(500).json({ message: "Health check failed", error: errorMessage });
  199|      }
  
 Î“Â¥Â» failureErrorWithLog node_modules/esbuild/lib/main.js:1467:15
 Î“Â¥Â» node_modules/esbuild/lib/main.js:736:50
 Î“Â¥Â» responseCallbacks.<computed> node_modules/esbuild/lib/main.js:603:9
 Î“Â¥Â» handleIncomingPacket node_modules/esbuild/lib/main.js:658:12
 Î“Â¥Â» Socket.readFromStdout node_modules/esbuild/lib/main.js:581:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/5]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [2mno tests[22m
[2m   Start at [22m 07:32:41
[2m   Duration [22m 1.60s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:32:57.983Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:32:57.994Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:32:58.003Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:32:58.016Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:32:58.022Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T15:32:58.110Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.110Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return system health status
[22m[39m[32m2026-01-17T15:32:58.111Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.111Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"236c1c12-95c3-4530-a86b-4a27c2a364a8","spanId":"dc3f20a3","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.117Z"}
{"type":"request_end","traceId":"236c1c12-95c3-4530-a86b-4a27c2a364a8","spanId":"dc3f20a3","method":"POST","path":"/api/organizations","statusCode":403,"duration":12,"timestamp":"2026-01-17T15:32:58.129Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
2026-01-17T15:32:58.120Z [WARN] CSRF token missing {"path":"/api/organizations","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"ff122925-b141-4bc1-9b67-3646b6ae21f4","spanId":"092ebcb8","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.129Z"}
[32m2026-01-17T15:32:58.133Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.133Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:32:58.138Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.138Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return AI health status
2026-01-17T15:32:58.139Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:32:58.141Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.141Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to AI health endpoint
2026-01-17T15:32:58.142Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:32:58.143Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"f6023e99-7c99-47d5-8f9e-888622b5d833","spanId":"071b6bd0","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.144Z"}
[32m2026-01-17T15:32:58.146Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.146Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"ff33dc6e-6baa-4131-b733-6bb1d2624abb","spanId":"11ed85f0","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.158Z"}
[32m2026-01-17T15:32:58.159Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.159Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication to list organizations
2026-01-17T15:32:58.156Z [WARN] Unknown API route accessed {"path":"/organizations","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"64ff0662-e708-4f8e-b892-e214ebf8d338","spanId":"ed6e66b5","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.148Z"}
{"type":"request_end","traceId":"64ff0662-e708-4f8e-b892-e214ebf8d338","spanId":"ed6e66b5","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":15,"timestamp":"2026-01-17T15:32:58.163Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:32:58.151Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:32:58.160Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"ff33dc6e-6baa-4131-b733-6bb1d2624abb","spanId":"11ed85f0","method":"GET","path":"/api/auth/user","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:32:58.169Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"206694fd-32a9-45b2-9469-40dfc32dc692","spanId":"5f8c1fe1","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.169Z"}
[32m2026-01-17T15:32:58.170Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.170Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"57f094a4-bb80-4b0a-b713-627ce3e4a04a","spanId":"20337ae2","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.175Z"}
[32m2026-01-17T15:32:58.176Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.176Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:32:58.171Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"f6023e99-7c99-47d5-8f9e-888622b5d833","spanId":"071b6bd0","method":"GET","path":"/api/organizations","statusCode":401,"duration":32,"timestamp":"2026-01-17T15:32:58.176Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for company profiles
2026-01-17T15:32:58.177Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"206694fd-32a9-45b2-9469-40dfc32dc692","spanId":"5f8c1fe1","method":"GET","path":"/api/auth/user","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:32:58.179Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"57f094a4-bb80-4b0a-b713-627ce3e4a04a","spanId":"20337ae2","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:58.179Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"ff122925-b141-4bc1-9b67-3646b6ae21f4","spanId":"092ebcb8","method":"GET","path":"/","statusCode":200,"duration":49,"timestamp":"2026-01-17T15:32:58.177Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"8440b69e-7e96-455f-81e6-97727c4a6a61","spanId":"d4bd599e","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.180Z"}
{"type":"request_end","traceId":"8440b69e-7e96-455f-81e6-97727c4a6a61","spanId":"d4bd599e","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:32:58.183Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
2026-01-17T15:32:58.180Z [WARN] CSRF token missing {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"69c0b6f5-a9b0-4198-99e9-858c11a1aae4","spanId":"164a3c46","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.185Z"}
[32m2026-01-17T15:32:58.186Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.186Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"eee4b58a-4d89-4a64-a07d-2889dfc852c9","spanId":"6e0cc7b1","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.186Z"}
[32m2026-01-17T15:32:58.186Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.186Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"447f479b-ef55-4a82-a4fe-b0341e77bf57","spanId":"ded447e3","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.185Z"}
{"type":"request_end","traceId":"447f479b-ef55-4a82-a4fe-b0341e77bf57","spanId":"ded447e3","method":"POST","path":"/api/company-profiles","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:32:58.188Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
2026-01-17T15:32:58.186Z [WARN] CSRF token missing {"path":"/api/company-profiles","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for documents
2026-01-17T15:32:58.187Z [WARN] Unknown API route accessed {"path":"/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"eee4b58a-4d89-4a64-a07d-2889dfc852c9","spanId":"6e0cc7b1","method":"GET","path":"/api/documents","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:58.190Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for /api/company-profiles
2026-01-17T15:32:58.187Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"c9bc995a-f195-469b-b12b-f1b43e3430b1","spanId":"d4133fdb","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.189Z"}
{"type":"request_end","traceId":"c9bc995a-f195-469b-b12b-f1b43e3430b1","spanId":"d4133fdb","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:32:58.192Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:32:58.190Z [WARN] CSRF token missing {"path":"/api/analyze-compliance-gaps","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"69c0b6f5-a9b0-4198-99e9-858c11a1aae4","spanId":"164a3c46","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:32:58.193Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"4112c59d-35c8-482e-84f5-82e72a5c7f8c","spanId":"10fcb1bb","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.195Z"}
[32m2026-01-17T15:32:58.196Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.196Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication to get company profile
2026-01-17T15:32:58.197Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"4112c59d-35c8-482e-84f5-82e72a5c7f8c","spanId":"10fcb1bb","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:58.199Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"85e18225-da31-45d1-b752-6ccecd558a62","spanId":"6618641e","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.198Z"}
[32m2026-01-17T15:32:58.199Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.199Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:32:58.201Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"0230e5f6-88d4-41d2-b04c-963bdd018adb","spanId":"ef19a781","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.208Z"}
{"type":"request_end","traceId":"0230e5f6-88d4-41d2-b04c-963bdd018adb","spanId":"ef19a781","method":"PATCH","path":"/api/company-profiles/1","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.209Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:32:58.208Z [WARN] CSRF token missing {"path":"/api/company-profiles/1","method":"PATCH","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"35bd1da1-b454-47ab-b138-22e40970e4a6","spanId":"8e85e9b9","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.209Z"}
{"type":"request_end","traceId":"35bd1da1-b454-47ab-b138-22e40970e4a6","spanId":"8e85e9b9","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.211Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:32:58.209Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"4de8250f-c17d-479b-8b2b-34c966f3b960","spanId":"4956800e","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.214Z"}
{"type":"request_end","traceId":"4de8250f-c17d-479b-8b2b-34c966f3b960","spanId":"4956800e","method":"POST","path":"/api/ai/generate","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.216Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"85e18225-da31-45d1-b752-6ccecd558a62","spanId":"6618641e","method":"GET","path":"/","statusCode":200,"duration":18,"timestamp":"2026-01-17T15:32:58.216Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
2026-01-17T15:32:58.215Z [WARN] CSRF token missing {"path":"/api/ai/generate","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"b033e278-b5cc-4b2e-a197-e55381676ef4","spanId":"7eddf30e","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.219Z"}
{"type":"request_end","traceId":"b033e278-b5cc-4b2e-a197-e55381676ef4","spanId":"7eddf30e","method":"POST","path":"/api/documents/generate","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:32:58.222Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
2026-01-17T15:32:58.219Z [WARN] CSRF token missing {"path":"/api/documents/generate","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"ac648010-315a-4c84-8503-a93b49c2afe4","spanId":"080b9da7","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.223Z"}
{"type":"request_end","traceId":"ac648010-315a-4c84-8503-a93b49c2afe4","spanId":"080b9da7","method":"POST","path":"/api/ai/analyze","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:58.224Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"76e8df7b-64c2-48ae-a6e3-b65da141c572","spanId":"14b6672b","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.221Z"}
{"type":"request_end","traceId":"76e8df7b-64c2-48ae-a6e3-b65da141c572","spanId":"14b6672b","method":"POST","path":"/api/company-profiles","statusCode":403,"duration":4,"timestamp":"2026-01-17T15:32:58.225Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
2026-01-17T15:32:58.223Z [WARN] CSRF token missing {"path":"/api/ai/analyze","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
2026-01-17T15:32:58.222Z [WARN] CSRF token missing {"path":"/api/company-profiles","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"3ed96b53-f4a3-4619-9a24-16574c010857","spanId":"20f07c85","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.223Z"}
{"type":"request_end","traceId":"3ed96b53-f4a3-4619-9a24-16574c010857","spanId":"20f07c85","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.225Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:32:58.224Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[32m 289[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return system health status[32m 40[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return AI health status[32m 25[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for user profile[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for company profiles[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for documents[32m 10[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m API Integration Tests[2m > [22mData Validation[2m > [22mshould validate company profile creation payload[39m[32m 36[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"f2cda6b2-ea4f-43ef-bf8e-829a24b34830","spanId":"e90ba47f","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.230Z"}
{"type":"request_end","traceId":"f2cda6b2-ea4f-43ef-bf8e-829a24b34830","spanId":"e90ba47f","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.232Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:32:58.231Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:32:58.232Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.232Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should return AI service health status
2026-01-17T15:32:58.233Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"9f1e32ec-7d59-42f6-b865-6872618e46ce","spanId":"86a6d4f2","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.233Z"}
{"type":"request_end","traceId":"9f1e32ec-7d59-42f6-b865-6872618e46ce","spanId":"86a6d4f2","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.235Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:32:58.233Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"d0b86ca5-7c72-4cdc-9c8a-c61f3bfba158","spanId":"703ee8d9","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.237Z"}
[32m2026-01-17T15:32:58.238Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.238Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:32:58.239Z [WARN] Unknown API route accessed {"path":"/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"d0b86ca5-7c72-4cdc-9c8a-c61f3bfba158","spanId":"703ee8d9","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:58.241Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"a5837831-2da5-4c5c-bced-b5996af6929d","spanId":"0ba0665b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.241Z"}
{"type":"request_end","traceId":"a5837831-2da5-4c5c-bced-b5996af6929d","spanId":"0ba0665b","method":"POST","path":"/api/gap-analysis","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.243Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:32:58.242Z [WARN] CSRF token missing {"path":"/api/gap-analysis","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"64ea7adc-2649-455a-b4c7-af798e27d1ac","spanId":"60abdeed","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.244Z"}
{"type":"request_end","traceId":"64ea7adc-2649-455a-b4c7-af798e27d1ac","spanId":"60abdeed","method":"POST","path":"/api/documents/generate","statusCode":403,"duration":5,"timestamp":"2026-01-17T15:32:58.249Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
2026-01-17T15:32:58.244Z [WARN] CSRF token missing {"path":"/api/documents/generate","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"ed641715-30ee-45f9-b4c6-6713e4bbbdd9","spanId":"a0944e4d","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.250Z"}
{"type":"request_end","traceId":"ed641715-30ee-45f9-b4c6-6713e4bbbdd9","spanId":"a0944e4d","method":"POST","path":"/api/evidence","statusCode":403,"duration":3,"timestamp":"2026-01-17T15:32:58.252Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:32:58.250Z [WARN] CSRF token missing {"path":"/api/evidence","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"24aa067e-40f8-42bb-9485-76d9a9fb4cf5","spanId":"9129824f","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.250Z"}
{"type":"request_end","traceId":"24aa067e-40f8-42bb-9485-76d9a9fb4cf5","spanId":"9129824f","method":"POST","path":"/api/analyze-document-quality","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.252Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Document Quality for Compliance > should analyze document quality against framework
2026-01-17T15:32:58.250Z [WARN] CSRF token missing {"path":"/api/analyze-document-quality","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"69caa305-4498-4b9b-9f1d-19b6b97e4274","spanId":"6fc38e4d","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.251Z"}
{"type":"request_end","traceId":"69caa305-4498-4b9b-9f1d-19b6b97e4274","spanId":"6fc38e4d","method":"POST","path":"/api/auth/mfa/setup","statusCode":403,"duration":4,"timestamp":"2026-01-17T15:32:58.255Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
2026-01-17T15:32:58.252Z [WARN] CSRF token missing {"path":"/api/auth/mfa/setup","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"ff2ab535-1393-4cd9-bf02-8872927e18f8","spanId":"2d89f93d","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.258Z"}
[32m2026-01-17T15:32:58.259Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.259Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"780648f8-183e-4f05-9e59-f8d0277b0c36","spanId":"abdd245c","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.257Z"}
{"type":"request_end","traceId":"780648f8-183e-4f05-9e59-f8d0277b0c36","spanId":"abdd245c","method":"POST","path":"/api/documents/upload-and-extract","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.259Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
2026-01-17T15:32:58.258Z [WARN] CSRF token missing {"path":"/api/documents/upload-and-extract","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:32:58.260Z [WARN] Unknown API route accessed {"path":"/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"1f41772e-5dda-4d9c-b214-d766dd09cdff","spanId":"0cfb8e18","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.259Z"}
[32m2026-01-17T15:32:58.261Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.261Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"54dc791b-f88a-4409-855e-9572539c785c","spanId":"83fc4250","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.262Z"}
[32m2026-01-17T15:32:58.263Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.263Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"ff2ab535-1393-4cd9-bf02-8872927e18f8","spanId":"2d89f93d","method":"GET","path":"/api/evidence","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:32:58.263Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:32:58.264Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"54dc791b-f88a-4409-855e-9572539c785c","spanId":"83fc4250","method":"GET","path":"/api/auth/user","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:58.266Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"e6a63f1b-e1aa-4061-bb98-ff701805da59","spanId":"a1643780","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.269Z"}
{"type":"request_end","traceId":"e6a63f1b-e1aa-4061-bb98-ff701805da59","spanId":"a1643780","method":"POST","path":"/api/export-document","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:58.270Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
2026-01-17T15:32:58.269Z [WARN] CSRF token missing {"path":"/api/export-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"6196894d-c627-4b85-905a-39fbc67d2ee9","spanId":"938f341d","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.270Z"}
[32m2026-01-17T15:32:58.271Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.271Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T15:32:58.273Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.273Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:32:58.272Z [WARN] Unknown API route accessed {"path":"/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"6196894d-c627-4b85-905a-39fbc67d2ee9","spanId":"938f341d","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:58.274Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"4eea9448-006c-42dd-b6e0-eec32f57ea6b","spanId":"fc9991c2","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.276Z"}
{"type":"request_end","traceId":"4eea9448-006c-42dd-b6e0-eec32f57ea6b","spanId":"fc9991c2","method":"POST","path":"/api/export-document","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.278Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for report access
2026-01-17T15:32:58.273Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
2026-01-17T15:32:58.277Z [WARN] CSRF token missing {"path":"/api/export-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"4633ffe4-3ed0-48ec-80ae-6f877216b03e","spanId":"4fd3ae4c","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.279Z"}
{"type":"request_end","traceId":"4633ffe4-3ed0-48ec-80ae-6f877216b03e","spanId":"4fd3ae4c","method":"POST","path":"/api/controls/1/approve","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.281Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:32:58.280Z [WARN] CSRF token missing {"path":"/api/controls/1/approve","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T15:32:58.284Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.283Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"8b56374c-c3b3-4e13-a924-767d464a6413","spanId":"d061a410","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.284Z"}
{"type":"request_end","traceId":"8b56374c-c3b3-4e13-a924-767d464a6413","spanId":"d061a410","method":"POST","path":"/api/generate-document","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.286Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document AI Generation > should reject generation request without framework
2026-01-17T15:32:58.284Z [WARN] CSRF token missing {"path":"/api/generate-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"ae5ba031-b607-46af-a81f-d1a1aa423117","spanId":"40ef3c69","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.286Z"}
[32m2026-01-17T15:32:58.286Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.286Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:32:58.287Z [WARN] Unknown API route accessed {"path":"/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"ae5ba031-b607-46af-a81f-d1a1aa423117","spanId":"40ef3c69","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:32:58.288Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[33m 349[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 45[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 25[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 21[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 13[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[39m[32m 31[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 11[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(19) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 11[2mms[22m[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"1f41772e-5dda-4d9c-b214-d766dd09cdff","spanId":"0cfb8e18","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":33,"timestamp":"2026-01-17T15:32:58.292Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_start","traceId":"dd08efb9-c1f2-4a55-b306-dc4367c15739","spanId":"6337e1ad","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.292Z"}
{"type":"request_end","traceId":"dd08efb9-c1f2-4a55-b306-dc4367c15739","spanId":"6337e1ad","method":"POST","path":"/api/analyze-document-quality","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:58.293Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
2026-01-17T15:32:58.292Z [WARN] CSRF token missing {"path":"/api/analyze-document-quality","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"a8f3cc2d-6ae7-4caa-bd62-f839cd905369","spanId":"4e5fa022","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.293Z"}
[32m2026-01-17T15:32:58.293Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.293Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to get audit entry details
2026-01-17T15:32:58.294Z [WARN] Unknown API route accessed {"path":"/audit-trail/1","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"a8f3cc2d-6ae7-4caa-bd62-f839cd905369","spanId":"4e5fa022","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:58.296Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"01400c22-3406-4dae-9043-a00fc14b37d5","spanId":"da508bd2","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.299Z"}
[32m2026-01-17T15:32:58.300Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.300Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for specific report
2026-01-17T15:32:58.301Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports/test-report-id","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"6a5e0895-6b94-48fc-85e1-5a89c6d7fad9","spanId":"b890ccf1","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.303Z"}
[32m2026-01-17T15:32:58.304Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.304Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"01400c22-3406-4dae-9043-a00fc14b37d5","spanId":"da508bd2","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:32:58.305Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:32:58.305Z [WARN] Unknown API route accessed {"path":"/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"ca9d1830-f6e8-448c-8b7d-4e49bddfd2a0","spanId":"7313f6d6","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.305Z"}
[32m2026-01-17T15:32:58.305Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.305Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"6a5e0895-6b94-48fc-85e1-5a89c6d7fad9","spanId":"b890ccf1","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:58.307Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version history
2026-01-17T15:32:58.306Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"ca9d1830-f6e8-448c-8b7d-4e49bddfd2a0","spanId":"7313f6d6","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:32:58.311Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"0a87ad1a-d0d6-4c77-924f-f97e578a79f9","spanId":"2b1ec0df","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.312Z"}
[32m2026-01-17T15:32:58.313Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.313Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:32:58.314Z [WARN] Unknown API route accessed {"path":"/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"0a87ad1a-d0d6-4c77-924f-f97e578a79f9","spanId":"2b1ec0df","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:32:58.317Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"fd302491-1fb7-43e5-9524-12f980cefd28","spanId":"4cce03c6","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.317Z"}
{"type":"request_end","traceId":"fd302491-1fb7-43e5-9524-12f980cefd28","spanId":"4cce03c6","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.319Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
2026-01-17T15:32:58.317Z [WARN] CSRF token missing {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"70fec19b-f346-42f3-8635-6036096b681e","spanId":"d67cd7a6","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.322Z"}
[32m2026-01-17T15:32:58.323Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.323Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"23536752-d040-47ac-a807-799911bf04e3","spanId":"9baee1b2","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.323Z"}
{"type":"request_end","traceId":"23536752-d040-47ac-a807-799911bf04e3","spanId":"9baee1b2","method":"POST","path":"/api/documents/test-id/versions","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.325Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"0c117c52-bb49-43ae-8ed6-c21c3ccd64b6","spanId":"d861eafa","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.324Z"}
{"type":"request_end","traceId":"0c117c52-bb49-43ae-8ed6-c21c3ccd64b6","spanId":"d861eafa","method":"POST","path":"/api/assess-risk","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.326Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:32:58.324Z [WARN] Unknown API route accessed {"path":"/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
2026-01-17T15:32:58.324Z [WARN] CSRF token missing {"path":"/api/documents/test-id/versions","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:32:58.325Z [WARN] CSRF token missing {"path":"/api/assess-risk","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"70fec19b-f346-42f3-8635-6036096b681e","spanId":"d67cd7a6","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:32:58.326Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"b111d91b-70fa-4f63-8033-942ed9bfd364","spanId":"c88a83b5","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.331Z"}
{"type":"request_end","traceId":"b111d91b-70fa-4f63-8033-942ed9bfd364","spanId":"c88a83b5","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:58.332Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"7a628da1-3cf9-4a30-87d0-2dc10fce3cd7","spanId":"6816179e","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.331Z"}
{"type":"request_end","traceId":"7a628da1-3cf9-4a30-87d0-2dc10fce3cd7","spanId":"6816179e","method":"POST","path":"/api/calculate-compliance-score","statusCode":403,"duration":1,"timestamp":"2026-01-17T15:32:58.332Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
2026-01-17T15:32:58.331Z [WARN] CSRF token missing {"path":"/api/documents/test-id/versions/version-id/restore","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:32:58.331Z [WARN] CSRF token missing {"path":"/api/calculate-compliance-score","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"33bfcc1c-1986-4d19-b9d1-c31a2dcbe2a5","spanId":"e75ade23","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.337Z"}
[32m2026-01-17T15:32:58.337Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.337Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"1aae0b66-028c-423c-b0a0-3bae51d061ca","spanId":"cafde669","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.338Z"}
[32m2026-01-17T15:32:58.338Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.338Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:32:58.338Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"bbae5da1-d30d-432b-9374-ec02c77bf6e8","spanId":"1700b7e5","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.337Z"}
{"type":"request_end","traceId":"bbae5da1-d30d-432b-9374-ec02c77bf6e8","spanId":"1700b7e5","method":"POST","path":"/api/ai/analyze-gaps","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.339Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
2026-01-17T15:32:58.338Z [WARN] CSRF token missing {"path":"/api/ai/analyze-gaps","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"33bfcc1c-1986-4d19-b9d1-c31a2dcbe2a5","spanId":"e75ade23","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:58.340Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Comparison > should require authentication for version comparison
2026-01-17T15:32:58.339Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/1/compare/2","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"1aae0b66-028c-423c-b0a0-3bae51d061ca","spanId":"cafde669","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:58.341Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"005efe0f-720e-40f0-b125-3c0723b7322d","spanId":"0931c8eb","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.345Z"}
[32m2026-01-17T15:32:58.346Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.346Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"85933c0a-4ae6-495d-aefe-0e23683badcd","spanId":"b7b51ce5","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.345Z"}
[32m2026-01-17T15:32:58.346Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.346Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis by framework
2026-01-17T15:32:58.346Z [WARN] Unknown API route accessed {"path":"/gap-analysis/ISO27001","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"005efe0f-720e-40f0-b125-3c0723b7322d","spanId":"0931c8eb","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:58.348Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"dbcd46aa-baba-43cf-a6d7-02f0376713cf","spanId":"7c563611","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.346Z"}
{"type":"request_end","traceId":"dbcd46aa-baba-43cf-a6d7-02f0376713cf","spanId":"7c563611","method":"POST","path":"/api/save-document","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.348Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
2026-01-17T15:32:58.347Z [WARN] Unknown API route accessed {"path":"/frameworks/SOC2/controls","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should save a document with valid data
2026-01-17T15:32:58.347Z [WARN] CSRF token missing {"path":"/api/save-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"85933c0a-4ae6-495d-aefe-0e23683badcd","spanId":"b7b51ce5","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":4,"timestamp":"2026-01-17T15:32:58.349Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"2e663976-6daf-4b6b-8837-0f6df9f2fd66","spanId":"50a569be","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.351Z"}
[32m2026-01-17T15:32:58.352Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.352Z"}[0m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m9 failed[39m[2m)[22m[33m 406[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[39m[32m 62[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 14[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 403[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[39m[32m 19[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 403 to be 401 // Object.is equality[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 40[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[39m[32m 14[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 6[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 401, 404 ] to include 403[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 9[2mms[22m[39m
stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Document to Audit Trail > should require authentication to track document changes
2026-01-17T15:32:58.353Z [WARN] Unknown API route accessed {"path":"/documents/1/history","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"4c88afab-1c8d-4dc8-8e77-9dc478a7cb00","spanId":"21178681","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.352Z"}
{"type":"request_end","traceId":"4c88afab-1c8d-4dc8-8e77-9dc478a7cb00","spanId":"21178681","method":"POST","path":"/api/save-document","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.354Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"2e663976-6daf-4b6b-8837-0f6df9f2fd66","spanId":"50a569be","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:58.354Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should reject save request without required fields
2026-01-17T15:32:58.353Z [WARN] CSRF token missing {"path":"/api/save-document","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[33m 392[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[39m[32m 83[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[32m 33[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[39m[32m 25[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 200 "OK", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 400 "Bad Request", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 200, 500, 503 ] to include 403[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[32m 19[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 7[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"c06f0004-6b1b-4b73-ac7e-778e88441544","spanId":"c965a897","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.359Z"}
{"type":"request_end","traceId":"c06f0004-6b1b-4b73-ac7e-778e88441544","spanId":"c965a897","method":"POST","path":"/api/evidence/1/controls","statusCode":403,"duration":2,"timestamp":"2026-01-17T15:32:58.361Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:32:58.360Z [WARN] CSRF token missing {"path":"/api/evidence/1/controls","method":"POST","hasSession":false,"hasCookie":false,"hasHeader":false,"ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"69777bbf-191c-48ab-9b09-6378266acf5c","spanId":"2ce5fda4","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:32:58.366Z"}
[32m2026-01-17T15:32:58.366Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:32:58.366Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:32:58.367Z [WARN] Unknown API route accessed {"path":"/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"69777bbf-191c-48ab-9b09-6378266acf5c","spanId":"2ce5fda4","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:32:58.369Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m8 failed[39m[2m)[22m[33m 464[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[39m[32m 60[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 38[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 11[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 14[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[39m[32m 12[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 10[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 403 "Forbidden"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 8[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 30 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
AssertionError: expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"
 Î“Â¥Â» tests/integration/documents.test.ts:28:29
     26|         .expect(200);
     27| 
     28|       expect(response.body).toHaveProperty('templates');
       |                             ^
     29|       expect(Array.isArray(response.body.templates)).toBe(true);
     30|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:57:10
     55|           category: 'policy'
     56|         })
     57|         .expect(401);
       |          ^
     58|     });
     59| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:66:10
     64|           files: []
     65|         })
     66|         .expect(401);
       |          ^
     67|     });
     68|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
Error: expected 200 "OK", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:79:10
     77|           filename: 'test-doc'
     78|         })
     79|         .expect(200);
       |          ^
     80| 
     81|       expect(response.headers['content-type']).toContain('text/markdowÎ“Ã‡Âª
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
Error: expected 400 "Bad Request", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:90:10
     88|           format: 'md'
     89|         })
     90|         .expect(400);
       |          ^
     91|     });
     92|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
AssertionError: expected [ 200, 500, 503 ] to include 403
 Î“Â¥Â» tests/integration/documents.test.ts:120:31
    118|         });
    119| 
    120|       expect([200, 500, 503]).toContain(response.status);
       |                               ^
    121|     });
    122|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:138:10
    136|           changeDescription: 'Updated policy'
    137|         })
    138|         .expect(401);
       |          ^
    139|     });
    140| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/30]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:30:10
     28|           companyProfileId: 'test-profile-id'
     29|         })
     30|         .expect(401);
       |          ^
     31|     });
     32| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[9/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:39:10
     37|           status: 'in_progress'
     38|         })
     39|         .expect(401);
       |          ^
     40|     });
     41|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[10/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
AssertionError: expected [ 500, 503 ] to include 403
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:57:28
     55|         expect(response.body).toHaveProperty('recommendations');
     56|       } else {
     57|         expect([500, 503]).toContain(response.status);
       |                            ^
     58|       }
     59|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[11/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
AssertionError: expected 403 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 403

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:74:33
     72|           });
     73| 
     74|         expect(response.status).toBe(401);
       |                                 ^
     75|       });
     76|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[12/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:129:10
    127|           completedAt: new Date().toISOString()
    128|         })
    129|         .expect(401);
       |          ^
    130|     });
    131|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[13/30]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected [ 401, 404 ] to include 403
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:184:26
    182|         });
    183| 
    184|       expect([401, 404]).toContain(response.status);
       |                          ^
    185|     });
    186|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[14/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:32:12
     30|             size: 'medium'
     31|           })
     32|           .expect(401);
       |            ^
     33|       });
     34| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[15/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:55:12
     53|           .post('/api/company-profiles')
     54|           .send(profileData)
     55|           .expect(401);
       |            ^
     56|       });
     57| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[16/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:72:12
     70|             complianceFrameworks: ['ISO 27001', 'SOC 2', 'FedRAMP']
     71|           })
     72|           .expect(401);
       |            ^
     73|       });
     74|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[17/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[18/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[19/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:120:12
    118|             description: 'Test evidence document'
    119|           })
    120|           .expect(401);
       |            ^
    121|       });
    122| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[20/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:144:12
    142|             comments: 'Approved after review'
    143|           })
    144|           .expect(401);
       |            ^
    145|       });
    146|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[21/30]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:215:12
    213|             controlIds: ['CC6.1', 'CC6.7']
    214|           })
    215|           .expect(401);
       |            ^
    216|       });
    217|     });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[22/30]Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/api.test.ts:74:10
     72|         .post('/api/company-profiles')
     73|         .send(invalidPayload)
     74|         .expect(401); // Will be 401 due to auth, but would be 400 witÎ“Ã‡Âª
       |          ^
     75|     });
     76|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[23/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/auth.test.ts:61:10
     59|           category: 'policy'
     60|         })
     61|         .expect(401);
       |          ^
     62|     });
     63| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[24/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/auth.test.ts:71:10
     69|           companyProfileId: 'test-id'
     70|         })
     71|         .expect(401);
       |          ^
     72|     });
     73| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[25/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 403 "Forbidden"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[26/30]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(19) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[27/30]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m30 failed[39m[22m[2m | [22m[1m[32m38 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:32:54
[2m   Duration [22m 16.68s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/middleware/security.ts [22m[39m


Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Suites 5 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts [ tests/integration/documents.test.ts ]
 FAIL   unit  tests/integration/gap-analysis.test.ts [ tests/integration/gap-analysis.test.ts ]
 FAIL   unit  tests/integration/e2e-flows.test.ts [ tests/integration/e2e-flows.test.ts ]
 FAIL   unit  tests/integration/api.test.ts [ tests/integration/api.test.ts ]
 FAIL   unit  tests/integration/auth.test.ts [ tests/integration/auth.test.ts ]
Error: Transform failed with 1 error:
C:/software/cyberdocgen/server/middleware/security.ts:128:0: ERROR: Unexpected "}"
  Plugin: vite:esbuild
  File: C:/software/cyberdocgen/server/middleware/security.ts:128:0
  
  Unexpected "}"
  126|  
  127|    next();
  128|  }
     |  ^
  129|  
  130|  // Audit logging middleware
  
 Î“Â¥Â» failureErrorWithLog node_modules/esbuild/lib/main.js:1467:15
 Î“Â¥Â» node_modules/esbuild/lib/main.js:736:50
 Î“Â¥Â» responseCallbacks.<computed> node_modules/esbuild/lib/main.js:603:9
 Î“Â¥Â» handleIncomingPacket node_modules/esbuild/lib/main.js:658:12
 Î“Â¥Â» Socket.readFromStdout node_modules/esbuild/lib/main.js:581:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/5]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [2mno tests[22m
[2m   Start at [22m 07:36:09
[2m   Duration [22m 1.57s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/middleware/security.ts [22m[39m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:36:33.092Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:36:33.098Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:36:33.105Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:36:33.119Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:36:33.132Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return system health status
[22m[39m[32m2026-01-17T15:36:33.175Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.175Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"04c14db1-af1c-47cf-ba23-c39d4467ace7","spanId":"b16ba9f4","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.186Z"}
[32m2026-01-17T15:36:33.189Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.189Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:36:33.200Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:36:33.207Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.207Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"563e4121-0d1e-4cae-b714-fe76a7f61d8a","spanId":"c1a350c1","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.203Z"}
[32m2026-01-17T15:36:33.207Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.207Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return AI health status
2026-01-17T15:36:33.208Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"04c14db1-af1c-47cf-ba23-c39d4467ace7","spanId":"b16ba9f4","method":"GET","path":"/","statusCode":200,"duration":30,"timestamp":"2026-01-17T15:36:33.215Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"3fc8a5ff-ac42-4e55-87a2-7274d5e3abb8","spanId":"0a1795a1","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.216Z"}
[32m2026-01-17T15:36:33.217Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.217Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:36:33.218Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"3fc8a5ff-ac42-4e55-87a2-7274d5e3abb8","spanId":"0a1795a1","method":"GET","path":"/api/auth/user","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:36:33.226Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:36:33.218Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"1c8d3b09-abd5-48ca-bc48-8bd51cf4032a","spanId":"2a30d055","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.222Z"}
[32m2026-01-17T15:36:33.225Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.225Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"563e4121-0d1e-4cae-b714-fe76a7f61d8a","spanId":"c1a350c1","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":26,"timestamp":"2026-01-17T15:36:33.229Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T15:36:33.234Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.234Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
2026-01-17T15:36:33.238Z [WARN] Unknown API route accessed {"path":"/organizations","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"e61aef0d-af01-4697-805a-c9fcad8612d7","spanId":"2bc716f2","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.240Z"}
[32m2026-01-17T15:36:33.240Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.240Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for company profiles
2026-01-17T15:36:33.241Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"e61aef0d-af01-4697-805a-c9fcad8612d7","spanId":"2bc716f2","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.243Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"a57644cd-0205-4009-a665-8cd638589e45","spanId":"e52a6fa3","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.245Z"}
[32m2026-01-17T15:36:33.247Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.247Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"17b9e507-be56-488b-a93a-83a909d8df40","spanId":"46136847","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.247Z"}
[32m2026-01-17T15:36:33.248Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.248Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"1c8d3b09-abd5-48ca-bc48-8bd51cf4032a","spanId":"2a30d055","method":"POST","path":"/api/organizations","statusCode":401,"duration":26,"timestamp":"2026-01-17T15:36:33.248Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:36:33.247Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"73d9c16c-61b6-4c89-b236-16f2e96baa6f","spanId":"9c241368","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.248Z"}
[32m2026-01-17T15:36:33.249Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.249Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
2026-01-17T15:36:33.249Z [WARN] Unknown API route accessed {"path":"/gap-analysis/recommendations/test-id","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for documents
2026-01-17T15:36:33.250Z [WARN] Unknown API route accessed {"path":"/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"73d9c16c-61b6-4c89-b236-16f2e96baa6f","spanId":"9c241368","method":"GET","path":"/api/documents","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:33.252Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"17b9e507-be56-488b-a93a-83a909d8df40","spanId":"46136847","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:36:33.253Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"a57644cd-0205-4009-a665-8cd638589e45","spanId":"e52a6fa3","method":"GET","path":"/","statusCode":200,"duration":11,"timestamp":"2026-01-17T15:36:33.256Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"6bc26e96-e559-4273-9d3a-405bb88d7b33","spanId":"dae0019c","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.261Z"}
[32m2026-01-17T15:36:33.262Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.262Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:36:33.263Z [WARN] Unknown API route accessed {"path":"/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:36:33.264Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.264Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"6bc26e96-e559-4273-9d3a-405bb88d7b33","spanId":"dae0019c","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:33.265Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to AI health endpoint
2026-01-17T15:36:33.265Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"3e6fcc40-e6c6-4609-a768-daa1ec32abd9","spanId":"903f7fac","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.266Z"}
[32m2026-01-17T15:36:33.268Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.268Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"dd47a0cb-3de0-4257-8bc4-b567c1cb7c5b","spanId":"9b74f00b","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.270Z"}
[32m2026-01-17T15:36:33.271Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.271Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication to list organizations
2026-01-17T15:36:33.269Z [WARN] Unknown API route accessed {"path":"/organizations","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"3e6fcc40-e6c6-4609-a768-daa1ec32abd9","spanId":"903f7fac","method":"GET","path":"/api/organizations","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:36:33.272Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
2026-01-17T15:36:33.271Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"dd47a0cb-3de0-4257-8bc4-b567c1cb7c5b","spanId":"9b74f00b","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.273Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"1d8dd9fd-9465-44b8-937c-35a1a04a46ce","spanId":"7115cb36","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.272Z"}
[32m2026-01-17T15:36:33.273Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.273Z"}[0m

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 225[2mms[22m[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"1baa950d-1ad6-4d56-bf7c-e36ed77286ad","spanId":"21dec635","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.279Z"}
[32m2026-01-17T15:36:33.279Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.279Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"5e5ae1d5-1b8b-41b0-81d7-10372df92da5","spanId":"8a1240e0","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.278Z"}
[32m2026-01-17T15:36:33.279Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.279Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:36:33.273Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:36:33.280Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"1d8dd9fd-9465-44b8-937c-35a1a04a46ce","spanId":"7115cb36","method":"GET","path":"/api/auth/user","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:36:33.281Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"1baa950d-1ad6-4d56-bf7c-e36ed77286ad","spanId":"21dec635","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.282Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
2026-01-17T15:36:33.280Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"5e5ae1d5-1b8b-41b0-81d7-10372df92da5","spanId":"8a1240e0","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.282Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"4bbfcaf7-58df-470b-bfc9-8fea58cb93b5","spanId":"496b3671","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.288Z"}
[32m2026-01-17T15:36:33.288Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.288Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication to get company profile
2026-01-17T15:36:33.289Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"3f19f37f-6d55-48b6-85ca-963cb34b1e4a","spanId":"41d64bda","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.289Z"}
[32m2026-01-17T15:36:33.290Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.290Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"4bbfcaf7-58df-470b-bfc9-8fea58cb93b5","spanId":"496b3671","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.291Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"25ced0fa-ad59-427c-90dc-fa07d8c58957","spanId":"727df493","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.291Z"}
[32m2026-01-17T15:36:33.292Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.292Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for /api/company-profiles
2026-01-17T15:36:33.291Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:36:33.293Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"3f19f37f-6d55-48b6-85ca-963cb34b1e4a","spanId":"41d64bda","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:36:33.295Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"bb3dcdb2-3fd6-4641-a088-92c555b9e3be","spanId":"8f461975","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.297Z"}
[32m2026-01-17T15:36:33.297Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.297Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"25ced0fa-ad59-427c-90dc-fa07d8c58957","spanId":"727df493","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:36:33.297Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:36:33.298Z [WARN] Unknown API route accessed {"path":"/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"07ad1840-2b21-4a50-9a19-e47ddd10cc3f","spanId":"4e931094","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.297Z"}
[32m2026-01-17T15:36:33.299Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.299Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"bb3dcdb2-3fd6-4641-a088-92c555b9e3be","spanId":"8f461975","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.300Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"faeb8796-8718-4372-8753-4b72a468023c","spanId":"0af9f32e","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.306Z"}
[32m2026-01-17T15:36:33.307Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.307Z"}[0m
stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
2026-01-17T15:36:33.302Z [WARN] Unknown API route accessed {"path":"/documents/generate","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:36:33.307Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}


[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"07ad1840-2b21-4a50-9a19-e47ddd10cc3f","spanId":"4e931094","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:36:33.311Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"faeb8796-8718-4372-8753-4b72a468023c","spanId":"0af9f32e","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.309Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:36:33.319Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
2026-01-17T15:36:33.319Z [WARN] Unknown API route accessed {"path":"/ai/generate","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
2026-01-17T15:36:33.322Z [WARN] Unknown API route accessed {"path":"/documents/generate","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"a2720454-6c87-4aa4-873a-ed0fa2cf4ecf","spanId":"2ecd266b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.318Z"}
[32m2026-01-17T15:36:33.318Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.318Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"008ed22b-65e2-41c2-9f6b-703d174edaad","spanId":"9153f520","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.317Z"}
[32m2026-01-17T15:36:33.318Z [INFO] POST /api/ai/generate {"method":"POST","url":"/api/ai/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.318Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"a2720454-6c87-4aa4-873a-ed0fa2cf4ecf","spanId":"2ecd266b","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.320Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"0370d073-0d2f-4a29-a6fb-148b0a994577","spanId":"0cffe14f","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.320Z"}
[32m2026-01-17T15:36:33.321Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.321Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"008ed22b-65e2-41c2-9f6b-703d174edaad","spanId":"9153f520","method":"POST","path":"/api/ai/generate","statusCode":404,"duration":6,"timestamp":"2026-01-17T15:36:33.323Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"0370d073-0d2f-4a29-a6fb-148b0a994577","spanId":"0cffe14f","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:33.324Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"3bf7a655-abda-4f38-8e9d-02154b5319e1","spanId":"1ad8ef97","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.324Z"}
[32m2026-01-17T15:36:33.325Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.325Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"82fd5b31-4c18-405b-bb8c-8b33103344fe","spanId":"f1702379","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.328Z"}
[32m2026-01-17T15:36:33.328Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.328Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Document Quality for Compliance > should analyze document quality against framework
2026-01-17T15:36:33.329Z [WARN] Unknown API route accessed {"path":"/analyze-document-quality","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"82fd5b31-4c18-405b-bb8c-8b33103344fe","spanId":"f1702379","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.332Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"33286658-8fe6-4000-aaeb-be3537d4b714","spanId":"3bfd8c23","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.331Z"}
[32m2026-01-17T15:36:33.332Z [INFO] POST /api/ai/analyze {"method":"POST","url":"/api/ai/analyze","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.332Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
2026-01-17T15:36:33.332Z [WARN] Unknown API route accessed {"path":"/ai/analyze","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
2026-01-17T15:36:33.326Z [WARN] Unknown API route accessed {"path":"/documents/upload-and-extract","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"3bf7a655-abda-4f38-8e9d-02154b5319e1","spanId":"1ad8ef97","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:36:33.333Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"33286658-8fe6-4000-aaeb-be3537d4b714","spanId":"3bfd8c23","method":"POST","path":"/api/ai/analyze","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:36:33.334Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"e033efae-5b39-47cd-8e26-da04610bea86","spanId":"bc92026d","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.335Z"}
[32m2026-01-17T15:36:33.336Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.336Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:36:33.337Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"e033efae-5b39-47cd-8e26-da04610bea86","spanId":"bc92026d","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.338Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"1a7edb2c-6f82-40c4-8d2a-6da2b5ebdc0d","spanId":"bf57a029","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.339Z"}
[32m2026-01-17T15:36:33.340Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.340Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:36:33.341Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.341Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for report access
2026-01-17T15:36:33.341Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should return AI service health status
2026-01-17T15:36:33.342Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"1a7edb2c-6f82-40c4-8d2a-6da2b5ebdc0d","spanId":"bf57a029","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:33.343Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"21add9dc-b950-46d7-b312-f6a3cf5d2821","spanId":"287d1417","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.344Z"}
[32m2026-01-17T15:36:33.344Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.344Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
2026-01-17T15:36:33.345Z [WARN] Unknown API route accessed {"path":"/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"21add9dc-b950-46d7-b312-f6a3cf5d2821","spanId":"287d1417","method":"POST","path":"/export-document","statusCode":200,"duration":3,"timestamp":"2026-01-17T15:36:33.347Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"e7fa4192-2af6-4112-89e5-cde8c958da75","spanId":"973a5413","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.353Z"}
[32m2026-01-17T15:36:33.353Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.353Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:36:33.354Z [WARN] Unknown API route accessed {"path":"/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"e7fa4192-2af6-4112-89e5-cde8c958da75","spanId":"973a5413","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.355Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"8f187618-6084-406e-ab19-b77babacc795","spanId":"6f725552","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.357Z"}
[32m2026-01-17T15:36:33.357Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.357Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for specific report
2026-01-17T15:36:33.358Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports/test-report-id","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"8baee9a0-516b-40c8-8682-d33e9f3b9153","spanId":"b2727cfb","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.358Z"}
[32m2026-01-17T15:36:33.358Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.358Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"8f187618-6084-406e-ab19-b77babacc795","spanId":"6f725552","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.359Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"5274bbc3-a7b3-4d0a-a10a-9f35b9c9ec65","spanId":"9e5d66e3","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.358Z"}
[32m2026-01-17T15:36:33.359Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.359Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"182cd131-c5c9-4cbe-99f1-682cb114ff5e","spanId":"20039ce0","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.359Z"}
[32m2026-01-17T15:36:33.360Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.360Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:36:33.359Z [WARN] Unknown API route accessed {"path":"/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
2026-01-17T15:36:33.360Z [WARN] Unknown API route accessed {"path":"/auth/mfa/setup","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"182cd131-c5c9-4cbe-99f1-682cb114ff5e","spanId":"20039ce0","method":"POST","path":"/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:36:33.361Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"8baee9a0-516b-40c8-8682-d33e9f3b9153","spanId":"b2727cfb","method":"POST","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.361Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
2026-01-17T15:36:33.360Z [WARN] Unknown API route accessed {"path":"/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"5274bbc3-a7b3-4d0a-a10a-9f35b9c9ec65","spanId":"9e5d66e3","method":"POST","path":"/export-document","statusCode":400,"duration":4,"timestamp":"2026-01-17T15:36:33.362Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"d16f24c3-4d5a-480d-976e-79f6406eae1e","spanId":"ab6b4e16","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.365Z"}
[32m2026-01-17T15:36:33.366Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.366Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
2026-01-17T15:36:33.367Z [WARN] Unknown API route accessed {"path":"/gap-analysis/recommendations/test-rec-id","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"8e584a17-318a-419c-8ac1-af4ec41ba4e2","spanId":"15d0a7f0","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.366Z"}
[32m2026-01-17T15:36:33.366Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.366Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"d16f24c3-4d5a-480d-976e-79f6406eae1e","spanId":"ab6b4e16","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.368Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:36:33.367Z [WARN] Unknown API route accessed {"path":"/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"8e584a17-318a-419c-8ac1-af4ec41ba4e2","spanId":"15d0a7f0","method":"GET","path":"/api/evidence","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.368Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"92265283-1269-4745-9f76-37b2ddab963e","spanId":"3f7d246d","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.368Z"}
[32m2026-01-17T15:36:33.369Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.369Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document AI Generation > should reject generation request without framework
2026-01-17T15:36:33.369Z [WARN] Unknown API route accessed {"path":"/generate-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"92265283-1269-4745-9f76-37b2ddab963e","spanId":"3f7d246d","method":"POST","path":"/api/generate-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.371Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"06de22ac-2f6a-4fe5-b9db-2b7b1f3c6e80","spanId":"dd7a01b7","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.373Z"}
[32m2026-01-17T15:36:33.373Z [INFO] POST /api/assess-risk {"method":"POST","url":"/api/assess-risk","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.373Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"3c047bda-3785-4992-971b-45b97264d293","spanId":"dc4ef4c8","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.373Z"}
[32m2026-01-17T15:36:33.373Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.373Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:36:33.373Z [WARN] Unknown API route accessed {"path":"/assess-risk","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"374e97ad-2ee9-445d-a4af-da7e496bdd6a","spanId":"8644fe08","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.372Z"}
[32m2026-01-17T15:36:33.373Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.373Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"06de22ac-2f6a-4fe5-b9db-2b7b1f3c6e80","spanId":"dd7a01b7","method":"POST","path":"/api/assess-risk","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:36:33.375Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:36:33.374Z [WARN] Unknown API route accessed {"path":"/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"3c047bda-3785-4992-971b-45b97264d293","spanId":"dc4ef4c8","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.375Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:36:33.375Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_start","traceId":"489381cb-4a2a-4166-9c42-242f4cddcec3","spanId":"18d84ae1","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.376Z"}
[32m2026-01-17T15:36:33.376Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.376Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"374e97ad-2ee9-445d-a4af-da7e496bdd6a","spanId":"8644fe08","method":"GET","path":"/api/auth/user","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:36:33.377Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
2026-01-17T15:36:33.377Z [WARN] Unknown API route accessed {"path":"/analyze-document-quality","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_end","traceId":"489381cb-4a2a-4166-9c42-242f4cddcec3","spanId":"18d84ae1","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.378Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"467cd090-692b-4d17-ba3e-3c4626e76cb1","spanId":"c8e0a5ff","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.380Z"}
[32m2026-01-17T15:36:33.380Z [INFO] POST /api/calculate-compliance-score {"method":"POST","url":"/api/calculate-compliance-score","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.380Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"1caab23b-efbd-4c7b-9e27-c813407805ad","spanId":"df0518b3","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.379Z"}
[32m2026-01-17T15:36:33.380Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.380Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:36:33.380Z [WARN] Unknown API route accessed {"path":"/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:36:33.381Z [WARN] Unknown API route accessed {"path":"/calculate-compliance-score","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"467cd090-692b-4d17-ba3e-3c4626e76cb1","spanId":"c8e0a5ff","method":"POST","path":"/api/calculate-compliance-score","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:36:33.382Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"1caab23b-efbd-4c7b-9e27-c813407805ad","spanId":"df0518b3","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.381Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T15:36:33.383Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.383Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"3ba33276-11a0-470f-b209-a5e2406819b5","spanId":"74562470","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.385Z"}
[32m2026-01-17T15:36:33.386Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.386Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
2026-01-17T15:36:33.386Z [WARN] Unknown API route accessed {"path":"/ai/analyze-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"b5cc2068-9e20-4930-ac5a-193d35114134","spanId":"dad48d59","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.386Z"}
[32m2026-01-17T15:36:33.387Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.387Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"3ba33276-11a0-470f-b209-a5e2406819b5","spanId":"74562470","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:36:33.388Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:36:33.387Z [WARN] Unknown API route accessed {"path":"/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"eeb220d9-1405-4b57-91b6-aa4bad0b259f","spanId":"1203c550","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.388Z"}
[32m2026-01-17T15:36:33.388Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.388Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"b5cc2068-9e20-4930-ac5a-193d35114134","spanId":"dad48d59","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.389Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version history
2026-01-17T15:36:33.389Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"eeb220d9-1405-4b57-91b6-aa4bad0b259f","spanId":"1203c550","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:33.392Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"6fe2b944-aa3b-43e7-9230-4e9fcb17620e","spanId":"19ad6350","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.393Z"}
[32m2026-01-17T15:36:33.394Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.394Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"7b0ba08f-7a56-4ced-9606-cf816b84275f","spanId":"0b678eb0","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.393Z"}
[32m2026-01-17T15:36:33.394Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.394Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T15:36:33.394Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.394Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
2026-01-17T15:36:33.394Z [WARN] Unknown API route accessed {"path":"/frameworks/SOC2/controls","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to get audit entry details
2026-01-17T15:36:33.394Z [WARN] Unknown API route accessed {"path":"/audit-trail/1","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"6fe2b944-aa3b-43e7-9230-4e9fcb17620e","spanId":"19ad6350","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:36:33.396Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"7b0ba08f-7a56-4ced-9606-cf816b84275f","spanId":"0b678eb0","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.395Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 341[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 71[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 15[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 17[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 7[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"81a9559a-b43e-4f0b-9bb8-18642c27cd25","spanId":"0138d107","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.398Z"}
[32m2026-01-17T15:36:33.399Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.399Z"}[0m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 314[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 51[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 31[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 17[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(19) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 9[2mms[22m[39m
stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
2026-01-17T15:36:33.399Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"81a9559a-b43e-4f0b-9bb8-18642c27cd25","spanId":"0138d107","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.401Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"8144be71-2337-4dbb-9984-4821c57ca651","spanId":"72aaa5a2","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.400Z"}
[32m2026-01-17T15:36:33.401Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.401Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:36:33.401Z [WARN] Unknown API route accessed {"path":"/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"8144be71-2337-4dbb-9984-4821c57ca651","spanId":"72aaa5a2","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.403Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"32fae661-9df1-4539-a6be-f047deb650fd","spanId":"a9e1d834","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.405Z"}
[32m2026-01-17T15:36:33.406Z [INFO] POST /api/documents/test-id/versions/version-id/restore {"method":"POST","url":"/api/documents/test-id/versions/version-id/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.406Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
2026-01-17T15:36:33.406Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/version-id/restore","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"32fae661-9df1-4539-a6be-f047deb650fd","spanId":"a9e1d834","method":"POST","path":"/documents/test-id/versions/version-id/restore","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:36:33.407Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"bd8d94c6-1ceb-42b9-ac3c-b5c2825da77c","spanId":"a20881fb","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.407Z"}
[32m2026-01-17T15:36:33.408Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.408Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:36:33.408Z [WARN] Unknown API route accessed {"path":"/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"bd8d94c6-1ceb-42b9-ac3c-b5c2825da77c","spanId":"a20881fb","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.410Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"a66ea11d-ffb8-4475-bc80-bc1a99a8743d","spanId":"01d0260f","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.413Z"}
[32m2026-01-17T15:36:33.414Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.414Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:36:33.414Z [WARN] Unknown API route accessed {"path":"/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"a66ea11d-ffb8-4475-bc80-bc1a99a8743d","spanId":"01d0260f","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.415Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"5177b1c7-3a2e-4be5-89ad-24debc8d7506","spanId":"b90404ef","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.416Z"}
[32m2026-01-17T15:36:33.416Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.416Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Comparison > should require authentication for version comparison
2026-01-17T15:36:33.417Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/1/compare/2","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"5177b1c7-3a2e-4be5-89ad-24debc8d7506","spanId":"b90404ef","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.418Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"80d13b3d-185b-45c1-88dd-fe3ab2379805","spanId":"77bfc142","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.422Z"}
[32m2026-01-17T15:36:33.422Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.422Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:36:33.422Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"80d13b3d-185b-45c1-88dd-fe3ab2379805","spanId":"77bfc142","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.424Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"b88810ef-c6f0-4fb3-a814-96caf2067587","spanId":"c0d086a5","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.424Z"}
[32m2026-01-17T15:36:33.424Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.424Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should save a document with valid data
2026-01-17T15:36:33.425Z [WARN] Unknown API route accessed {"path":"/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"b88810ef-c6f0-4fb3-a814-96caf2067587","spanId":"c0d086a5","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.426Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"9648fbec-def1-446d-a357-50141819ce94","spanId":"90bf1e5c","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.428Z"}
[32m2026-01-17T15:36:33.428Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.428Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"55b5fcd7-6803-403a-85b2-23448efce06c","spanId":"bb68ca3e","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.430Z"}
[32m2026-01-17T15:36:33.431Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.431Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis by framework
2026-01-17T15:36:33.428Z [WARN] Unknown API route accessed {"path":"/gap-analysis/ISO27001","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should reject save request without required fields
2026-01-17T15:36:33.431Z [WARN] Unknown API route accessed {"path":"/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"9648fbec-def1-446d-a357-50141819ce94","spanId":"90bf1e5c","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.430Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"55b5fcd7-6803-403a-85b2-23448efce06c","spanId":"bb68ca3e","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.433Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"491f0277-c057-45cc-a46b-9867010a543f","spanId":"4fd38d32","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.436Z"}
[32m2026-01-17T15:36:33.436Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.436Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Document to Audit Trail > should require authentication to track document changes
2026-01-17T15:36:33.437Z [WARN] Unknown API route accessed {"path":"/documents/1/history","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"491f0277-c057-45cc-a46b-9867010a543f","spanId":"4fd38d32","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:33.439Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 385[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[39m[32m 73[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[32m 49[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[32m 21[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 200, 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 7[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"1c7df6dc-8020-48a8-a2db-46cca3d75abb","spanId":"2b0bfeda","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.444Z"}
[32m2026-01-17T15:36:33.444Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.444Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:36:33.445Z [WARN] Unknown API route accessed {"path":"/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"1c7df6dc-8020-48a8-a2db-46cca3d75abb","spanId":"2b0bfeda","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:33.446Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"6a4eda2a-4176-4b85-a707-10553d6e3b37","spanId":"c10b009e","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:33.450Z"}
[32m2026-01-17T15:36:33.451Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:33.451Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:36:33.452Z [WARN] Unknown API route accessed {"path":"/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"6a4eda2a-4176-4b85-a707-10553d6e3b37","spanId":"c10b009e","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:33.454Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 381[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 72[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 13[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 21[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 7[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 8 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
AssertionError: expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"
 Î“Â¥Â» tests/integration/documents.test.ts:28:29
     26|         .expect(200);
     27| 
     28|       expect(response.body).toHaveProperty('templates');
       |                             ^
     29|       expect(Array.isArray(response.body.templates)).toBe(true);
     30|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/8]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
AssertionError: expected [ 200, 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/documents.test.ts:120:31
    118|         });
    119| 
    120|       expect([200, 500, 503]).toContain(response.status);
       |                               ^
    121|     });
    122|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/8]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/8]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
AssertionError: expected [ 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:57:28
     55|         expect(response.body).toHaveProperty('recommendations');
     56|       } else {
     57|         expect([500, 503]).toContain(response.status);
       |                            ^
     58|       }
     59|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/8]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/8]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/8]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/8]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(19) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/8]Î“Ã„Â»


[2m Test Files [22m [1m[31m4 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m8 failed[39m[22m[2m | [22m[1m[32m60 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:36:30
[2m   Duration [22m 15.69s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[33m11 skipped[39m[2m)[22m[32m 62[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m | [22m[33m6 skipped[39m[2m)[22m[32m 53[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return system health status
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return AI health status
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for user profile
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for company profiles
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for documents
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mData Validation[2m > [22mshould validate company profile creation payload
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[33m22 skipped[39m[2m)[22m[32m 55[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[33m15 skipped[39m[2m)[22m[32m 67[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[33m14 skipped[39m[2m)[22m[32m 64[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Suites 5 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests
ReferenceError: generalLimiter is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:98:11
     96|   
     97|   // 5. Rate limiting and access control base
     98|   app.use(generalLimiter);
       |           ^
     99| 
    100|   // 6. Egress control and route validation
 Î“Â¥Â» tests/integration/documents.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/5]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests
ReferenceError: generalLimiter is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:98:11
     96|   
     97|   // 5. Rate limiting and access control base
     98|   app.use(generalLimiter);
       |           ^
     99| 
    100|   // 6. Egress control and route validation
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/5]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests
ReferenceError: generalLimiter is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:98:11
     96|   
     97|   // 5. Rate limiting and access control base
     98|   app.use(generalLimiter);
       |           ^
     99| 
    100|   // 6. Egress control and route validation
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/5]Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests
ReferenceError: generalLimiter is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:98:11
     96|   
     97|   // 5. Rate limiting and access control base
     98|   app.use(generalLimiter);
       |           ^
     99| 
    100|   // 6. Egress control and route validation
 Î“Â¥Â» tests/integration/api.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests
ReferenceError: generalLimiter is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:98:11
     96|   
     97|   // 5. Rate limiting and access control base
     98|   app.use(generalLimiter);
       |           ^
     99| 
    100|   // 6. Egress control and route validation
 Î“Â¥Â» tests/integration/auth.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/5]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [33m68 skipped[39m[90m (68)[39m
[2m   Start at [22m 07:36:39
[2m   Duration [22m 16.49s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/integration/api.test.ts [22m[34mx8 [34m[39m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[33m22 skipped[39m[2m)[22m[32m 55[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[33m15 skipped[39m[2m)[22m[32m 67[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[33m14 skipped[39m[2m)[22m[32m 64[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[33m11 skipped[39m[2m)[22m[32m 62[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m | [22m[33m6 skipped[39m[2m)[22m[32m 35[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return system health status
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return AI health status
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for user profile
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for company profiles
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for documents
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mData Validation[2m > [22mshould validate company profile creation payload

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Suites 1 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests
ReferenceError: generalLimiter is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:98:11
     96|   
     97|   // 5. Rate limiting and access control base
     98|   app.use(generalLimiter);
       |           ^
     99| 
    100|   // 6. Egress control and route validation
 Î“Â¥Â» tests/integration/api.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/1]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [33m68 skipped[39m[90m (68)[39m
[2m   Start at [22m 07:36:47
[2m   Duration [22m 1.54s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:36:59.163Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:36:59.241Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:36:59.242Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:36:59.246Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:36:59.278Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:36:59.369Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"3252117b-9589-4dc9-85d0-a88009461cbf","spanId":"5cfca755","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.385Z"}
[32m2026-01-17T15:36:59.390Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.390Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:36:59.404Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.404Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"8d53b7d2-a350-4e1f-8d07-25ca649255a7","spanId":"56fa9f0b","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.401Z"}
[32m2026-01-17T15:36:59.405Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.405Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"779040c0-fb12-4276-93d8-102341b6b24d","spanId":"47c46f44","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.404Z"}
[32m2026-01-17T15:36:59.419Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.419Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to AI health endpoint
2026-01-17T15:36:59.421Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:36:59.427Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:36:59.401Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"3252117b-9589-4dc9-85d0-a88009461cbf","spanId":"5cfca755","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":45,"timestamp":"2026-01-17T15:36:59.430Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"5a50702b-edbb-48ac-9393-a6e736619d3a","spanId":"1f75703f","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.430Z"}
[32m2026-01-17T15:36:59.431Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.431Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication for organization creation
2026-01-17T15:36:59.432Z [WARN] Unknown API route accessed {"path":"/organizations","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:36:59.432Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"5a50702b-edbb-48ac-9393-a6e736619d3a","spanId":"1f75703f","method":"GET","path":"/api/auth/user","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:36:59.440Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"8d53b7d2-a350-4e1f-8d07-25ca649255a7","spanId":"56fa9f0b","method":"GET","path":"/","statusCode":200,"duration":39,"timestamp":"2026-01-17T15:36:59.440Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"779040c0-fb12-4276-93d8-102341b6b24d","spanId":"47c46f44","method":"POST","path":"/api/organizations","statusCode":401,"duration":44,"timestamp":"2026-01-17T15:36:59.447Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"a2031312-c176-436d-9826-9e928292b599","spanId":"8d681c69","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.448Z"}
[32m2026-01-17T15:36:59.449Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.449Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"4a98b09a-fd6c-48f3-b7af-b753d04ae011","spanId":"77450702","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.448Z"}
[32m2026-01-17T15:36:59.449Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.449Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for /api/company-profiles
2026-01-17T15:36:59.449Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication to update recommendations
2026-01-17T15:36:59.451Z [WARN] Unknown API route accessed {"path":"/gap-analysis/recommendations/test-id","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"a2031312-c176-436d-9826-9e928292b599","spanId":"8d681c69","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:59.452Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"4a98b09a-fd6c-48f3-b7af-b753d04ae011","spanId":"77450702","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:36:59.454Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"750af713-a8ba-492d-9afd-5e9259bf379f","spanId":"51d72c59","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.460Z"}
[32m2026-01-17T15:36:59.461Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.461Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"c28c3c83-d9fa-4b9b-adac-1244363be29e","spanId":"1757ad89","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.460Z"}
[32m2026-01-17T15:36:59.461Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.461Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:36:59.462Z [WARN] Unknown API route accessed {"path":"/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"c28c3c83-d9fa-4b9b-adac-1244363be29e","spanId":"1757ad89","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:59.464Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Organization Setup > should require authentication to list organizations
2026-01-17T15:36:59.463Z [WARN] Unknown API route accessed {"path":"/organizations","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:36:59.467Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"750af713-a8ba-492d-9afd-5e9259bf379f","spanId":"51d72c59","method":"GET","path":"/api/organizations","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:36:59.469Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"544c5044-fe25-4e80-a1b2-ad779da85af3","spanId":"0868a08b","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.472Z"}
[32m2026-01-17T15:36:59.473Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.473Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for document generation
2026-01-17T15:36:59.474Z [WARN] Unknown API route accessed {"path":"/documents/generate","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"544c5044-fe25-4e80-a1b2-ad779da85af3","spanId":"0868a08b","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:36:59.480Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"de125eb7-1f7c-48c9-a822-fbc735cbde14","spanId":"6173e56c","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.480Z"}
[32m2026-01-17T15:36:59.481Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.481Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:36:59.482Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"ada6dbc9-68d2-4798-865a-8ce4f9534b71","spanId":"62743f68","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.484Z"}
[32m2026-01-17T15:36:59.485Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.485Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication for company profile creation
2026-01-17T15:36:59.486Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"e2925058-a0a2-4a7b-806f-a8e5dc7f1303","spanId":"dd32aa53","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.486Z"}
[32m2026-01-17T15:36:59.487Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.487Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"ada6dbc9-68d2-4798-865a-8ce4f9534b71","spanId":"62743f68","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:59.488Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:36:59.489Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"e2925058-a0a2-4a7b-806f-a8e5dc7f1303","spanId":"dd32aa53","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:59.490Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"de125eb7-1f7c-48c9-a822-fbc735cbde14","spanId":"6173e56c","method":"GET","path":"/","statusCode":200,"duration":12,"timestamp":"2026-01-17T15:36:59.492Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"3223b0ec-6033-428b-b91e-ee5fb30b0de3","spanId":"415afa2b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.492Z"}
[32m2026-01-17T15:36:59.492Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.492Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:36:59.492Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.492Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:36:59.493Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"3223b0ec-6033-428b-b91e-ee5fb30b0de3","spanId":"415afa2b","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.494Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"90f5194c-0946-4fb8-821f-98934261d288","spanId":"b348becf","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.494Z"}
[32m2026-01-17T15:36:59.495Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.495Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"e9c04f52-bb6b-4e3c-ba77-f3ecd9755f8a","spanId":"8ad2b2f7","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.496Z"}
[32m2026-01-17T15:36:59.497Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.497Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Company Profile Creation > should require authentication to get company profile
2026-01-17T15:36:59.496Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"90f5194c-0946-4fb8-821f-98934261d288","spanId":"b348becf","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:59.498Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:36:59.497Z [WARN] Unknown API route accessed {"path":"/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return AI health status
2026-01-17T15:36:59.497Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"e9c04f52-bb6b-4e3c-ba77-f3ecd9755f8a","spanId":"8ad2b2f7","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.499Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"95199f6c-760e-40e0-b24b-7e28869de87d","spanId":"0634afe1","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.506Z"}
[32m2026-01-17T15:36:59.506Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.506Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
2026-01-17T15:36:59.507Z [WARN] Unknown API route accessed {"path":"/auth/mfa/setup","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"95199f6c-760e-40e0-b24b-7e28869de87d","spanId":"0634afe1","method":"POST","path":"/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:36:59.508Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"b9c9b445-e17d-40d4-8c46-d9701f1a1d89","spanId":"a42f97b3","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.509Z"}
[32m2026-01-17T15:36:59.510Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.510Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"3f9f088e-7ce9-46f2-bfab-ad1fe1e29b9b","spanId":"789859b8","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.506Z"}
[32m2026-01-17T15:36:59.512Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.512Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:36:59.513Z [WARN] Unknown API route accessed {"path":"/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"3f9f088e-7ce9-46f2-bfab-ad1fe1e29b9b","spanId":"789859b8","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:36:59.515Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"603ce338-eb82-455d-abc4-f6672d5b3b00","spanId":"6b131dfe","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.516Z"}
[32m2026-01-17T15:36:59.517Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.517Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:36:59.518Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"603ce338-eb82-455d-abc4-f6672d5b3b00","spanId":"6b131dfe","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:59.520Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:36:59.512Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"1a97a3a3-24c5-49bf-a2ae-1000c857af46","spanId":"b23ad2b3","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.524Z"}
[32m2026-01-17T15:36:59.525Z [INFO] POST /api/ai/generate {"method":"POST","url":"/api/ai/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.525Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
2026-01-17T15:36:59.525Z [WARN] Unknown API route accessed {"path":"/ai/generate","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"1a97a3a3-24c5-49bf-a2ae-1000c857af46","spanId":"b23ad2b3","method":"POST","path":"/api/ai/generate","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:36:59.527Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"b9c9b445-e17d-40d4-8c46-d9701f1a1d89","spanId":"a42f97b3","method":"GET","path":"/api/auth/user","statusCode":401,"duration":20,"timestamp":"2026-01-17T15:36:59.528Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"0b4fb288-1b20-45a5-9eab-f9ebe0c5d757","spanId":"8070a290","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.528Z"}
[32m2026-01-17T15:36:59.529Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.529Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"6b7d305a-9ec8-437c-b007-631f4b6632c7","spanId":"5165d44f","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.534Z"}
[32m2026-01-17T15:36:59.534Z [INFO] POST /api/ai/analyze {"method":"POST","url":"/api/ai/analyze","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.534Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
2026-01-17T15:36:59.535Z [WARN] Unknown API route accessed {"path":"/ai/analyze","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"6b7d305a-9ec8-437c-b007-631f4b6632c7","spanId":"5165d44f","method":"POST","path":"/api/ai/analyze","statusCode":404,"duration":4,"timestamp":"2026-01-17T15:36:59.538Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"ac9b6fd7-71ec-4e69-bcd3-957bdb060ea2","spanId":"d814a18f","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.537Z"}
[32m2026-01-17T15:36:59.538Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.538Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
2026-01-17T15:36:59.530Z [WARN] Unknown API route accessed {"path":"/documents/generate","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for company profiles
2026-01-17T15:36:59.539Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"0b4fb288-1b20-45a5-9eab-f9ebe0c5d757","spanId":"8070a290","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":15,"timestamp":"2026-01-17T15:36:59.543Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"ac9b6fd7-71ec-4e69-bcd3-957bdb060ea2","spanId":"d814a18f","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:36:59.543Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"a121b228-9468-4d3b-9abc-7d9146a54824","spanId":"e0bf8e4b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.542Z"}
[32m2026-01-17T15:36:59.544Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.544Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:36:59.544Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.544Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should return AI service health status
2026-01-17T15:36:59.545Z [WARN] Unknown API route accessed {"path":"/ai/health","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:36:59.544Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"a121b228-9468-4d3b-9abc-7d9146a54824","spanId":"e0bf8e4b","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.545Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"aff0fb68-b7d5-4e3c-afe3-c02640c115fa","spanId":"527cd744","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.549Z"}
[32m2026-01-17T15:36:59.550Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.550Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"336a1271-ef43-43b4-8a73-ae44ecb88ef7","spanId":"53dd6129","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.550Z"}
[32m2026-01-17T15:36:59.554Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.554Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
2026-01-17T15:36:59.554Z [WARN] Unknown API route accessed {"path":"/documents/upload-and-extract","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/api.test.ts > API Integration Tests > Authentication Required Endpoints > should require authentication for documents
2026-01-17T15:36:59.555Z [WARN] Unknown API route accessed {"path":"/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"aff0fb68-b7d5-4e3c-afe3-c02640c115fa","spanId":"527cd744","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:36:59.556Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"de79e179-7199-45a0-962e-8aa379c04a6a","spanId":"ff0a9225","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.556Z"}
[32m2026-01-17T15:36:59.556Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.556Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:36:59.557Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"de79e179-7199-45a0-962e-8aa379c04a6a","spanId":"ff0a9225","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.558Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"336a1271-ef43-43b4-8a73-ae44ecb88ef7","spanId":"53dd6129","method":"GET","path":"/api/documents","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:36:59.559Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"aa0ab8ba-cbf4-4d6b-a968-631f2a532251","spanId":"4ee07673","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.560Z"}
[32m2026-01-17T15:36:59.560Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.560Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:36:59.561Z [WARN] Unknown API route accessed {"path":"/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"aa0ab8ba-cbf4-4d6b-a968-631f2a532251","spanId":"4ee07673","method":"POST","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.563Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"9eb45008-3f81-46cd-9077-e5929b97049b","spanId":"a0413552","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.563Z"}
[32m2026-01-17T15:36:59.563Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.563Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"c2104fb8-b6bb-441e-8e30-2657d59985d4","spanId":"fb65bb0b","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.560Z"}
[32m2026-01-17T15:36:59.563Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.563Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"4a38a07c-0b63-48b5-bcce-68bfc6577d8d","spanId":"137d8d46","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.563Z"}
[32m2026-01-17T15:36:59.564Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.564Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Document Quality for Compliance > should analyze document quality against framework
2026-01-17T15:36:59.563Z [WARN] Unknown API route accessed {"path":"/analyze-document-quality","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"9eb45008-3f81-46cd-9077-e5929b97049b","spanId":"a0413552","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.565Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:36:59.564Z [INFO] API route accessed {"path":"/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"c2104fb8-b6bb-441e-8e30-2657d59985d4","spanId":"fb65bb0b","method":"GET","path":"/api/auth/user","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:36:59.567Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
2026-01-17T15:36:59.565Z [WARN] Unknown API route accessed {"path":"/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"4a38a07c-0b63-48b5-bcce-68bfc6577d8d","spanId":"137d8d46","method":"POST","path":"/export-document","statusCode":200,"duration":5,"timestamp":"2026-01-17T15:36:59.568Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"53f22ded-6662-47f1-af58-9eba36c34aab","spanId":"bd03c3fa","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.569Z"}
[32m2026-01-17T15:36:59.570Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.570Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:36:59.570Z [WARN] Unknown API route accessed {"path":"/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"53f22ded-6662-47f1-af58-9eba36c34aab","spanId":"bd03c3fa","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.572Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"5446d01f-c941-4117-bbdd-2556abbee7ce","spanId":"ba310df4","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.573Z"}
[32m2026-01-17T15:36:59.573Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.573Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"4e36bb91-c82d-448a-9644-834861d9646e","spanId":"ebe043df","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.578Z"}
[32m2026-01-17T15:36:59.578Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.578Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:36:59.579Z [WARN] Unknown API route accessed {"path":"/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for report access
2026-01-17T15:36:59.576Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"4e36bb91-c82d-448a-9644-834861d9646e","spanId":"ebe043df","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:36:59.585Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"8f379cf2-5500-4781-a727-30a7fb8fbaed","spanId":"83aee3d3","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.585Z"}
[32m2026-01-17T15:36:59.585Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.585Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:36:59.588Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
2026-01-17T15:36:59.586Z [WARN] Unknown API route accessed {"path":"/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"8f379cf2-5500-4781-a727-30a7fb8fbaed","spanId":"83aee3d3","method":"POST","path":"/export-document","statusCode":400,"duration":5,"timestamp":"2026-01-17T15:36:59.590Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"df898f46-f8e5-426d-99b6-243135609dce","spanId":"7edf63cc","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.591Z"}
[32m2026-01-17T15:36:59.592Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.592Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:36:59.593Z [WARN] Unknown API route accessed {"path":"/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"df898f46-f8e5-426d-99b6-243135609dce","spanId":"7edf63cc","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:59.595Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"5446d01f-c941-4117-bbdd-2556abbee7ce","spanId":"ba310df4","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":22,"timestamp":"2026-01-17T15:36:59.595Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"425b85c3-5f0d-483b-b6d0-a0dac8a9bfd7","spanId":"7072edd0","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.596Z"}
[32m2026-01-17T15:36:59.597Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.597Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document AI Generation > should reject generation request without framework
2026-01-17T15:36:59.597Z [WARN] Unknown API route accessed {"path":"/generate-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"425b85c3-5f0d-483b-b6d0-a0dac8a9bfd7","spanId":"7072edd0","method":"POST","path":"/api/generate-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.598Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:36:59.601Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"9d413055-561a-4260-a8af-ef2c039fa54c","spanId":"01e43615","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.602Z"}
[32m2026-01-17T15:36:59.603Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.603Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_start","traceId":"96612b32-d862-4e4b-847d-013a1442df2f","spanId":"00e5cdb0","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.603Z"}
[32m2026-01-17T15:36:59.603Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.603Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"7ff7b41c-321d-418e-9b3b-ba2b19215185","spanId":"30e5ee09","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.604Z"}
[32m2026-01-17T15:36:59.604Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.604Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Reports > should require authentication for specific report
2026-01-17T15:36:59.604Z [WARN] Unknown API route accessed {"path":"/gap-analysis/reports/test-report-id","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
2026-01-17T15:36:59.604Z [WARN] Unknown API route accessed {"path":"/analyze-document-quality","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:36:59.605Z [WARN] Unknown API route accessed {"path":"/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"9d413055-561a-4260-a8af-ef2c039fa54c","spanId":"01e43615","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.605Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_end","traceId":"96612b32-d862-4e4b-847d-013a1442df2f","spanId":"00e5cdb0","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.605Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"7ff7b41c-321d-418e-9b3b-ba2b19215185","spanId":"30e5ee09","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.606Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 491[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 131[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 37[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 28[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 36[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 30[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 26[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"f060b42a-4694-4521-baf2-b5c76f886393","spanId":"6940bbf2","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.615Z"}
[32m2026-01-17T15:36:59.615Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.615Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"70efc630-2360-4b64-8673-d363dd96f602","spanId":"601d6efb","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.615Z"}
[32m2026-01-17T15:36:59.615Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.615Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to get audit entry details
2026-01-17T15:36:59.616Z [WARN] Unknown API route accessed {"path":"/audit-trail/1","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Remediation Tracking > should require authentication for remediation updates
2026-01-17T15:36:59.616Z [WARN] Unknown API route accessed {"path":"/gap-analysis/recommendations/test-rec-id","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"70efc630-2360-4b64-8673-d363dd96f602","spanId":"601d6efb","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.617Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"f060b42a-4694-4521-baf2-b5c76f886393","spanId":"6940bbf2","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.617Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"845db0ac-018c-45b8-a506-274bc1d53fac","spanId":"d266de79","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.616Z"}
[32m2026-01-17T15:36:59.618Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.618Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Data Validation > should validate company profile creation payload
2026-01-17T15:36:59.620Z [WARN] Unknown API route accessed {"path":"/company-profiles","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"845db0ac-018c-45b8-a506-274bc1d53fac","spanId":"d266de79","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:36:59.621Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"45b0b46c-5e24-4a13-8cea-459e76c6cd66","spanId":"96aea7d9","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.623Z"}
[32m2026-01-17T15:36:59.623Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.623Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"59e148ea-3a49-4a65-bcb4-6067c3c025ee","spanId":"55ab153d","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.623Z"}
[32m2026-01-17T15:36:59.624Z [INFO] POST /api/assess-risk {"method":"POST","url":"/api/assess-risk","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.624Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:36:59.624Z [WARN] Unknown API route accessed {"path":"/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:36:59.624Z [WARN] Unknown API route accessed {"path":"/assess-risk","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"45b0b46c-5e24-4a13-8cea-459e76c6cd66","spanId":"96aea7d9","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.625Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"59e148ea-3a49-4a65-bcb4-6067c3c025ee","spanId":"55ab153d","method":"POST","path":"/api/assess-risk","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:36:59.625Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 458[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"ca19c6bf-88f8-43ee-8d5c-756a3a9769dc","spanId":"c5912d42","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.626Z"}
[32m2026-01-17T15:36:59.626Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.626Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version history
2026-01-17T15:36:59.628Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"120345b3-b20e-4661-9bc3-0db75a997df5","spanId":"9b29fb05","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.629Z"}
[32m2026-01-17T15:36:59.630Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.630Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"fa8ea655-e06e-4071-b773-048683a22c84","spanId":"adfbf5e0","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.630Z"}
[32m2026-01-17T15:36:59.630Z [INFO] POST /api/calculate-compliance-score {"method":"POST","url":"/api/calculate-compliance-score","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.630Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:36:59.630Z [WARN] Unknown API route accessed {"path":"/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"ca19c6bf-88f8-43ee-8d5c-756a3a9769dc","spanId":"c5912d42","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:36:59.631Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:36:59.631Z [WARN] Unknown API route accessed {"path":"/calculate-compliance-score","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"120345b3-b20e-4661-9bc3-0db75a997df5","spanId":"9b29fb05","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.632Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"fa8ea655-e06e-4071-b773-048683a22c84","spanId":"adfbf5e0","method":"POST","path":"/api/calculate-compliance-score","statusCode":404,"duration":1,"timestamp":"2026-01-17T15:36:59.631Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"e4820912-1679-4e98-8739-96405f17e4f6","spanId":"a75d4863","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.636Z"}
[32m2026-01-17T15:36:59.636Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.636Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
2026-01-17T15:36:59.637Z [WARN] Unknown API route accessed {"path":"/ai/analyze-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"e4820912-1679-4e98-8739-96405f17e4f6","spanId":"a75d4863","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:36:59.638Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"153e31f2-a2f4-493f-864b-a62f25e4df57","spanId":"c738e99d","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.639Z"}
[32m2026-01-17T15:36:59.640Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.640Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:36:59.641Z [WARN] Unknown API route accessed {"path":"/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"4bd64852-8203-40ee-bd48-7d610844ae31","spanId":"41664173","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.641Z"}
[32m2026-01-17T15:36:59.642Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.642Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"153e31f2-a2f4-493f-864b-a62f25e4df57","spanId":"c738e99d","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.642Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
2026-01-17T15:36:59.642Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"4bd64852-8203-40ee-bd48-7d610844ae31","spanId":"41664173","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:59.645Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"beec89d5-5b06-4d25-8572-910b50ba2c95","spanId":"77c63acd","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.645Z"}
[32m2026-01-17T15:36:59.646Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.646Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"b4f97ac7-a588-4331-bc59-3eec8e88e47c","spanId":"864e4e62","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.648Z"}
[32m2026-01-17T15:36:59.648Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.648Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"fbbfd315-e65b-423f-8256-3b945840d4c7","spanId":"d2d7a233","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.649Z"}
[32m2026-01-17T15:36:59.650Z [INFO] POST /api/documents/test-id/versions/version-id/restore {"method":"POST","url":"/api/documents/test-id/versions/version-id/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.650Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
2026-01-17T15:36:59.646Z [WARN] Unknown API route accessed {"path":"/frameworks/SOC2/controls","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:36:59.649Z [WARN] Unknown API route accessed {"path":"/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
2026-01-17T15:36:59.650Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/version-id/restore","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"beec89d5-5b06-4d25-8572-910b50ba2c95","spanId":"77c63acd","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:36:59.648Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"b4f97ac7-a588-4331-bc59-3eec8e88e47c","spanId":"864e4e62","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.650Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"fbbfd315-e65b-423f-8256-3b945840d4c7","spanId":"d2d7a233","method":"POST","path":"/documents/test-id/versions/version-id/restore","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:36:59.651Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"a973f09a-9d6c-4055-a15b-4e4e488bddcf","spanId":"f7fa7151","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.656Z"}
[32m2026-01-17T15:36:59.656Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.656Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis by framework
2026-01-17T15:36:59.656Z [WARN] Unknown API route accessed {"path":"/gap-analysis/ISO27001","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 474[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 99[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 18[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 32[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 25[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 32[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 9[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"a973f09a-9d6c-4055-a15b-4e4e488bddcf","spanId":"f7fa7151","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.658Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"52d3172a-66cc-4ee0-848d-72f812fda0d4","spanId":"4f72b4c1","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.660Z"}
[32m2026-01-17T15:36:59.661Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.661Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Comparison > should require authentication for version comparison
2026-01-17T15:36:59.661Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/1/compare/2","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"52d3172a-66cc-4ee0-848d-72f812fda0d4","spanId":"4f72b4c1","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.663Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"0a798c36-6b11-46af-ae38-fbb66a017938","spanId":"ad1acca0","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.664Z"}
[32m2026-01-17T15:36:59.665Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.665Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Document to Audit Trail > should require authentication to track document changes
2026-01-17T15:36:59.665Z [WARN] Unknown API route accessed {"path":"/documents/1/history","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"0a798c36-6b11-46af-ae38-fbb66a017938","spanId":"ad1acca0","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:36:59.668Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"7d1cd5e1-3c14-4ac5-b57c-50123c418ff6","spanId":"bbf6f6b4","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.668Z"}
[32m2026-01-17T15:36:59.668Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.668Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should save a document with valid data
2026-01-17T15:36:59.669Z [WARN] Unknown API route accessed {"path":"/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"7d1cd5e1-3c14-4ac5-b57c-50123c418ff6","spanId":"bbf6f6b4","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.670Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"7cb9a831-af05-4616-b468-fe9bc12ed079","spanId":"8197ee97","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.672Z"}
[32m2026-01-17T15:36:59.672Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.672Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:36:59.673Z [WARN] Unknown API route accessed {"path":"/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"7cb9a831-af05-4616-b468-fe9bc12ed079","spanId":"8197ee97","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:36:59.680Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"83165fb9-ae48-4bd0-a7bd-30d66eb58ddf","spanId":"1a7a5094","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.681Z"}
[32m2026-01-17T15:36:59.681Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.681Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"b44cb55d-d4c7-4f20-abb5-d2a9f692d912","spanId":"27348240","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:36:59.684Z"}
[32m2026-01-17T15:36:59.685Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:36:59.685Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should reject save request without required fields
2026-01-17T15:36:59.682Z [WARN] Unknown API route accessed {"path":"/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:36:59.685Z [WARN] Unknown API route accessed {"path":"/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"83165fb9-ae48-4bd0-a7bd-30d66eb58ddf","spanId":"1a7a5094","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:36:59.684Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"b44cb55d-d4c7-4f20-abb5-d2a9f692d912","spanId":"27348240","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:36:59.686Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 477[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[39m[32m 87[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[32m 37[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[32m 36[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[32m 21[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[39m[32m 19[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 200, 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[32m 13[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 13[2mms[22m[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 520[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 119[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 18[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 9[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 9 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
AssertionError: expected { success: true, data: { Î“Ã‡Âª(5) } } to have property "templates"
 Î“Â¥Â» tests/integration/documents.test.ts:28:29
     26|         .expect(200);
     27| 
     28|       expect(response.body).toHaveProperty('templates');
       |                             ^
     29|       expect(Array.isArray(response.body.templates)).toBe(true);
     30|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/9]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
AssertionError: expected [ 200, 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/documents.test.ts:120:31
    118|         });
    119| 
    120|       expect([200, 500, 503]).toContain(response.status);
       |                               ^
    121|     });
    122|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/9]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/9]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
AssertionError: expected [ 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:57:28
     55|         expect(response.body).toHaveProperty('recommendations');
     56|       } else {
     57|         expect([500, 503]).toContain(response.status);
       |                            ^
     58|       }
     59|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/9]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/9]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/9]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/9]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/9]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[9/9]Î“Ã„Â»


[2m Test Files [22m [1m[31m4 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m9 failed[39m[22m[2m | [22m[1m[32m59 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:36:55
[2m   Duration [22m 17.99s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/integration/documents.test.ts [22m[34mx9 [34m[39m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 520[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 119[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 18[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 9[2mms[22m[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 474[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 99[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 18[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 32[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 25[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 32[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 9[2mms[22m[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 491[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 131[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 37[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 28[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 36[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 30[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 26[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:37:15.695Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"029025c2-de79-4990-82c5-28a9859e5e4a","spanId":"206a1bc2","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.757Z"}
[32m2026-01-17T15:37:15.759Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.759Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:37:15.765Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"029025c2-de79-4990-82c5-28a9859e5e4a","spanId":"206a1bc2","method":"GET","path":"/","statusCode":200,"duration":16,"timestamp":"2026-01-17T15:37:15.773Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"b0e0bad8-d363-48ea-ae97-0a4eaede501e","spanId":"ada91dc5","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.787Z"}
[32m2026-01-17T15:37:15.788Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.788Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:37:15.789Z [WARN] Unknown API route accessed {"path":"/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"b0e0bad8-d363-48ea-ae97-0a4eaede501e","spanId":"ada91dc5","method":"GET","path":"/","statusCode":200,"duration":7,"timestamp":"2026-01-17T15:37:15.794Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"47b48916-1476-4502-94cc-684ede21312f","spanId":"2b59204c","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.802Z"}
[32m2026-01-17T15:37:15.803Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.803Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:37:15.803Z [WARN] Unknown API route accessed {"path":"/document-templates/iso-001","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"47b48916-1476-4502-94cc-684ede21312f","spanId":"2b59204c","method":"GET","path":"/iso-001","statusCode":200,"duration":4,"timestamp":"2026-01-17T15:37:15.806Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"ee50b831-652c-4136-9e2f-1ca2c9aeee8a","spanId":"bf36ddce","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.823Z"}
[32m2026-01-17T15:37:15.824Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.824Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document generation
2026-01-17T15:37:15.824Z [WARN] Unknown API route accessed {"path":"/documents/generate","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"ee50b831-652c-4136-9e2f-1ca2c9aeee8a","spanId":"bf36ddce","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:37:15.829Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"8f4607b8-3920-4e33-8981-8afc02f91ce2","spanId":"8504397e","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.834Z"}
[32m2026-01-17T15:37:15.835Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.835Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Generation Endpoints > should require authentication for document upload
2026-01-17T15:37:15.835Z [WARN] Unknown API route accessed {"path":"/documents/upload-and-extract","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"8f4607b8-3920-4e33-8981-8afc02f91ce2","spanId":"8504397e","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:37:15.838Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"7f011579-00ba-4c23-adda-1a8f6e05fc1d","spanId":"db3df2d1","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.843Z"}
[32m2026-01-17T15:37:15.844Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.844Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
2026-01-17T15:37:15.844Z [WARN] Unknown API route accessed {"path":"/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"7f011579-00ba-4c23-adda-1a8f6e05fc1d","spanId":"db3df2d1","method":"POST","path":"/export-document","statusCode":200,"duration":3,"timestamp":"2026-01-17T15:37:15.846Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"1d021dfa-05dd-4466-acc5-91762b9a2527","spanId":"ff22774b","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.849Z"}
[32m2026-01-17T15:37:15.849Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.849Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
2026-01-17T15:37:15.850Z [WARN] Unknown API route accessed {"path":"/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"1d021dfa-05dd-4466-acc5-91762b9a2527","spanId":"ff22774b","method":"POST","path":"/export-document","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:37:15.851Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"cb6b7344-a987-42de-8892-95cfefc2994d","spanId":"7f35faa7","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.856Z"}
[32m2026-01-17T15:37:15.856Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.856Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document AI Generation > should reject generation request without framework
2026-01-17T15:37:15.857Z [WARN] Unknown API route accessed {"path":"/generate-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"cb6b7344-a987-42de-8892-95cfefc2994d","spanId":"7f35faa7","method":"POST","path":"/api/generate-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:37:15.858Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_start","traceId":"e80bd792-2611-415a-9ff6-13e41cd7521d","spanId":"ee7b33d7","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.863Z"}
[32m2026-01-17T15:37:15.864Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.864Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
2026-01-17T15:37:15.864Z [WARN] Unknown API route accessed {"path":"/analyze-document-quality","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_end","traceId":"e80bd792-2611-415a-9ff6-13e41cd7521d","spanId":"ee7b33d7","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:37:15.866Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"a9a7a07b-326f-486c-8448-2ee1a5becbf0","spanId":"8bce7a61","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.876Z"}
[32m2026-01-17T15:37:15.876Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.876Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version history
2026-01-17T15:37:15.877Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"a9a7a07b-326f-486c-8448-2ee1a5becbf0","spanId":"8bce7a61","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:37:15.880Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"2fc47654-8aaa-4876-8a3d-3ddc5a7f2b34","spanId":"aa659472","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.886Z"}
[32m2026-01-17T15:37:15.886Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.886Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version creation
2026-01-17T15:37:15.886Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"2fc47654-8aaa-4876-8a3d-3ddc5a7f2b34","spanId":"aa659472","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:37:15.887Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"4c819db0-fd69-4fa1-8cf5-da54d04b6e30","spanId":"55733c31","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.893Z"}
[32m2026-01-17T15:37:15.893Z [INFO] POST /api/documents/test-id/versions/version-id/restore {"method":"POST","url":"/api/documents/test-id/versions/version-id/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.893Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
2026-01-17T15:37:15.893Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/version-id/restore","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"4c819db0-fd69-4fa1-8cf5-da54d04b6e30","spanId":"55733c31","method":"POST","path":"/documents/test-id/versions/version-id/restore","statusCode":400,"duration":1,"timestamp":"2026-01-17T15:37:15.894Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"0389c381-945d-4e74-9771-68ae5afeb327","spanId":"60f225a0","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.897Z"}
[32m2026-01-17T15:37:15.898Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.898Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Comparison > should require authentication for version comparison
2026-01-17T15:37:15.898Z [WARN] Unknown API route accessed {"path":"/documents/test-id/versions/1/compare/2","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"0389c381-945d-4e74-9771-68ae5afeb327","spanId":"60f225a0","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:37:15.899Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"377dad9d-b5b2-4f7e-b6a1-3ab66bbad6de","spanId":"01fca693","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.904Z"}
[32m2026-01-17T15:37:15.904Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.904Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should save a document with valid data
2026-01-17T15:37:15.905Z [WARN] Unknown API route accessed {"path":"/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"377dad9d-b5b2-4f7e-b6a1-3ab66bbad6de","spanId":"01fca693","method":"POST","path":"/api/save-document","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:37:15.905Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"d828d8ff-b4f3-4a5c-a9da-20b15a15297a","spanId":"c54d5290","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:37:15.908Z"}
[32m2026-01-17T15:37:15.909Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:37:15.909Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should reject save request without required fields
2026-01-17T15:37:15.909Z [WARN] Unknown API route accessed {"path":"/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"d828d8ff-b4f3-4a5c-a9da-20b15a15297a","spanId":"c54d5290","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:37:15.911Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 250[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[32m 38[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[32m 25[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[32m 21[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 200, 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 6[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 2 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
AssertionError: expected [ 200, 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/documents.test.ts:120:31
    118|         });
    119| 
    120|       expect([200, 500, 503]).toContain(response.status);
       |                               ^
    121|     });
    122|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/2]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/2]Î“Ã„Â»


[2m Test Files [22m [1m[31m4 failed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[31m8 failed[39m[22m[2m | [22m[1m[32m54 passed[39m[22m[90m (62)[39m
[2m   Start at [22m 07:37:14
[2m   Duration [22m 1.75s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m


Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Suites 5 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts [ tests/integration/documents.test.ts ]
 FAIL   unit  tests/integration/gap-analysis.test.ts [ tests/integration/gap-analysis.test.ts ]
 FAIL   unit  tests/integration/e2e-flows.test.ts [ tests/integration/e2e-flows.test.ts ]
 FAIL   unit  tests/integration/api.test.ts [ tests/integration/api.test.ts ]
 FAIL   unit  tests/integration/auth.test.ts [ tests/integration/auth.test.ts ]
Error: Transform failed with 1 error:
C:/software/cyberdocgen/server/routes.ts:530:34: ERROR: Expected ";" but found ":"
  Plugin: vite:esbuild
  File: C:/software/cyberdocgen/server/routes.ts:530:34
  
  Expected ";" but found ":"
  528|  
  529|    const aiRouter = Router();
  530|    { path: '/api/storage/*', method: 'ALL', requiresAuth: true, requiresMfa: false, rateLimitTier: 'medium' },
     |                                    ^
  531|    { path: '/api/storage/backups/*', method: 'ALL', requiresAuth: true, requiresMfa: true, rateLimitTier: 'high' },
  532|    { path: '/api/admin/*', method: 'ALL', requiresAuth: true, requiresMfa: true, rateLimitTier: 'critical' },
  
 Î“Â¥Â» failureErrorWithLog node_modules/esbuild/lib/main.js:1467:15
 Î“Â¥Â» node_modules/esbuild/lib/main.js:736:50
 Î“Â¥Â» responseCallbacks.<computed> node_modules/esbuild/lib/main.js:603:9
 Î“Â¥Â» handleIncomingPacket node_modules/esbuild/lib/main.js:658:12
 Î“Â¥Â» Socket.readFromStdout node_modules/esbuild/lib/main.js:581:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/5]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [2mno tests[22m
[2m   Start at [22m 07:41:12
[2m   Duration [22m 1.55s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:41:29.431Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:41:29.509Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:41:29.527Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:41:29.534Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:41:29.561Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"fdb8c470-a5cd-46b8-b2b2-fc2e1d447b42","spanId":"6a314a56","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.561Z"}
[32m2026-01-17T15:41:29.565Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.565Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:41:29.584Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"fdb8c470-a5cd-46b8-b2b2-fc2e1d447b42","spanId":"6a314a56","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":32,"timestamp":"2026-01-17T15:41:29.592Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"988fd366-004e-4b5a-b27f-ad3391e8766c","spanId":"85b0aab3","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.607Z"}
[32m2026-01-17T15:41:29.609Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.609Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:41:29.609Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"988fd366-004e-4b5a-b27f-ad3391e8766c","spanId":"85b0aab3","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:41:29.612Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"fc214114-d3e8-482a-8407-4fb3e309b41c","spanId":"8dfb34b6","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.623Z"}
[32m2026-01-17T15:41:29.624Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.624Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:41:29.625Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"fc214114-d3e8-482a-8407-4fb3e309b41c","spanId":"8dfb34b6","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:29.627Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"fd7322d0-7651-49d1-bf34-6e294bafc49a","spanId":"e6037f48","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.639Z"}
[32m2026-01-17T15:41:29.640Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.640Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:41:29.640Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"fd7322d0-7651-49d1-bf34-6e294bafc49a","spanId":"e6037f48","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.642Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"28c52e11-dee2-4d9c-b981-95d1637ac1aa","spanId":"58e95a5a","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.648Z"}
[32m2026-01-17T15:41:29.648Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.648Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:41:29.649Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"28c52e11-dee2-4d9c-b981-95d1637ac1aa","spanId":"58e95a5a","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:41:29.658Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"cf422436-7a17-4fc7-946f-210cdb909bc8","spanId":"74204e55","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.648Z"}
[32m2026-01-17T15:41:29.661Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.661Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"d7ea709f-9d22-48d9-aec2-b1506455daab","spanId":"ab9e3b88","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.664Z"}
[32m2026-01-17T15:41:29.665Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.665Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:41:29.666Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"d7ea709f-9d22-48d9-aec2-b1506455daab","spanId":"ab9e3b88","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.667Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"01e3feee-c0eb-48af-b893-c586b7bc441b","spanId":"528da83e","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.662Z"}
[32m2026-01-17T15:41:29.666Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.666Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"25904c8a-e1c7-4076-bc4b-41e9f0a9a46c","spanId":"8429f6b3","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.673Z"}
[32m2026-01-17T15:41:29.673Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.673Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:41:29.674Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"25904c8a-e1c7-4076-bc4b-41e9f0a9a46c","spanId":"8429f6b3","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.675Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should return document templates
2026-01-17T15:41:29.673Z [WARN] Unknown API route accessed {"path":"/api/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:41:29.676Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"7410c9bb-b85b-40c0-b691-16d88b5f9885","spanId":"2b10883c","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.680Z"}
[32m2026-01-17T15:41:29.681Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.681Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Document Quality for Compliance > should analyze document quality against framework
2026-01-17T15:41:29.682Z [WARN] Unknown API route accessed {"path":"/api/analyze-document-quality","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"7410c9bb-b85b-40c0-b691-16d88b5f9885","spanId":"2b10883c","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.683Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"01e3feee-c0eb-48af-b893-c586b7bc441b","spanId":"528da83e","method":"POST","path":"/api/organizations","statusCode":401,"duration":31,"timestamp":"2026-01-17T15:41:29.692Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"cf422436-7a17-4fc7-946f-210cdb909bc8","spanId":"74204e55","method":"GET","path":"/","statusCode":200,"duration":43,"timestamp":"2026-01-17T15:41:29.691Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"7727d5fb-f420-4087-ab48-57eb5e78393f","spanId":"f0ae0e6a","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.692Z"}
[32m2026-01-17T15:41:29.693Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.693Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:41:29.695Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"7727d5fb-f420-4087-ab48-57eb5e78393f","spanId":"f0ae0e6a","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:41:29.699Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"ff74bb27-a9c1-4203-aeda-be9f4ef0c884","spanId":"b0f682ce","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.704Z"}
[32m2026-01-17T15:41:29.706Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.706Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:41:29.707Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"b267f710-08a0-4dd3-b133-15b31b20f4db","spanId":"1da0c4ca","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.709Z"}
[32m2026-01-17T15:41:29.710Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.710Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"ff74bb27-a9c1-4203-aeda-be9f4ef0c884","spanId":"b0f682ce","method":"GET","path":"/api/organizations","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:41:29.710Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:41:29.711Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"b267f710-08a0-4dd3-b133-15b31b20f4db","spanId":"1da0c4ca","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.712Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"2b2d4f02-f50f-4e35-a270-ae0d983251e1","spanId":"d6a713ee","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.723Z"}
[32m2026-01-17T15:41:29.724Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.724Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"5c5a9849-0200-432f-9f9f-1b76d5d2bce8","spanId":"9abb0d20","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.726Z"}
[32m2026-01-17T15:41:29.726Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.726Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"402a8a9b-76b7-4aef-8299-0af789b121e5","spanId":"479788db","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.724Z"}
[32m2026-01-17T15:41:29.725Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.725Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:41:29.725Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"2b2d4f02-f50f-4e35-a270-ae0d983251e1","spanId":"d6a713ee","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.726Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:41:29.727Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:41:29.727Z [WARN] Unknown API route accessed {"path":"/api/document-templates","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"5c5a9849-0200-432f-9f9f-1b76d5d2bce8","spanId":"9abb0d20","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:41:29.730Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"b8686f1f-3608-47ee-aaee-e8038975befe","spanId":"ab5fe3b5","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.732Z"}
[32m2026-01-17T15:41:29.733Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.733Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:41:29.734Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"b8686f1f-3608-47ee-aaee-e8038975befe","spanId":"ab5fe3b5","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:29.736Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"402a8a9b-76b7-4aef-8299-0af789b121e5","spanId":"479788db","method":"GET","path":"/","statusCode":200,"duration":12,"timestamp":"2026-01-17T15:41:29.736Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"02619a06-36d3-4d73-bff3-50d63b8b52b2","spanId":"56ccb204","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.737Z"}
[32m2026-01-17T15:41:29.737Z [INFO] POST /api/assess-risk {"method":"POST","url":"/api/assess-risk","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.737Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:41:29.738Z [WARN] Unknown API route accessed {"path":"/api/assess-risk","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"02619a06-36d3-4d73-bff3-50d63b8b52b2","spanId":"56ccb204","method":"POST","path":"/api/assess-risk","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:41:29.739Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:41:29.739Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"59b47279-89ac-44af-8bd5-c48c19b21e02","spanId":"9818e619","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.742Z"}
[32m2026-01-17T15:41:29.742Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.742Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:41:29.743Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"59b47279-89ac-44af-8bd5-c48c19b21e02","spanId":"9818e619","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.745Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"f14390d1-528f-47ef-b82c-53a35a030f43","spanId":"84874cdb","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.746Z"}
[32m2026-01-17T15:41:29.747Z [INFO] POST /api/calculate-compliance-score {"method":"POST","url":"/api/calculate-compliance-score","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.747Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:41:29.748Z [WARN] Unknown API route accessed {"path":"/api/calculate-compliance-score","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"f14390d1-528f-47ef-b82c-53a35a030f43","spanId":"84874cdb","method":"POST","path":"/api/calculate-compliance-score","statusCode":404,"duration":8,"timestamp":"2026-01-17T15:41:29.754Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"78e4e0eb-54fd-4cf8-b330-4410e5cee7fa","spanId":"327437bb","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.757Z"}
[32m2026-01-17T15:41:29.757Z [INFO] POST /api/ai/generate {"method":"POST","url":"/api/ai/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.757Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:41:29.758Z [INFO] API route accessed {"path":"/api/ai/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"64d91619-2e22-4c74-af6c-e3ea5e38c741","spanId":"5b716a3a","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.759Z"}
[32m2026-01-17T15:41:29.760Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.760Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"78e4e0eb-54fd-4cf8-b330-4410e5cee7fa","spanId":"327437bb","method":"POST","path":"/api/ai/generate","statusCode":404,"duration":4,"timestamp":"2026-01-17T15:41:29.760Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:41:29.760Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"64d91619-2e22-4c74-af6c-e3ea5e38c741","spanId":"5b716a3a","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:41:29.762Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"f36eed26-fe94-4dda-8967-d5262e45df49","spanId":"7ccbf223","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.762Z"}
[32m2026-01-17T15:41:29.763Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.763Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Templates > should get a specific template by ID
2026-01-17T15:41:29.764Z [WARN] Unknown API route accessed {"path":"/api/document-templates/iso-001","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:41:29.766Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.766Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"5df4e737-048f-404e-9b4c-9cac1c4e6179","spanId":"b7adbf0a","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.767Z"}
[32m2026-01-17T15:41:29.768Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.768Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"f36eed26-fe94-4dda-8967-d5262e45df49","spanId":"7ccbf223","method":"GET","path":"/iso-001","statusCode":200,"duration":6,"timestamp":"2026-01-17T15:41:29.768Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
2026-01-17T15:41:29.768Z [WARN] Unknown API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"5df4e737-048f-404e-9b4c-9cac1c4e6179","spanId":"b7adbf0a","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:41:29.770Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"955ea80b-cdc8-4b9a-ab52-9b0f5d7d0612","spanId":"4d06d656","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.769Z"}
[32m2026-01-17T15:41:29.769Z [INFO] POST /api/ai/analyze {"method":"POST","url":"/api/ai/analyze","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.769Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:41:29.770Z [INFO] API route accessed {"path":"/api/ai/analyze","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:41:29.770Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 390[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 84[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 11[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 21[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 7[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"955ea80b-cdc8-4b9a-ab52-9b0f5d7d0612","spanId":"4d06d656","method":"POST","path":"/api/ai/analyze","statusCode":404,"duration":4,"timestamp":"2026-01-17T15:41:29.773Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"4719c4d8-0090-4783-9af6-33dfd5eef4d6","spanId":"e8c96196","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.784Z"}
[32m2026-01-17T15:41:29.785Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.785Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:41:29.785Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.785Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:41:29.786Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:41:29.786Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"4719c4d8-0090-4783-9af6-33dfd5eef4d6","spanId":"e8c96196","method":"GET","path":"/api/auth/user","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:41:29.795Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"2f8a3339-b030-41a8-a4ed-e41dc496724c","spanId":"f86739e3","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.799Z"}
[32m2026-01-17T15:41:29.799Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.799Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:41:29.800Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"2f8a3339-b030-41a8-a4ed-e41dc496724c","spanId":"f86739e3","method":"POST","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.802Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"9f65b108-89a1-41c6-89cb-2901dfbe5ee3","spanId":"f189838b","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.802Z"}
[32m2026-01-17T15:41:29.803Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.803Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"b056ea53-ef20-45b8-9ffe-b4d0c7ec2cb7","spanId":"9249b8ae","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.800Z"}
[32m2026-01-17T15:41:29.801Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.801Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:41:29.804Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"9f65b108-89a1-41c6-89cb-2901dfbe5ee3","spanId":"f189838b","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:41:29.809Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"b9e6a9bc-0ea6-4f70-85ea-a8b7e6fd1209","spanId":"0e3885cb","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.809Z"}
[32m2026-01-17T15:41:29.814Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.814Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:41:29.804Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:41:29.814Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:41:29.815Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"b056ea53-ef20-45b8-9ffe-b4d0c7ec2cb7","spanId":"9249b8ae","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":17,"timestamp":"2026-01-17T15:41:29.816Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"db9077eb-9b25-4789-9d6f-5b8981cae9df","spanId":"4de40045","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.820Z"}
[32m2026-01-17T15:41:29.821Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.821Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"b9e6a9bc-0ea6-4f70-85ea-a8b7e6fd1209","spanId":"0e3885cb","method":"GET","path":"/api/evidence","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:41:29.818Z"}
stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:41:29.824Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}


[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:41:29.823Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"7a1a6e28-4b29-4c87-b07f-e5e85adc3e42","spanId":"94e392c1","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.823Z"}
[32m2026-01-17T15:41:29.823Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.823Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"db9077eb-9b25-4789-9d6f-5b8981cae9df","spanId":"4de40045","method":"GET","path":"/api/documents","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:41:29.825Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"7a1a6e28-4b29-4c87-b07f-e5e85adc3e42","spanId":"94e392c1","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.825Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"31f1d9b9-181b-47d3-a635-518fe5f94141","spanId":"2bb56aab","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.828Z"}
[32m2026-01-17T15:41:29.829Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.829Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"0a6e0caa-b9e4-4f9d-ac83-a4c4aee8fb77","spanId":"bc8b3452","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.830Z"}
[32m2026-01-17T15:41:29.830Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.830Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:41:29.831Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"0a6e0caa-b9e4-4f9d-ac83-a4c4aee8fb77","spanId":"bc8b3452","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.832Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:41:29.830Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"31f1d9b9-181b-47d3-a635-518fe5f94141","spanId":"2bb56aab","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:41:29.834Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"2d272af6-6d93-4552-ab00-674da52c3420","spanId":"28b3b7c2","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.836Z"}
[32m2026-01-17T15:41:29.836Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.836Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:41:29.837Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"2d272af6-6d93-4552-ab00-674da52c3420","spanId":"28b3b7c2","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.838Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"41a33fb2-c46d-48e5-90fe-340301e1f24c","spanId":"6982e0ef","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.850Z"}
[32m2026-01-17T15:41:29.851Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.851Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should export document as markdown
2026-01-17T15:41:29.851Z [WARN] Unknown API route accessed {"path":"/api/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"41a33fb2-c46d-48e5-90fe-340301e1f24c","spanId":"6982e0ef","method":"POST","path":"/export-document","statusCode":200,"duration":4,"timestamp":"2026-01-17T15:41:29.854Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"66eb4328-5d02-4a31-bfe1-a08a50917477","spanId":"6463e3dc","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.850Z"}
[32m2026-01-17T15:41:29.853Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.853Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:41:29.853Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.853Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:41:29.857Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"66eb4328-5d02-4a31-bfe1-a08a50917477","spanId":"6463e3dc","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":13,"timestamp":"2026-01-17T15:41:29.863Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"c688f87b-b67a-489b-b547-e27831be761b","spanId":"70bf999b","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.862Z"}
[32m2026-01-17T15:41:29.863Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.863Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:41:29.864Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"9c7893a2-0c37-47c8-a946-51c9a4723f6c","spanId":"21d68952","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.869Z"}
[32m2026-01-17T15:41:29.869Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.869Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Export > should handle export without content
2026-01-17T15:41:29.864Z [WARN] Unknown API route accessed {"path":"/api/export-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"c688f87b-b67a-489b-b547-e27831be761b","spanId":"70bf999b","method":"POST","path":"/export-document","statusCode":400,"duration":8,"timestamp":"2026-01-17T15:41:29.870Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:41:29.870Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"9c7893a2-0c37-47c8-a946-51c9a4723f6c","spanId":"21d68952","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.871Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"9612e59a-318a-4f12-b53f-645de920ea9e","spanId":"a3ceb0b5","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.871Z"}
[32m2026-01-17T15:41:29.881Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.881Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"4f9d1703-4418-4d08-94cd-de43cf485451","spanId":"b7077f7a","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.883Z"}
[32m2026-01-17T15:41:29.883Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.883Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"2c82250c-d68b-43c2-8da7-d8532f96f619","spanId":"7e612594","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.883Z"}
[32m2026-01-17T15:41:29.883Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.883Z"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document AI Generation > should reject generation request without framework
2026-01-17T15:41:29.884Z [WARN] Unknown API route accessed {"path":"/api/generate-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:41:29.883Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:41:29.883Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"4f9d1703-4418-4d08-94cd-de43cf485451","spanId":"b7077f7a","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.885Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"2c82250c-d68b-43c2-8da7-d8532f96f619","spanId":"7e612594","method":"POST","path":"/api/generate-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.885Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"9612e59a-318a-4f12-b53f-645de920ea9e","spanId":"a3ceb0b5","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":15,"timestamp":"2026-01-17T15:41:29.886Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"7ca29073-1c9f-4046-9116-6070c2ea42dc","spanId":"26b691fc","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.887Z"}
[32m2026-01-17T15:41:29.889Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.889Z"}[0m

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 445[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"099b3cf0-dfcc-46ba-9a97-c5788022634d","spanId":"efb8dc03","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.890Z"}
[32m2026-01-17T15:41:29.891Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.891Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:41:29.891Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"099b3cf0-dfcc-46ba-9a97-c5788022634d","spanId":"efb8dc03","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.893Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_start","traceId":"d5b00bf4-8af8-4ed8-86a1-563702c4c08c","spanId":"773c82e0","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.893Z"}
[32m2026-01-17T15:41:29.893Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.893Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:41:29.890Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
2026-01-17T15:41:29.894Z [WARN] Unknown API route accessed {"path":"/api/analyze-document-quality","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_end","traceId":"d5b00bf4-8af8-4ed8-86a1-563702c4c08c","spanId":"773c82e0","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:41:29.897Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"7ca29073-1c9f-4046-9116-6070c2ea42dc","spanId":"26b691fc","method":"GET","path":"/api/auth/user","statusCode":401,"duration":12,"timestamp":"2026-01-17T15:41:29.899Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"09061a1b-2fd5-4883-8e35-610b6dd26c29","spanId":"5e0e36fd","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.903Z"}
[32m2026-01-17T15:41:29.904Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.904Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:41:29.909Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"09061a1b-2fd5-4883-8e35-610b6dd26c29","spanId":"5e0e36fd","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:41:29.911Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"45e0bd26-7b92-4faa-b5c0-db250495eb3b","spanId":"8569c2ff","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.913Z"}
[32m2026-01-17T15:41:29.914Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.914Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:41:29.915Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"45e0bd26-7b92-4faa-b5c0-db250495eb3b","spanId":"8569c2ff","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:41:29.918Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"0f03bbc8-e30c-4e7a-8a48-4db711c4237a","spanId":"e865b5bf","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.920Z"}
[32m2026-01-17T15:41:29.920Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.920Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"5c382d00-74e1-42e8-ab40-d213b6fe20f1","spanId":"baa2c7eb","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.920Z"}
[32m2026-01-17T15:41:29.921Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.921Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:41:29.921Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"0f03bbc8-e30c-4e7a-8a48-4db711c4237a","spanId":"e865b5bf","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.922Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:41:29.921Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"5c382d00-74e1-42e8-ab40-d213b6fe20f1","spanId":"baa2c7eb","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:29.924Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"e20f8cb4-4efe-4ceb-b964-aa27e24dbb51","spanId":"e27bef32","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.926Z"}
[32m2026-01-17T15:41:29.927Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.927Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:41:29.927Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"8c6c41b6-39a0-40df-a079-867fa8b418a6","spanId":"adadb007","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.939Z"}
[32m2026-01-17T15:41:29.939Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.939Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"e20f8cb4-4efe-4ceb-b964-aa27e24dbb51","spanId":"e27bef32","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.929Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:41:29.940Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"61c88bbf-f54a-449d-8cda-f5003b4ce5a9","spanId":"efe9042e","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.940Z"}
[32m2026-01-17T15:41:29.941Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.941Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"8c6c41b6-39a0-40df-a079-867fa8b418a6","spanId":"adadb007","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:41:29.941Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:41:29.941Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"61c88bbf-f54a-449d-8cda-f5003b4ce5a9","spanId":"efe9042e","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.943Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"6cceb9db-8cc6-4023-a14e-3a9eaefd34f7","spanId":"11b05d0c","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.947Z"}
[32m2026-01-17T15:41:29.947Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.947Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:41:29.948Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"6cceb9db-8cc6-4023-a14e-3a9eaefd34f7","spanId":"11b05d0c","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.949Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"c4884487-0ea6-41f3-a480-381a4e0c2267","spanId":"6423a0a6","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.949Z"}
[32m2026-01-17T15:41:29.950Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.950Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"3fdcb81a-41f0-436d-b2ee-475afcae9866","spanId":"d128638e","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.951Z"}
[32m2026-01-17T15:41:29.951Z [INFO] POST /api/documents/test-id/versions/version-id/restore {"method":"POST","url":"/api/documents/test-id/versions/version-id/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.951Z"}[0m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 513[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 96[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 12[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 22[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 6[2mms[22m[39m
[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:41:29.950Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:41:29.952Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/version-id/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"c4884487-0ea6-41f3-a480-381a4e0c2267","spanId":"6423a0a6","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:29.953Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"3fdcb81a-41f0-436d-b2ee-475afcae9866","spanId":"d128638e","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:41:29.953Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"74505f41-7d94-49fa-91a8-9c2b0196e227","spanId":"f67e0b08","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.958Z"}
[32m2026-01-17T15:41:29.958Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.958Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:41:29.959Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"ca777081-fe64-403b-a4c4-66536733e771","spanId":"dde1f152","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.959Z"}
[32m2026-01-17T15:41:29.960Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.960Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"74505f41-7d94-49fa-91a8-9c2b0196e227","spanId":"f67e0b08","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.960Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:41:29.960Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"ca777081-fe64-403b-a4c4-66536733e771","spanId":"dde1f152","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:29.962Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"2d0f8593-498a-4f10-b9fe-fc7f91a08c6a","spanId":"6077c30b","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.965Z"}
[32m2026-01-17T15:41:29.969Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.969Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:41:29.970Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"a28196e5-5786-4afb-a7a7-81bf99319ecd","spanId":"d9a2f0a3","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.971Z"}
[32m2026-01-17T15:41:29.971Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.971Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"2d0f8593-498a-4f10-b9fe-fc7f91a08c6a","spanId":"6077c30b","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:41:29.972Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should save a document with valid data
2026-01-17T15:41:29.972Z [WARN] Unknown API route accessed {"path":"/api/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"a28196e5-5786-4afb-a7a7-81bf99319ecd","spanId":"d9a2f0a3","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.973Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"102344ea-c203-4d69-95bc-7080c284db71","spanId":"7dabe585","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.978Z"}
[32m2026-01-17T15:41:29.978Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.978Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:41:29.979Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"4ff03147-aff8-4511-a738-30c36665a5ed","spanId":"fe64a533","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.979Z"}
[32m2026-01-17T15:41:29.979Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.979Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"102344ea-c203-4d69-95bc-7080c284db71","spanId":"7dabe585","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:41:29.980Z"}

stderr | tests/integration/documents.test.ts > Document Integration Tests > Document Saving > should reject save request without required fields
2026-01-17T15:41:29.980Z [WARN] Unknown API route accessed {"path":"/api/save-document","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"4ff03147-aff8-4511-a738-30c36665a5ed","spanId":"fe64a533","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:29.981Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"162ae1b6-50a1-414a-9d49-bbe75580c404","spanId":"a82c000c","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:29.987Z"}
[32m2026-01-17T15:41:29.988Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:29.988Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:41:29.989Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"162ae1b6-50a1-414a-9d49-bbe75580c404","spanId":"a82c000c","method":"GET","path":"/api/auth/user","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:29.991Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 523[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[32m 85[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[32m 57[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[32m 50[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[32m 22[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[39m[32m 29[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 200, 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[32m 20[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 8[2mms[22m[39m
stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:41:30.023Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:41:30.044Z [ERROR] Database health check failed {"error":"Unknown error"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 554[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 162[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 48[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 34[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 11[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 13[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 40[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 14[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 8 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
AssertionError: expected [ 200, 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/documents.test.ts:120:31
    118|         });
    119| 
    120|       expect([200, 500, 503]).toContain(response.status);
       |                               ^
    121|     });
    122|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/8]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/8]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
AssertionError: expected [ 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:57:28
     55|         expect(response.body).toHaveProperty('recommendations');
     56|       } else {
     57|         expect([500, 503]).toContain(response.status);
       |                            ^
     58|       }
     59|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/8]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/8]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/8]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/8]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/8]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/8]Î“Ã„Â»


[2m Test Files [22m [1m[31m4 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m8 failed[39m[22m[2m | [22m[1m[32m60 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:41:26
[2m   Duration [22m 17.46s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/middleware/routeValidation.ts [22m[39m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:41:43.964Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:41:43.967Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:41:43.975Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:41:43.975Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:41:43.992Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"1c87f2c9-2b82-4fbb-a25a-083a2e7ca237","spanId":"36642ea2","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.072Z"}
[32m2026-01-17T15:41:44.075Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.075Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:41:44.087Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"731a0ea8-11e9-4194-8fa7-89cb48358fea","spanId":"568914b8","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.090Z"}
[32m2026-01-17T15:41:44.093Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.093Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:41:44.104Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"731a0ea8-11e9-4194-8fa7-89cb48358fea","spanId":"568914b8","method":"POST","path":"/api/organizations","statusCode":401,"duration":22,"timestamp":"2026-01-17T15:41:44.112Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"1c87f2c9-2b82-4fbb-a25a-083a2e7ca237","spanId":"36642ea2","method":"GET","path":"/","statusCode":200,"duration":39,"timestamp":"2026-01-17T15:41:44.111Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"121df383-597f-47db-a1a5-839446740468","spanId":"32cec886","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.124Z"}
[32m2026-01-17T15:41:44.125Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.125Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:41:44.126Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"2688ddad-edbd-40e5-8b31-fd4ff9840a1b","spanId":"28bed786","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.121Z"}
[32m2026-01-17T15:41:44.128Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.128Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"121df383-597f-47db-a1a5-839446740468","spanId":"32cec886","method":"GET","path":"/api/organizations","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:41:44.134Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"e79b3562-9dc6-49a2-913f-0b933c08ecf9","spanId":"f2cb1374","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.140Z"}
[32m2026-01-17T15:41:44.142Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.142Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:41:44.143Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"e79b3562-9dc6-49a2-913f-0b933c08ecf9","spanId":"f2cb1374","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:41:44.145Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"4366e8df-eaed-4ba6-bd6c-19b51a890f91","spanId":"50c67b3b","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.140Z"}
[32m2026-01-17T15:41:44.146Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.146Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:41:44.143Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:41:44.147Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"c00a255c-b629-427d-a07b-3880a8a9ea5b","spanId":"2b004871","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.151Z"}
[32m2026-01-17T15:41:44.151Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.151Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"2688ddad-edbd-40e5-8b31-fd4ff9840a1b","spanId":"28bed786","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":32,"timestamp":"2026-01-17T15:41:44.152Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:41:44.152Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"c00a255c-b629-427d-a07b-3880a8a9ea5b","spanId":"2b004871","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.154Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:41:44.156Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"67ed6285-f025-41a8-94cb-6a0408d87bab","spanId":"6fac4a66","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.161Z"}
[32m2026-01-17T15:41:44.162Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.162Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"2baaff2b-beb5-4630-9110-e3cceb487258","spanId":"a0fb1c84","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.162Z"}
[32m2026-01-17T15:41:44.167Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.167Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:41:44.162Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:41:44.168Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"67ed6285-f025-41a8-94cb-6a0408d87bab","spanId":"6fac4a66","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:41:44.168Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"2baaff2b-beb5-4630-9110-e3cceb487258","spanId":"a0fb1c84","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:41:44.171Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"4366e8df-eaed-4ba6-bd6c-19b51a890f91","spanId":"50c67b3b","method":"GET","path":"/","statusCode":200,"duration":32,"timestamp":"2026-01-17T15:41:44.172Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"0b0e3e9a-9838-4e7b-b27b-7b0237b24efc","spanId":"eecd7e65","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.176Z"}
[32m2026-01-17T15:41:44.176Z [INFO] POST /api/ai/generate {"method":"POST","url":"/api/ai/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.176Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:41:44.177Z [INFO] API route accessed {"path":"/api/ai/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:41:44.175Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"11248bf3-f380-4c32-b1e5-7fd8a013c2b6","spanId":"b785bae6","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.177Z"}
[32m2026-01-17T15:41:44.178Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.178Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"0b0e3e9a-9838-4e7b-b27b-7b0237b24efc","spanId":"eecd7e65","method":"POST","path":"/api/ai/generate","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:41:44.178Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:41:44.178Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"11248bf3-f380-4c32-b1e5-7fd8a013c2b6","spanId":"b785bae6","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:44.179Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:41:44.181Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.181Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"feecfa94-057a-43f3-84bd-4465d8caa032","spanId":"8e3f7e36","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.184Z"}
[32m2026-01-17T15:41:44.185Z [INFO] POST /api/ai/analyze {"method":"POST","url":"/api/ai/analyze","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.185Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:41:44.185Z [INFO] API route accessed {"path":"/api/ai/analyze","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"d8ecc743-aa36-46e3-8c44-13d9875a21d2","spanId":"aa307ae0","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.185Z"}
[32m2026-01-17T15:41:44.186Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.186Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"feecfa94-057a-43f3-84bd-4465d8caa032","spanId":"8e3f7e36","method":"POST","path":"/api/ai/analyze","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:41:44.187Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:41:44.186Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:41:44.185Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"d8ecc743-aa36-46e3-8c44-13d9875a21d2","spanId":"aa307ae0","method":"GET","path":"/iso-001","statusCode":200,"duration":3,"timestamp":"2026-01-17T15:41:44.188Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:41:44.194Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.194Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"d3b5f60b-0b29-47b8-b4cf-d3c6acd47e44","spanId":"9016fad0","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.193Z"}
[32m2026-01-17T15:41:44.194Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.194Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:41:44.197Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"cacbbd31-da3b-4c03-9c70-6e0db08560db","spanId":"1e5a741b","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.194Z"}
[32m2026-01-17T15:41:44.198Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.198Z"}[0m
stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:41:44.198Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}


[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"d3b5f60b-0b29-47b8-b4cf-d3c6acd47e44","spanId":"9016fad0","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:41:44.199Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:41:44.199Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.199Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:41:44.199Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:41:44.203Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"cacbbd31-da3b-4c03-9c70-6e0db08560db","spanId":"1e5a741b","method":"GET","path":"/api/auth/user","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:41:44.205Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"6844b165-4104-4e1c-a1f3-551633f10aa6","spanId":"0306bca4","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.207Z"}
[32m2026-01-17T15:41:44.207Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.207Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"a01b4a58-a9f4-483f-bda9-5c9dceb5b024","spanId":"242a5d81","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.207Z"}
[32m2026-01-17T15:41:44.207Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.207Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:41:44.208Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:41:44.208Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"a01b4a58-a9f4-483f-bda9-5c9dceb5b024","spanId":"242a5d81","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.210Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"6844b165-4104-4e1c-a1f3-551633f10aa6","spanId":"0306bca4","method":"POST","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.210Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"5bc6862a-4062-4cfd-ad3b-7ad4a653c3fb","spanId":"53bd7972","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.210Z"}
[32m2026-01-17T15:41:44.211Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.211Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"e0ebcaf5-2950-4c9f-8ef7-26533b780d58","spanId":"64b8b8cf","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.212Z"}
[32m2026-01-17T15:41:44.213Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.212Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"357ad1f4-7e97-46fc-be91-f0f373fd3739","spanId":"6d0e9b8c","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.212Z"}
[32m2026-01-17T15:41:44.212Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.212Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:41:44.211Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"5bc6862a-4062-4cfd-ad3b-7ad4a653c3fb","spanId":"53bd7972","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:44.214Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"07bbc079-9762-457d-b9e3-38187ab45099","spanId":"d1bec5d4","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.215Z"}
[32m2026-01-17T15:41:44.216Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.216Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"95b4a131-9af5-4af2-835a-934ce2dc6448","spanId":"410edc7e","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.216Z"}
[32m2026-01-17T15:41:44.217Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.217Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:41:44.213Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"e0ebcaf5-2950-4c9f-8ef7-26533b780d58","spanId":"64b8b8cf","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:41:44.218Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:41:44.216Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:41:44.217Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"07bbc079-9762-457d-b9e3-38187ab45099","spanId":"d1bec5d4","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.218Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"95b4a131-9af5-4af2-835a-934ce2dc6448","spanId":"410edc7e","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.219Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:41:44.213Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"357ad1f4-7e97-46fc-be91-f0f373fd3739","spanId":"6d0e9b8c","method":"GET","path":"/api/auth/user","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:41:44.220Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"928e9b13-f798-492e-8f04-07b375b23a48","spanId":"53d7439b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.223Z"}
[32m2026-01-17T15:41:44.223Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.223Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"defabeb9-a062-43a8-ad94-a7c3a4e51790","spanId":"1dc06270","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.224Z"}
[32m2026-01-17T15:41:44.224Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.224Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:41:44.224Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"928e9b13-f798-492e-8f04-07b375b23a48","spanId":"53d7439b","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:44.225Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"7b8bb9bf-9d60-4b1e-aba9-880c4f059957","spanId":"8917426d","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.227Z"}
[32m2026-01-17T15:41:44.233Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.233Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:41:44.233Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"7b8bb9bf-9d60-4b1e-aba9-880c4f059957","spanId":"8917426d","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:41:44.235Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:41:44.225Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"66ae40b9-65c9-4f86-bc76-bc3a2f567cc9","spanId":"418aef49","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.234Z"}
[32m2026-01-17T15:41:44.235Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.235Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"defabeb9-a062-43a8-ad94-a7c3a4e51790","spanId":"1dc06270","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:41:44.235Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"e3dfbb13-3a7b-4aee-9dc1-cc1e4012b909","spanId":"3b38af7c","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.237Z"}
[32m2026-01-17T15:41:44.237Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.237Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:41:44.235Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"66ae40b9-65c9-4f86-bc76-bc3a2f567cc9","spanId":"418aef49","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:44.238Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:41:44.237Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"e3dfbb13-3a7b-4aee-9dc1-cc1e4012b909","spanId":"3b38af7c","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:44.239Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"bca2a028-004d-40bd-8319-6988bce9fd47","spanId":"75c763e7","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.240Z"}
[32m2026-01-17T15:41:44.240Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.240Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"fe2c31d4-9fa0-473d-b43c-9c6443b190b9","spanId":"b24146fa","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.241Z"}
[32m2026-01-17T15:41:44.241Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.241Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:41:44.241Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"bca2a028-004d-40bd-8319-6988bce9fd47","spanId":"75c763e7","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.243Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:41:44.241Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"5ac37c33-d773-4ffe-aea4-a6d3cf61e2c4","spanId":"faf46938","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.243Z"}
[32m2026-01-17T15:41:44.243Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.243Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"eb8c4458-14de-4c69-a8b0-ddba60c4ff47","spanId":"f7a00f9f","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.243Z"}
[32m2026-01-17T15:41:44.243Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.243Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"fe2c31d4-9fa0-473d-b43c-9c6443b190b9","spanId":"b24146fa","method":"POST","path":"/export-document","statusCode":200,"duration":4,"timestamp":"2026-01-17T15:41:44.244Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:41:44.244Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:41:44.244Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"eb8c4458-14de-4c69-a8b0-ddba60c4ff47","spanId":"f7a00f9f","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.246Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"5ac37c33-d773-4ffe-aea4-a6d3cf61e2c4","spanId":"faf46938","method":"GET","path":"/api/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.246Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"80110e72-1a2f-4920-918e-aaf28e744373","spanId":"47be9ce6","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.247Z"}
[32m2026-01-17T15:41:44.247Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.247Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"167a8259-70f1-40a6-a1f7-2d2d1634cc26","spanId":"42cba0fb","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.246Z"}
[32m2026-01-17T15:41:44.247Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.247Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:41:44.247Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"80110e72-1a2f-4920-918e-aaf28e744373","spanId":"47be9ce6","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.249Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:41:44.248Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"23152bea-3260-4e75-92dd-6eaa2d2d5553","spanId":"48fc7b61","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.250Z"}
[32m2026-01-17T15:41:44.251Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.251Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"167a8259-70f1-40a6-a1f7-2d2d1634cc26","spanId":"42cba0fb","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:41:44.251Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:41:44.252Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"320408be-e74e-4b67-abcb-bbbe7b890020","spanId":"e181c934","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.253Z"}
[32m2026-01-17T15:41:44.253Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.253Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"23152bea-3260-4e75-92dd-6eaa2d2d5553","spanId":"48fc7b61","method":"POST","path":"/export-document","statusCode":400,"duration":4,"timestamp":"2026-01-17T15:41:44.254Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"777e1b4b-94bf-42d1-89e6-1c71d109d948","spanId":"e0263702","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.255Z"}
[32m2026-01-17T15:41:44.255Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.255Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:41:44.254Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:41:44.256Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"320408be-e74e-4b67-abcb-bbbe7b890020","spanId":"e181c934","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.256Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"777e1b4b-94bf-42d1-89e6-1c71d109d948","spanId":"e0263702","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:44.257Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"f6e7d0f1-47a5-4644-a5fe-7fd8b04f3b4d","spanId":"54cb2e00","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.264Z"}
[32m2026-01-17T15:41:44.264Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.264Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"b0bf56b6-c41b-4c34-a854-632d0b0b65f1","spanId":"008363f3","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.264Z"}
[32m2026-01-17T15:41:44.265Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.265Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"3f91ce2c-6372-4e06-b28b-491225ede3b7","spanId":"ba436dab","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.264Z"}
[32m2026-01-17T15:41:44.265Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.265Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:41:44.265Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:41:44.266Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"f6e7d0f1-47a5-4644-a5fe-7fd8b04f3b4d","spanId":"54cb2e00","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.266Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:41:44.266Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"b0bf56b6-c41b-4c34-a854-632d0b0b65f1","spanId":"008363f3","method":"POST","path":"/api/generate-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.267Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"3f91ce2c-6372-4e06-b28b-491225ede3b7","spanId":"ba436dab","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.267Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"14cd497c-f9bd-40f4-bdb2-df959616fabf","spanId":"33b97e8c","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.267Z"}
[32m2026-01-17T15:41:44.268Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.268Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:41:44.268Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"14cd497c-f9bd-40f4-bdb2-df959616fabf","spanId":"33b97e8c","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.270Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"d39f5fa9-086e-4b82-8e62-44706ab8b1d4","spanId":"712c5d83","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.273Z"}
[32m2026-01-17T15:41:44.274Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.274Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:41:44.274Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"f8e6775c-b7c4-455d-9485-f43e20abee59","spanId":"feecfb89","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.275Z"}
[32m2026-01-17T15:41:44.275Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.275Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"4e9a29b8-c090-441c-b08c-3a3342b5c55b","spanId":"581b93d7","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.275Z"}
[32m2026-01-17T15:41:44.275Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.275Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"d39f5fa9-086e-4b82-8e62-44706ab8b1d4","spanId":"712c5d83","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:44.275Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_start","traceId":"eb7e5418-2b3f-4d45-a47c-08199aa351ea","spanId":"13ff4a66","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.276Z"}
[32m2026-01-17T15:41:44.276Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.276Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:41:44.276Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"5487d64b-cd95-4823-98c0-3d4df5aae421","spanId":"632644dd","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.276Z"}
[32m2026-01-17T15:41:44.277Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.277Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:41:44.276Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"f8e6775c-b7c4-455d-9485-f43e20abee59","spanId":"feecfb89","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:44.279Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:41:44.278Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"4e9a29b8-c090-441c-b08c-3a3342b5c55b","spanId":"581b93d7","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:44.279Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"5487d64b-cd95-4823-98c0-3d4df5aae421","spanId":"632644dd","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":3,"timestamp":"2026-01-17T15:41:44.279Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m[32m2026-01-17T15:41:44.278Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould allow document quality analysis without auth
[22m[39m{"type":"request_end","traceId":"eb7e5418-2b3f-4d45-a47c-08199aa351ea","spanId":"13ff4a66","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:41:44.280Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"403cf058-9890-49b6-befe-2d77e487839b","spanId":"b51a9ae0","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.281Z"}
[32m2026-01-17T15:41:44.282Z [INFO] POST /api/assess-risk {"method":"POST","url":"/api/assess-risk","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.282Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"70187f6c-a7d3-4b2b-81e4-dde66f887cff","spanId":"d5c33c4e","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.283Z"}
[32m2026-01-17T15:41:44.284Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.284Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:41:44.282Z [WARN] Unknown API route accessed {"path":"/api/assess-risk","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"403cf058-9890-49b6-befe-2d77e487839b","spanId":"b51a9ae0","method":"POST","path":"/api/assess-risk","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:41:44.283Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 361[2mms[22m[39m
stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:41:44.284Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"70187f6c-a7d3-4b2b-81e4-dde66f887cff","spanId":"d5c33c4e","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.286Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"84922179-576e-41cd-8a0c-6dc82aeb994b","spanId":"3474febd","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.287Z"}
[32m2026-01-17T15:41:44.288Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.288Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"d33dda20-2620-4c8f-a4bb-e23314eadccc","spanId":"1cc661d4","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.289Z"}
[32m2026-01-17T15:41:44.289Z [INFO] POST /api/calculate-compliance-score {"method":"POST","url":"/api/calculate-compliance-score","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.289Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:41:44.289Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:41:44.289Z [WARN] Unknown API route accessed {"path":"/api/calculate-compliance-score","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"84922179-576e-41cd-8a0c-6dc82aeb994b","spanId":"3474febd","method":"GET","path":"/api/auth/user","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.290Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"d33dda20-2620-4c8f-a4bb-e23314eadccc","spanId":"1cc661d4","method":"POST","path":"/api/calculate-compliance-score","statusCode":404,"duration":1,"timestamp":"2026-01-17T15:41:44.290Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"c9adeba6-b048-41a4-9b25-c849af9abee2","spanId":"dd096438","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.291Z"}
[32m2026-01-17T15:41:44.291Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.291Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:41:44.298Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"d6b439fc-d76b-4669-bfee-e2da1e9faaea","spanId":"08254e5a","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.299Z"}
[32m2026-01-17T15:41:44.300Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.300Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"c9adeba6-b048-41a4-9b25-c849af9abee2","spanId":"dd096438","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:41:44.301Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:41:44.301Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"2cf69881-1d78-475e-a604-e266e6f118b3","spanId":"6b92bee6","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.303Z"}
[32m2026-01-17T15:41:44.303Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.303Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"d6b439fc-d76b-4669-bfee-e2da1e9faaea","spanId":"08254e5a","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:41:44.304Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:41:44.304Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"2cf69881-1d78-475e-a604-e266e6f118b3","spanId":"6b92bee6","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:41:44.306Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"043abdeb-0289-448c-becf-d3003b56c574","spanId":"f7d75c86","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.306Z"}
[32m2026-01-17T15:41:44.306Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.306Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:41:44.307Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:41:44.307Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"043abdeb-0289-448c-becf-d3003b56c574","spanId":"f7d75c86","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.309Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"69f42ad3-7d9e-44af-b23a-1a9747d247cd","spanId":"0d74723a","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.311Z"}
[32m2026-01-17T15:41:44.312Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.312Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"695e36fa-a091-4b42-b5f6-b8d6a11d2d25","spanId":"c5210413","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.311Z"}
[32m2026-01-17T15:41:44.312Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.312Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:41:44.312Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:41:44.313Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"695e36fa-a091-4b42-b5f6-b8d6a11d2d25","spanId":"c5210413","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:41:44.314Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"69f42ad3-7d9e-44af-b23a-1a9747d247cd","spanId":"0d74723a","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:41:44.315Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"01498140-1279-40d1-8c8d-7a75376b4921","spanId":"43668aa4","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.316Z"}
[32m2026-01-17T15:41:44.317Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.317Z"}[0m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 388[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 86[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 16[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 14[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 7[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:41:44.317Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"01498140-1279-40d1-8c8d-7a75376b4921","spanId":"43668aa4","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.319Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:41:44.321Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"ed557b5d-2e21-4a48-8b0e-fba29a867edb","spanId":"f884f2cc","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.326Z"}
[32m2026-01-17T15:41:44.326Z [INFO] POST /api/documents/test-id/versions/version-id/restore {"method":"POST","url":"/api/documents/test-id/versions/version-id/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.326Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"6e618b05-fdcf-469c-8f61-e008098f5ffb","spanId":"f96fe9f1","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.326Z"}
[32m2026-01-17T15:41:44.326Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.326Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:41:44.327Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:41:44.327Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/version-id/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"ed557b5d-2e21-4a48-8b0e-fba29a867edb","spanId":"f884f2cc","method":"POST","path":"/api/documents/test-id/versions/version-id/restore","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:41:44.328Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"6e618b05-fdcf-469c-8f61-e008098f5ffb","spanId":"f96fe9f1","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:44.328Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 422[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 129[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 33[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 12[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 17[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"dd9f3124-1025-4bf0-9e02-08296ed96523","spanId":"8e15ecd1","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.333Z"}
[32m2026-01-17T15:41:44.333Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.333Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"243317ce-692e-4b75-908e-ed08795b7894","spanId":"67bb0031","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.333Z"}
[32m2026-01-17T15:41:44.333Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.333Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:41:44.334Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:41:44.334Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"dd9f3124-1025-4bf0-9e02-08296ed96523","spanId":"8e15ecd1","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:44.335Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"243317ce-692e-4b75-908e-ed08795b7894","spanId":"67bb0031","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:41:44.335Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"9b21e90a-5acb-45fd-96d8-438ee6a2ba6d","spanId":"75216b21","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.347Z"}
[32m2026-01-17T15:41:44.348Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.348Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:41:44.348Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"9b21e90a-5acb-45fd-96d8-438ee6a2ba6d","spanId":"75216b21","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.350Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"70ccc615-255c-4497-9cda-dd60252dd0a9","spanId":"abbf6f5e","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:41:44.356Z"}
[32m2026-01-17T15:41:44.356Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:41:44.356Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:41:44.357Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"70ccc615-255c-4497-9cda-dd60252dd0a9","spanId":"abbf6f5e","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:41:44.359Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 436[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 70[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 16[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 8[2mms[22m[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 443[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates[32m 85[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID[32m 53[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation[32m 29[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework[32m 14[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould allow document quality analysis without auth[39m[32m 18[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 200, 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation[32m 14[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields[32m 8[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 8 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Quality Analysis > should allow document quality analysis without auth
AssertionError: expected [ 200, 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/documents.test.ts:120:31
    118|         });
    119| 
    120|       expect([200, 500, 503]).toContain(response.status);
       |                               ^
    121|     });
    122|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/8]Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests > Document Versioning > should require authentication for version restore
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/documents.test.ts:144:10
    142|       await request(app)
    143|         .post('/api/documents/test-id/versions/version-id/restore')
    144|         .expect(401);
       |          ^
    145|     });
    146|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/8]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
AssertionError: expected [ 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:57:28
     55|         expect(response.body).toHaveProperty('recommendations');
     56|       } else {
     57|         expect([500, 503]).toContain(response.status);
       |                            ^
     58|       }
     59|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/8]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/8]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/8]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/8]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/8]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[8/8]Î“Ã„Â»


[2m Test Files [22m [1m[31m4 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m8 failed[39m[22m[2m | [22m[1m[32m60 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:41:40
[2m   Duration [22m 17.04s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/integration/documents.test.ts [22m[34mx13 [34m[39m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 436[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 70[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 16[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 8[2mms[22m[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 388[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 86[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 16[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 14[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 7[2mms[22m[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 422[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 129[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 33[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 12[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 17[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:42:06.642Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"39522cfd-b963-4dc9-9ac5-6feca9ceec92","spanId":"25eb8b2d","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.717Z"}
[32m2026-01-17T15:42:06.719Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.719Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:42:06.726Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"39522cfd-b963-4dc9-9ac5-6feca9ceec92","spanId":"25eb8b2d","method":"GET","path":"/","statusCode":200,"duration":17,"timestamp":"2026-01-17T15:42:06.734Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"17a14e53-7428-4608-8c1d-189313b40b33","spanId":"04d043a4","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.758Z"}
[32m2026-01-17T15:42:06.759Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.759Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:42:06.759Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"17a14e53-7428-4608-8c1d-189313b40b33","spanId":"04d043a4","method":"GET","path":"/","statusCode":200,"duration":7,"timestamp":"2026-01-17T15:42:06.765Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"d91dfefd-965a-443f-b0c7-a40c34c09c8c","spanId":"df6fdaf5","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.779Z"}
[32m2026-01-17T15:42:06.779Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.779Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:42:06.780Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"d91dfefd-965a-443f-b0c7-a40c34c09c8c","spanId":"df6fdaf5","method":"GET","path":"/iso-001","statusCode":200,"duration":6,"timestamp":"2026-01-17T15:42:06.785Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"0261b9e5-b7ea-4ce1-9d02-7e99985e4bd7","spanId":"16de5051","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.800Z"}
[32m2026-01-17T15:42:06.801Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.801Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:42:06.801Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"0261b9e5-b7ea-4ce1-9d02-7e99985e4bd7","spanId":"16de5051","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:42:06.805Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"c7d01946-5869-4a51-9e3e-07bb5ac68f4b","spanId":"44b8e3d8","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.811Z"}
[32m2026-01-17T15:42:06.812Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.812Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:42:06.817Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"c7d01946-5869-4a51-9e3e-07bb5ac68f4b","spanId":"44b8e3d8","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:42:06.819Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"050ca7c7-5fc5-43a5-addb-61bc9dbfee0b","spanId":"e45c6c93","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.830Z"}
[32m2026-01-17T15:42:06.830Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.830Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:42:06.830Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"050ca7c7-5fc5-43a5-addb-61bc9dbfee0b","spanId":"e45c6c93","method":"POST","path":"/export-document","statusCode":200,"duration":5,"timestamp":"2026-01-17T15:42:06.835Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"31c9d30f-4829-4d48-a5d8-457f6f8bd2b5","spanId":"1e44966c","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.840Z"}
[32m2026-01-17T15:42:06.840Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.840Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:42:06.841Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"31c9d30f-4829-4d48-a5d8-457f6f8bd2b5","spanId":"1e44966c","method":"POST","path":"/export-document","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:42:06.842Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"1077decc-8c7d-49b9-ba36-b68ead31cb0a","spanId":"3f25fde0","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.845Z"}
[32m2026-01-17T15:42:06.845Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.845Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:42:06.846Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"1077decc-8c7d-49b9-ba36-b68ead31cb0a","spanId":"3f25fde0","method":"POST","path":"/api/generate-document","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:42:06.846Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"e770c89a-5ebe-4ed1-9de8-bf85b37bc255","spanId":"abdcd9a6","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.850Z"}
[32m2026-01-17T15:42:06.851Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.851Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T15:42:06.851Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"e770c89a-5ebe-4ed1-9de8-bf85b37bc255","spanId":"abdcd9a6","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:42:06.852Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"bb656245-f2e0-46fe-a7f8-99ce7552bbd5","spanId":"9373d7d8","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.856Z"}
[32m2026-01-17T15:42:06.856Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.856Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:42:06.857Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"bb656245-f2e0-46fe-a7f8-99ce7552bbd5","spanId":"9373d7d8","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:42:06.858Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"beb3c13c-8882-481d-9743-de8c89603642","spanId":"c1db494b","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.862Z"}
[32m2026-01-17T15:42:06.862Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.862Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:42:06.862Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"beb3c13c-8882-481d-9743-de8c89603642","spanId":"c1db494b","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:42:06.863Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"11dd9a3c-b525-46d0-93f1-cf586071fdac","spanId":"88b68188","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.867Z"}
[32m2026-01-17T15:42:06.867Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.867Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:42:06.867Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"11dd9a3c-b525-46d0-93f1-cf586071fdac","spanId":"88b68188","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:42:06.869Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"6d8a055c-de6e-4084-9d83-f10703be0198","spanId":"e05df661","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.874Z"}
[32m2026-01-17T15:42:06.875Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.875Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:42:06.875Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"6d8a055c-de6e-4084-9d83-f10703be0198","spanId":"e05df661","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:42:06.877Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"c93cb0ae-30fd-40a8-aa39-186f395ddd95","spanId":"3c9e9407","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.880Z"}
[32m2026-01-17T15:42:06.880Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.880Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:42:06.881Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"c93cb0ae-30fd-40a8-aa39-186f395ddd95","spanId":"3c9e9407","method":"POST","path":"/api/save-document","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:42:06.882Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"bee57bc0-c5fe-439b-8f2b-2dd74d216e42","spanId":"fbd089da","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:42:06.884Z"}
[32m2026-01-17T15:42:06.884Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:42:06.884Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:42:06.885Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"bee57bc0-c5fe-439b-8f2b-2dd74d216e42","spanId":"fbd089da","method":"POST","path":"/api/save-document","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:42:06.885Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 302[2mms[22m[39m

[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[31m6 failed[39m[22m[2m | [22m[1m[32m56 passed[39m[22m[90m (62)[39m
[2m   Start at [22m 07:42:05
[2m   Duration [22m 1.71s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/middleware/security.ts [22m[39m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:43:16.365Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:43:16.368Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:43:16.376Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:43:16.378Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:43:16.385Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"8a1a2a02-c48e-4d8c-9046-f7aefe5a2cd4","spanId":"bb86dd93","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.473Z"}
[32m2026-01-17T15:43:16.476Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.476Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:43:16.487Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"9b1a67f3-b66b-4812-871f-c7ed0229963d","spanId":"7ab1b329","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.488Z"}
[32m2026-01-17T15:43:16.493Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.493Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"8a1a2a02-c48e-4d8c-9046-f7aefe5a2cd4","spanId":"bb86dd93","method":"GET","path":"/","statusCode":200,"duration":27,"timestamp":"2026-01-17T15:43:16.500Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"8aa985f5-62eb-4579-bcc8-d1b2b385d803","spanId":"e8e4249d","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.500Z"}
[32m2026-01-17T15:43:16.504Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.504Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:43:16.505Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"9b1a67f3-b66b-4812-871f-c7ed0229963d","spanId":"7ab1b329","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":27,"timestamp":"2026-01-17T15:43:16.513Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:43:16.515Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:43:16.517Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"8aa985f5-62eb-4579-bcc8-d1b2b385d803","spanId":"e8e4249d","method":"POST","path":"/api/organizations","statusCode":401,"duration":23,"timestamp":"2026-01-17T15:43:16.523Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"8c755e17-bbc1-4fc9-82ff-d1d421cda893","spanId":"f882bac3","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.523Z"}
[32m2026-01-17T15:43:16.525Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.525Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"57071f6d-41cb-4e53-b7e1-2e51620d5c18","spanId":"92b44bba","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.524Z"}
[32m2026-01-17T15:43:16.525Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.525Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:43:16.525Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:43:16.526Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"57071f6d-41cb-4e53-b7e1-2e51620d5c18","spanId":"92b44bba","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:43:16.528Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"7b3de9d7-09e2-4fdc-83a4-d0d5888fe725","spanId":"25a3c430","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.534Z"}
[32m2026-01-17T15:43:16.535Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.535Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"8c755e17-bbc1-4fc9-82ff-d1d421cda893","spanId":"f882bac3","method":"GET","path":"/","statusCode":200,"duration":11,"timestamp":"2026-01-17T15:43:16.534Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"e613a581-96dc-4673-a53a-0d8ca3672528","spanId":"ed5fce78","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.533Z"}
[32m2026-01-17T15:43:16.537Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.537Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:43:16.536Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"7b3de9d7-09e2-4fdc-83a4-d0d5888fe725","spanId":"25a3c430","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.537Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:43:16.536Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:43:16.537Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.537Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:43:16.539Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:43:16.544Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"1d729632-06e9-4299-85d6-176219e376d6","spanId":"8f16ca45","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.552Z"}
[32m2026-01-17T15:43:16.552Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.552Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"e613a581-96dc-4673-a53a-0d8ca3672528","spanId":"ed5fce78","method":"GET","path":"/api/organizations","statusCode":401,"duration":12,"timestamp":"2026-01-17T15:43:16.545Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"c4cee163-4e5c-48ec-9e2e-053e0b206530","spanId":"51e291ff","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.552Z"}
[32m2026-01-17T15:43:16.553Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.553Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:43:16.553Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"1d729632-06e9-4299-85d6-176219e376d6","spanId":"8f16ca45","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.555Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"70340667-fbed-4969-ba64-738d0ada957e","spanId":"28b27ec4","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.554Z"}
[32m2026-01-17T15:43:16.555Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.555Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"b0048eac-e115-411b-9a45-4752ea750653","spanId":"8ee91ba0","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.553Z"}
[32m2026-01-17T15:43:16.554Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.554Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:43:16.554Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"c4cee163-4e5c-48ec-9e2e-053e0b206530","spanId":"51e291ff","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:43:16.556Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:43:16.556Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"70340667-fbed-4969-ba64-738d0ada957e","spanId":"28b27ec4","method":"GET","path":"/iso-001","statusCode":200,"duration":4,"timestamp":"2026-01-17T15:43:16.558Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:43:16.558Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.558Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"40a65ca2-3a45-4d87-8603-6cea9a286e63","spanId":"aca35c2d","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.563Z"}
[32m2026-01-17T15:43:16.563Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.563Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"c8dca80c-9d8e-43c4-ab50-51bcff2424dc","spanId":"2e0b2fa2","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.563Z"}
[32m2026-01-17T15:43:16.563Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.563Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:43:16.555Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:43:16.564Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:43:16.564Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"40a65ca2-3a45-4d87-8603-6cea9a286e63","spanId":"aca35c2d","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.565Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"b0048eac-e115-411b-9a45-4752ea750653","spanId":"8ee91ba0","method":"GET","path":"/api/auth/user","statusCode":401,"duration":12,"timestamp":"2026-01-17T15:43:16.565Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"c8dca80c-9d8e-43c4-ab50-51bcff2424dc","spanId":"2e0b2fa2","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.566Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:43:16.565Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"c886e454-e6c1-452b-beb2-3bede56b53b6","spanId":"e9229389","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.570Z"}
[32m2026-01-17T15:43:16.571Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.571Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"ecb9f5df-86c8-4c62-830b-c416ea18b3d0","spanId":"d71a6bcb","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.571Z"}
[32m2026-01-17T15:43:16.572Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.572Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:43:16.572Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"c886e454-e6c1-452b-beb2-3bede56b53b6","spanId":"e9229389","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.573Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:43:16.572Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"ecb9f5df-86c8-4c62-830b-c416ea18b3d0","spanId":"d71a6bcb","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.574Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"3e7510f7-29b8-4c49-8bf2-73c87a7a7c73","spanId":"fb6312ff","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.571Z"}
[32m2026-01-17T15:43:16.572Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.572Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"00b4a4a8-d0db-4942-abcd-2883af4daf0a","spanId":"6a15fb53","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.577Z"}
[32m2026-01-17T15:43:16.577Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.577Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:43:16.575Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:43:16.578Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"00b4a4a8-d0db-4942-abcd-2883af4daf0a","spanId":"6a15fb53","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.579Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"3e7510f7-29b8-4c49-8bf2-73c87a7a7c73","spanId":"fb6312ff","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:43:16.578Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"e1118cff-8703-4221-b32f-6e784d9fe538","spanId":"c9b979e5","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.579Z"}
[32m2026-01-17T15:43:16.580Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.580Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"e2fb3b1b-85b2-4fa9-828e-927bb7c6ec4e","spanId":"03963970","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.580Z"}
[32m2026-01-17T15:43:16.580Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.580Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:43:16.581Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"c1b25465-2c28-4889-b09c-e8adea41df20","spanId":"4ef4addb","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.585Z"}
[32m2026-01-17T15:43:16.586Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.586Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"e2fb3b1b-85b2-4fa9-828e-927bb7c6ec4e","spanId":"03963970","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:43:16.586Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"3906da97-a5ad-48e1-bb2d-f1fa581d15f3","spanId":"26a8b756","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.584Z"}
[32m2026-01-17T15:43:16.585Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.585Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:43:16.581Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:43:16.590Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:43:16.586Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"c1b25465-2c28-4889-b09c-e8adea41df20","spanId":"4ef4addb","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:43:16.593Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"e1118cff-8703-4221-b32f-6e784d9fe538","spanId":"c9b979e5","method":"GET","path":"/api/auth/user","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:43:16.593Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"3906da97-a5ad-48e1-bb2d-f1fa581d15f3","spanId":"26a8b756","method":"GET","path":"/api/documents","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:43:16.592Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"9d1804ca-9034-47ae-9353-53d8ae7033b3","spanId":"49ffc567","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.594Z"}
[32m2026-01-17T15:43:16.595Z [INFO] POST /api/ai/generate {"method":"POST","url":"/api/ai/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.595Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:43:16.595Z [INFO] API route accessed {"path":"/api/ai/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"583ef2da-5869-4a67-89ce-dacc4c3bcf5c","spanId":"0b45a98c","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.596Z"}
[32m2026-01-17T15:43:16.597Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.597Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"9d1804ca-9034-47ae-9353-53d8ae7033b3","spanId":"49ffc567","method":"POST","path":"/api/ai/generate","statusCode":404,"duration":4,"timestamp":"2026-01-17T15:43:16.598Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"ebafb95f-be8b-4c5c-8bf3-256c6b858ea1","spanId":"f99b7195","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.599Z"}
[32m2026-01-17T15:43:16.599Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.599Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"025a4e80-1b7f-466d-9e98-350f9a872c44","spanId":"6247f66d","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.599Z"}
[32m2026-01-17T15:43:16.599Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.599Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:43:16.600Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:43:16.600Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"583ef2da-5869-4a67-89ce-dacc4c3bcf5c","spanId":"0b45a98c","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:43:16.603Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:43:16.600Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"ebafb95f-be8b-4c5c-8bf3-256c6b858ea1","spanId":"f99b7195","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:43:16.603Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"025a4e80-1b7f-466d-9e98-350f9a872c44","spanId":"6247f66d","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:43:16.603Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"62742523-60c6-470c-a869-1d02ebab21b2","spanId":"49a8d487","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.606Z"}
[32m2026-01-17T15:43:16.606Z [INFO] POST /api/ai/analyze {"method":"POST","url":"/api/ai/analyze","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.606Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:43:16.607Z [INFO] API route accessed {"path":"/api/ai/analyze","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"62742523-60c6-470c-a869-1d02ebab21b2","spanId":"49a8d487","method":"POST","path":"/api/ai/analyze","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:43:16.609Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"e309f099-b6b9-4e38-b1fa-2cc0a5b0c1a4","spanId":"b2872147","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.609Z"}
[32m2026-01-17T15:43:16.610Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.610Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"7a54bc93-8d43-4f33-b310-bb0caa2b75c0","spanId":"e4463e1b","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.609Z"}
[32m2026-01-17T15:43:16.610Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.610Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:43:16.611Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"7a54bc93-8d43-4f33-b310-bb0caa2b75c0","spanId":"e4463e1b","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.612Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:43:16.610Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"e309f099-b6b9-4e38-b1fa-2cc0a5b0c1a4","spanId":"b2872147","method":"POST","path":"/export-document","statusCode":200,"duration":5,"timestamp":"2026-01-17T15:43:16.614Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:43:16.614Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.614Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:43:16.615Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"4d16d886-c72b-4a0f-9ad8-f285e73e4bb6","spanId":"7ac2292c","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.622Z"}
[32m2026-01-17T15:43:16.622Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.622Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"9ebdf676-5793-4b68-97e9-9db88164cb1a","spanId":"f4aa6df5","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.622Z"}
[32m2026-01-17T15:43:16.623Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.623Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:43:16.623Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"14ba0387-8e38-44b4-a1e8-c463e187a689","spanId":"de38aca4","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.623Z"}
[32m2026-01-17T15:43:16.623Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.623Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:43:16.623Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"4d16d886-c72b-4a0f-9ad8-f285e73e4bb6","spanId":"7ac2292c","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.625Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"9ebdf676-5793-4b68-97e9-9db88164cb1a","spanId":"f4aa6df5","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T15:43:16.625Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:43:16.624Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"14ba0387-8e38-44b4-a1e8-c463e187a689","spanId":"de38aca4","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.626Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"c129a5f4-ff30-4f5e-81ff-4f04deec825f","spanId":"11dc175f","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.626Z"}
[32m2026-01-17T15:43:16.627Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.627Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"5777bb10-a7ad-4585-84d9-0e6f643e6b73","spanId":"9464c3b2","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.628Z"}
[32m2026-01-17T15:43:16.629Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.629Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"7356eb2d-7d7d-490f-a1e9-f1773f98d0ea","spanId":"9d18aa24","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.629Z"}
[32m2026-01-17T15:43:16.630Z [INFO] POST /api/assess-risk {"method":"POST","url":"/api/assess-risk","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.630Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:43:16.628Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 313[2mms[22m[39m
[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"c129a5f4-ff30-4f5e-81ff-4f04deec825f","spanId":"11dc175f","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:43:16.630Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:43:16.630Z [WARN] Unknown API route accessed {"path":"/api/assess-risk","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:43:16.630Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"7356eb2d-7d7d-490f-a1e9-f1773f98d0ea","spanId":"9d18aa24","method":"POST","path":"/api/assess-risk","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:43:16.631Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"5777bb10-a7ad-4585-84d9-0e6f643e6b73","spanId":"9464c3b2","method":"POST","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.631Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"99216e95-43f8-481b-8ca3-cf64b89eaf25","spanId":"1cea87cc","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.633Z"}
[32m2026-01-17T15:43:16.633Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.633Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"de65321b-af6a-40bb-bf70-2f345567d5a2","spanId":"e3ec22b7","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.635Z"}
[32m2026-01-17T15:43:16.636Z [INFO] POST /api/calculate-compliance-score {"method":"POST","url":"/api/calculate-compliance-score","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.636Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:43:16.634Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"99216e95-43f8-481b-8ca3-cf64b89eaf25","spanId":"1cea87cc","method":"POST","path":"/api/generate-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.635Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:43:16.636Z [WARN] Unknown API route accessed {"path":"/api/calculate-compliance-score","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"de65321b-af6a-40bb-bf70-2f345567d5a2","spanId":"e3ec22b7","method":"POST","path":"/api/calculate-compliance-score","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:43:16.637Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"9a45c0d3-c31c-4588-966f-073594fda3ba","spanId":"be3061f6","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.637Z"}
[32m2026-01-17T15:43:16.637Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.637Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"445a5185-9cad-4f8c-a19f-7b15a19aa475","spanId":"c43682f6","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.637Z"}
[32m2026-01-17T15:43:16.638Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.638Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:43:16.638Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"9a45c0d3-c31c-4588-966f-073594fda3ba","spanId":"be3061f6","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.639Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:43:16.639Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"445a5185-9cad-4f8c-a19f-7b15a19aa475","spanId":"c43682f6","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.640Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"1b05fe4f-fd2d-47ef-b12d-8553153c9d3a","spanId":"c226755b","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.642Z"}
[32m2026-01-17T15:43:16.642Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.642Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"6a73a6d9-aa9c-48ae-9129-6a660bf3c1fa","spanId":"e2886f4b","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.642Z"}
[32m2026-01-17T15:43:16.643Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.643Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:43:16.643Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"1b05fe4f-fd2d-47ef-b12d-8553153c9d3a","spanId":"c226755b","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:43:16.644Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T15:43:16.643Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"6a73a6d9-aa9c-48ae-9129-6a660bf3c1fa","spanId":"e2886f4b","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.645Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"71f6af53-9915-48c0-bc32-edc1db25dd05","spanId":"961bcaf0","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.652Z"}
[32m2026-01-17T15:43:16.652Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.652Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"e971a27c-cb99-4571-ab8b-382d82ea74bc","spanId":"3061549e","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.652Z"}
[32m2026-01-17T15:43:16.652Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.652Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:43:16.652Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:43:16.653Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"71f6af53-9915-48c0-bc32-edc1db25dd05","spanId":"961bcaf0","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.654Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"e971a27c-cb99-4571-ab8b-382d82ea74bc","spanId":"3061549e","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.654Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"dec68100-6104-4f6b-a13f-2af12ac1fb83","spanId":"eb852e3e","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.660Z"}
[32m2026-01-17T15:43:16.661Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.661Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:43:16.661Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"dec68100-6104-4f6b-a13f-2af12ac1fb83","spanId":"eb852e3e","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:43:16.662Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 344[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 76[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 17[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 9[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"e33d769e-63df-48fa-9760-942c5e2a511a","spanId":"fe70ef5e","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.665Z"}
[32m2026-01-17T15:43:16.666Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.666Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"1a35c60b-b22d-4e94-83b2-eb84c2d8fe8e","spanId":"4d6483b0","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.666Z"}
[32m2026-01-17T15:43:16.666Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.666Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"414d6a72-3c1b-4274-ad53-1b4300579021","spanId":"3255df7b","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.668Z"}
[32m2026-01-17T15:43:16.668Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.668Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:43:16.667Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:43:16.667Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"e33d769e-63df-48fa-9760-942c5e2a511a","spanId":"fe70ef5e","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:43:16.669Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"1a35c60b-b22d-4e94-83b2-eb84c2d8fe8e","spanId":"4d6483b0","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":1,"timestamp":"2026-01-17T15:43:16.667Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:43:16.669Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"414d6a72-3c1b-4274-ad53-1b4300579021","spanId":"3255df7b","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.671Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"998e8208-10f1-4d16-97e1-59ac2dff5d45","spanId":"5bc1e78d","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.674Z"}
[32m2026-01-17T15:43:16.675Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.675Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"55d50489-42f1-4059-8261-22b03deb6b47","spanId":"e0c1adfc","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.676Z"}
[32m2026-01-17T15:43:16.676Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.676Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:43:16.676Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:43:16.677Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"998e8208-10f1-4d16-97e1-59ac2dff5d45","spanId":"5bc1e78d","method":"GET","path":"/api/auth/user","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.677Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"55d50489-42f1-4059-8261-22b03deb6b47","spanId":"e0c1adfc","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.678Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"7d0c8d01-5459-4da4-b24d-f51e6664107d","spanId":"b052d7c6","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.679Z"}
[32m2026-01-17T15:43:16.679Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.679Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:43:16.688Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"7d0c8d01-5459-4da4-b24d-f51e6664107d","spanId":"b052d7c6","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:43:16.689Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"0b5247c7-a4b8-4054-aadb-fbf934c52b61","spanId":"032fa89d","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.694Z"}
[32m2026-01-17T15:43:16.695Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.695Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:43:16.695Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"1dd9d44f-16ea-49e8-8956-6a05dd1753eb","spanId":"d83ed9c8","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.696Z"}
[32m2026-01-17T15:43:16.697Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.697Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:43:16.695Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"0b5247c7-a4b8-4054-aadb-fbf934c52b61","spanId":"032fa89d","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.697Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:43:16.698Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"1dd9d44f-16ea-49e8-8956-6a05dd1753eb","spanId":"d83ed9c8","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.699Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"ccbad4d7-1553-422e-96b1-35b7858e4c00","spanId":"6245d14e","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.701Z"}
[32m2026-01-17T15:43:16.702Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.702Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:43:16.702Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"ccbad4d7-1553-422e-96b1-35b7858e4c00","spanId":"6245d14e","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.704Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"9d9cb76c-1670-464a-99f8-0b2b95803dc3","spanId":"47f5abea","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.704Z"}
[32m2026-01-17T15:43:16.704Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.704Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:43:16.705Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"9d9cb76c-1670-464a-99f8-0b2b95803dc3","spanId":"47f5abea","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.706Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"77b9443c-4c65-4233-a479-740f2b07344f","spanId":"ac3818a1","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.709Z"}
[32m2026-01-17T15:43:16.709Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.709Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:43:16.713Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"7ff49102-e9a0-4d31-bbf8-79b0b698cb80","spanId":"bc5e029a","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.714Z"}
[32m2026-01-17T15:43:16.714Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.714Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:43:16.709Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"77b9443c-4c65-4233-a479-740f2b07344f","spanId":"ac3818a1","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:43:16.713Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:43:16.715Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"7ff49102-e9a0-4d31-bbf8-79b0b698cb80","spanId":"bc5e029a","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.716Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 391[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 97[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 24[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 27[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 13[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 14[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 18[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"03182081-3de7-487a-b6ce-bc4db340e593","spanId":"06d922c9","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.717Z"}
[32m2026-01-17T15:43:16.717Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.717Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:43:16.718Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"03182081-3de7-487a-b6ce-bc4db340e593","spanId":"06d922c9","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.719Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"9575c890-0c36-4227-84f5-228f4d6bf79e","spanId":"b6826e16","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.723Z"}
[32m2026-01-17T15:43:16.723Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.723Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"36dcc08b-d97a-4d17-a0b8-7f8731a3ea00","spanId":"52d80bb9","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.724Z"}
[32m2026-01-17T15:43:16.725Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.725Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:43:16.726Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"36dcc08b-d97a-4d17-a0b8-7f8731a3ea00","spanId":"52d80bb9","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:43:16.734Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:43:16.726Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"9575c890-0c36-4227-84f5-228f4d6bf79e","spanId":"b6826e16","method":"POST","path":"/api/save-document","statusCode":401,"duration":12,"timestamp":"2026-01-17T15:43:16.735Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 413[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"3746cff4-5729-4b85-bfa6-1795200ef7a1","spanId":"7103aef4","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.739Z"}
[32m2026-01-17T15:43:16.739Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.739Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:43:16.739Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"3746cff4-5729-4b85-bfa6-1795200ef7a1","spanId":"7103aef4","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.741Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"f8aa9262-0213-4531-8053-28db5e9013ae","spanId":"db86c3f4","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.746Z"}
[32m2026-01-17T15:43:16.746Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.746Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:43:16.747Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"f8aa9262-0213-4531-8053-28db5e9013ae","spanId":"db86c3f4","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.748Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"6dfd6f0f-3a3c-4a03-8ec0-0e98e95b9b5f","spanId":"9b303ef2","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.751Z"}
[32m2026-01-17T15:43:16.752Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.752Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:43:16.752Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"6dfd6f0f-3a3c-4a03-8ec0-0e98e95b9b5f","spanId":"9b303ef2","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:16.753Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"c007e3b2-9714-4965-bc92-884b0f1a66c7","spanId":"5990ed19","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:16.760Z"}
[32m2026-01-17T15:43:16.761Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:16.761Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:43:16.761Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"c007e3b2-9714-4965-bc92-884b0f1a66c7","spanId":"5990ed19","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:16.763Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 427[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 67[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 26[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 9[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 6 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
AssertionError: expected [ 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:57:28
     55|         expect(response.body).toHaveProperty('recommendations');
     56|       } else {
     57|         expect([500, 503]).toContain(response.status);
       |                            ^
     58|       }
     59|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/6]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/6]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/6]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/6]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/6]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/6]Î“Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m6 failed[39m[22m[2m | [22m[1m[32m62 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:43:13
[2m   Duration [22m 16.74s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/middleware/security.ts [22m[39m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:43:46.536Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:43:46.536Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:43:46.538Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:43:46.538Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:43:46.539Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"13b61728-55a6-4a8e-bac6-92c4b0a47bea","spanId":"9db685e8","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.654Z"}
[32m2026-01-17T15:43:46.663Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.663Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"f261cf97-0612-4722-80da-33e390b2a52f","spanId":"48c9bae7","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.668Z"}
[32m2026-01-17T15:43:46.671Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.671Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"b5e41966-7559-48f9-b5ac-f03fc217a2e8","spanId":"6999133c","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.668Z"}
[32m2026-01-17T15:43:46.671Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.671Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:43:46.675Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:43:46.681Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:43:46.682Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"f261cf97-0612-4722-80da-33e390b2a52f","spanId":"48c9bae7","method":"POST","path":"/api/organizations","statusCode":401,"duration":26,"timestamp":"2026-01-17T15:43:46.693Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"13b61728-55a6-4a8e-bac6-92c4b0a47bea","spanId":"9db685e8","method":"GET","path":"/","statusCode":200,"duration":39,"timestamp":"2026-01-17T15:43:46.693Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"b5e41966-7559-48f9-b5ac-f03fc217a2e8","spanId":"6999133c","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":27,"timestamp":"2026-01-17T15:43:46.694Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"ee7aada9-8025-4fb8-9bef-2eedd0c79aab","spanId":"ccafd77b","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.702Z"}
[32m2026-01-17T15:43:46.702Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.702Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:43:46.703Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"ab29347e-10de-4854-92b6-18b8bd62b58b","spanId":"999e70d8","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.704Z"}
[32m2026-01-17T15:43:46.705Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.705Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"ee7aada9-8025-4fb8-9bef-2eedd0c79aab","spanId":"ccafd77b","method":"GET","path":"/api/organizations","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.705Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:43:46.705Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"ab29347e-10de-4854-92b6-18b8bd62b58b","spanId":"999e70d8","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:43:46.708Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"fa8258d6-11cd-4e79-9329-5d0d5f9a4960","spanId":"2d8bde5a","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.709Z"}
[32m2026-01-17T15:43:46.710Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.710Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:43:46.710Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"fa8258d6-11cd-4e79-9329-5d0d5f9a4960","spanId":"2d8bde5a","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.712Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"657d0442-1cc1-4d8b-a21f-eea4dea441c1","spanId":"51fdfefc","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.716Z"}
[32m2026-01-17T15:43:46.716Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.716Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"c00aa97f-6425-4e3f-b990-853b359b2657","spanId":"9d35ec1d","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.718Z"}
[32m2026-01-17T15:43:46.721Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.721Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:43:46.721Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:43:46.721Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"657d0442-1cc1-4d8b-a21f-eea4dea441c1","spanId":"51fdfefc","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:43:46.722Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"c00aa97f-6425-4e3f-b990-853b359b2657","spanId":"9d35ec1d","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:43:46.723Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:43:46.725Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"7825490d-6f52-4128-b9ab-9ecadaf739f4","spanId":"7032c663","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.727Z"}
[32m2026-01-17T15:43:46.728Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.728Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"d792ddc3-948c-4902-a255-477f0edb1c24","spanId":"d233831f","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.729Z"}
[32m2026-01-17T15:43:46.730Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.730Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:43:46.729Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:43:46.731Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"d792ddc3-948c-4902-a255-477f0edb1c24","spanId":"d233831f","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.732Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:43:46.733Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"ca87b8f7-a26a-4e48-8fbe-13c827708bfc","spanId":"4cb3eb0f","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.735Z"}
[32m2026-01-17T15:43:46.735Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.735Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:43:46.736Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"ca87b8f7-a26a-4e48-8fbe-13c827708bfc","spanId":"4cb3eb0f","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:43:46.738Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"7825490d-6f52-4128-b9ab-9ecadaf739f4","spanId":"7032c663","method":"GET","path":"/","statusCode":200,"duration":11,"timestamp":"2026-01-17T15:43:46.738Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"0373a121-0f44-4403-b078-951be80aeeeb","spanId":"8999ec28","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.740Z"}
[32m2026-01-17T15:43:46.740Z [INFO] POST /api/ai/generate {"method":"POST","url":"/api/ai/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.740Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:43:46.741Z [INFO] API route accessed {"path":"/api/ai/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"0373a121-0f44-4403-b078-951be80aeeeb","spanId":"8999ec28","method":"POST","path":"/api/ai/generate","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:43:46.743Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:43:46.745Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.745Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"4e69de98-8f11-4d46-86b6-7ee76d24a625","spanId":"05646567","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.761Z"}
[32m2026-01-17T15:43:46.761Z [INFO] POST /api/ai/analyze {"method":"POST","url":"/api/ai/analyze","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.761Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:43:46.749Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:43:46.761Z [INFO] API route accessed {"path":"/api/ai/analyze","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"4e69de98-8f11-4d46-86b6-7ee76d24a625","spanId":"05646567","method":"POST","path":"/api/ai/analyze","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:43:46.763Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"6a0b163f-9567-4915-90fb-af444177ab98","spanId":"9ea6390c","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.763Z"}
[32m2026-01-17T15:43:46.764Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.764Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:43:46.764Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"6a0b163f-9567-4915-90fb-af444177ab98","spanId":"9ea6390c","method":"GET","path":"/iso-001","statusCode":200,"duration":3,"timestamp":"2026-01-17T15:43:46.766Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:43:46.768Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.768Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"efb4c7c1-571e-46e2-a1c3-7e627372f812","spanId":"72185056","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.769Z"}
[32m2026-01-17T15:43:46.769Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.769Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:43:46.769Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"0a490c47-5095-49c1-ba23-fcf96caa2817","spanId":"a42d6d6b","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.770Z"}
[32m2026-01-17T15:43:46.771Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.771Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:43:46.770Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:43:46.770Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.770Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"efb4c7c1-571e-46e2-a1c3-7e627372f812","spanId":"72185056","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.771Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:43:46.774Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:43:46.772Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"0a490c47-5095-49c1-ba23-fcf96caa2817","spanId":"a42d6d6b","method":"GET","path":"/api/auth/user","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:43:46.778Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"86b0af11-a19c-47ce-ae93-83a7efbe02ee","spanId":"1f9a76fd","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.778Z"}
[32m2026-01-17T15:43:46.779Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.779Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:43:46.780Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"86b0af11-a19c-47ce-ae93-83a7efbe02ee","spanId":"1f9a76fd","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.781Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"cb072d9b-03b0-4996-802d-33c2bba8985e","spanId":"29f281a5","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.781Z"}
[32m2026-01-17T15:43:46.781Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.781Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:43:46.782Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"cb072d9b-03b0-4996-802d-33c2bba8985e","spanId":"29f281a5","method":"POST","path":"/api/evidence","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:43:46.787Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"0b3c4a9f-fd97-41c7-a252-e4d4188d5e7f","spanId":"1c5d8a44","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.788Z"}
[32m2026-01-17T15:43:46.788Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.788Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"1ff24142-1744-4870-a70d-57d3c737dd5a","spanId":"dbfbf726","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.787Z"}
[32m2026-01-17T15:43:46.788Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.788Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:43:46.789Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"d842b372-13fb-4c83-8297-e5489c1d3b03","spanId":"83799340","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.791Z"}
[32m2026-01-17T15:43:46.792Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.792Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"1ff24142-1744-4870-a70d-57d3c737dd5a","spanId":"dbfbf726","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:43:46.791Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:43:46.789Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"0b3c4a9f-fd97-41c7-a252-e4d4188d5e7f","spanId":"1c5d8a44","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:43:46.795Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"6f1af41b-7dd9-4958-acdc-3b8cf8b23e49","spanId":"c7e98e6e","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.794Z"}
[32m2026-01-17T15:43:46.795Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.795Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"77e3c3c7-23d2-468a-9624-0d84f7247a4e","spanId":"5ddaf62e","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.794Z"}
[32m2026-01-17T15:43:46.795Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.795Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:43:46.795Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:43:46.795Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"6f1af41b-7dd9-4958-acdc-3b8cf8b23e49","spanId":"c7e98e6e","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.796Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"77e3c3c7-23d2-468a-9624-0d84f7247a4e","spanId":"5ddaf62e","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.797Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:43:46.792Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"d842b372-13fb-4c83-8297-e5489c1d3b03","spanId":"83799340","method":"GET","path":"/api/auth/user","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:43:46.799Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"f02b8948-84e6-4996-8781-f3a6b38c2f82","spanId":"29362430","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.802Z"}
[32m2026-01-17T15:43:46.802Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.802Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"b374a924-6617-46fb-ad42-a849b839b47f","spanId":"e6499066","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.802Z"}
[32m2026-01-17T15:43:46.802Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.802Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"72d5cf01-8984-40ce-a188-1067e1bcfcf5","spanId":"d4d702a7","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.802Z"}
[32m2026-01-17T15:43:46.802Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.802Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:43:46.803Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"f02b8948-84e6-4996-8781-f3a6b38c2f82","spanId":"29362430","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.804Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:43:46.803Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:43:46.803Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"72d5cf01-8984-40ce-a188-1067e1bcfcf5","spanId":"d4d702a7","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.805Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"b374a924-6617-46fb-ad42-a849b839b47f","spanId":"e6499066","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.805Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"5e611705-1fe3-4a1a-ba6e-a852ff90452c","spanId":"2b813de3","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.805Z"}
[32m2026-01-17T15:43:46.806Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.806Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:43:46.807Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"5e611705-1fe3-4a1a-ba6e-a852ff90452c","spanId":"2b813de3","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:43:46.810Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"4c10d946-5815-4255-a279-a258687035c8","spanId":"3c9f54e8","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.809Z"}
[32m2026-01-17T15:43:46.810Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.810Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"71f829e2-466e-4446-9ce0-008aee796c51","spanId":"90579311","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.809Z"}
[32m2026-01-17T15:43:46.810Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.810Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"e0f12b1e-e770-45e8-b913-5d00bb200c9b","spanId":"7752ed6b","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.810Z"}
[32m2026-01-17T15:43:46.811Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.811Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:43:46.810Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"fe0502fe-5b0d-4fca-925f-cec7f0dd9ba9","spanId":"1565c44e","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.811Z"}
[32m2026-01-17T15:43:46.812Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.812Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:43:46.811Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:43:46.811Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"4c10d946-5815-4255-a279-a258687035c8","spanId":"3c9f54e8","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.812Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:43:46.813Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"71f829e2-466e-4446-9ce0-008aee796c51","spanId":"90579311","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:43:46.817Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"e0f12b1e-e770-45e8-b913-5d00bb200c9b","spanId":"7752ed6b","method":"POST","path":"/export-document","statusCode":200,"duration":7,"timestamp":"2026-01-17T15:43:46.817Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"fe0502fe-5b0d-4fca-925f-cec7f0dd9ba9","spanId":"1565c44e","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:43:46.818Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"98aef4ad-0094-49c6-b20b-123f07e01889","spanId":"430a9b9a","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.818Z"}
[32m2026-01-17T15:43:46.819Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.819Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"57725f57-9564-4ed2-be99-cb5fff751283","spanId":"f9a6a6f5","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.818Z"}
[32m2026-01-17T15:43:46.819Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.819Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:43:46.819Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:43:46.819Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"98aef4ad-0094-49c6-b20b-123f07e01889","spanId":"430a9b9a","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.820Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"57725f57-9564-4ed2-be99-cb5fff751283","spanId":"f9a6a6f5","method":"GET","path":"/api/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.821Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"8a0ace2f-2a0f-4fee-8f3e-7d6471714ac7","spanId":"e8fcea69","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.834Z"}
[32m2026-01-17T15:43:46.834Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.834Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:43:46.835Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"372b5e8e-f86f-4d2e-8d70-f1b11c4403f2","spanId":"8eacc8f7","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.836Z"}
[32m2026-01-17T15:43:46.836Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.836Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"3366aaa9-e919-4531-8e89-4492cc8529ef","spanId":"3fd62373","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.836Z"}
[32m2026-01-17T15:43:46.836Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.836Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"8a0ace2f-2a0f-4fee-8f3e-7d6471714ac7","spanId":"e8fcea69","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T15:43:46.837Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:43:46.837Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:43:46.837Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"bc5b928a-3d7e-4ce3-9458-983f48eaa4ef","spanId":"7cea23a1","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.838Z"}
[32m2026-01-17T15:43:46.838Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.838Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"3366aaa9-e919-4531-8e89-4492cc8529ef","spanId":"3fd62373","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.838Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"372b5e8e-f86f-4d2e-8d70-f1b11c4403f2","spanId":"8eacc8f7","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.838Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:43:46.839Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"bc5b928a-3d7e-4ce3-9458-983f48eaa4ef","spanId":"7cea23a1","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.840Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"d0b8adfa-9205-4474-add8-3888687deff5","spanId":"265742a4","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.842Z"}
[32m2026-01-17T15:43:46.842Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.842Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:43:46.843Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"d0b8adfa-9205-4474-add8-3888687deff5","spanId":"265742a4","method":"POST","path":"/api/generate-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.844Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"566daa0e-96a3-4514-a546-0f9b2efb3425","spanId":"609e22e1","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.844Z"}
[32m2026-01-17T15:43:46.844Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.844Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"73a5fd07-6f22-44a3-b008-7dbe055335eb","spanId":"ef279460","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.844Z"}
[32m2026-01-17T15:43:46.845Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.844Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"9c51175f-8731-4f0c-bec6-c870de60754c","spanId":"c9ed2dfe","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.846Z"}
[32m2026-01-17T15:43:46.847Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.847Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:43:46.845Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:43:46.846Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"566daa0e-96a3-4514-a546-0f9b2efb3425","spanId":"609e22e1","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.847Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"73a5fd07-6f22-44a3-b008-7dbe055335eb","spanId":"ef279460","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.848Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:43:46.847Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"9c51175f-8731-4f0c-bec6-c870de60754c","spanId":"c9ed2dfe","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.848Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"7790d543-6fb0-416d-86cb-ba13ffc27b6d","spanId":"6e291866","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.851Z"}
[32m2026-01-17T15:43:46.852Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.852Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"89c90b0d-5024-44e6-a78b-32d8b5845485","spanId":"770be8e2","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.852Z"}
[32m2026-01-17T15:43:46.852Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.852Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"05659ab4-99d8-4df8-8fda-caca0d25352b","spanId":"99188dbf","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.852Z"}
[32m2026-01-17T15:43:46.853Z [INFO] POST /api/assess-risk {"method":"POST","url":"/api/assess-risk","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.853Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:43:46.853Z [WARN] Unknown API route accessed {"path":"/api/assess-risk","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T15:43:46.853Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:43:46.853Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"05659ab4-99d8-4df8-8fda-caca0d25352b","spanId":"99188dbf","method":"POST","path":"/api/assess-risk","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:43:46.854Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"28dd58f9-fef9-43ef-a751-e03dfe0d05dd","spanId":"c600a8f2","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.854Z"}
[32m2026-01-17T15:43:46.855Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.855Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"7790d543-6fb0-416d-86cb-ba13ffc27b6d","spanId":"6e291866","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:43:46.855Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"89c90b0d-5024-44e6-a78b-32d8b5845485","spanId":"770be8e2","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.855Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"972b761f-ef38-4cd7-91ad-60ca03398a08","spanId":"3a01fdf0","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.855Z"}
[32m2026-01-17T15:43:46.856Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.856Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:43:46.856Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:43:46.855Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"972b761f-ef38-4cd7-91ad-60ca03398a08","spanId":"3a01fdf0","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:43:46.857Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"28dd58f9-fef9-43ef-a751-e03dfe0d05dd","spanId":"c600a8f2","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.857Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"a30f0476-c18f-4b23-9b21-4e273b2d550c","spanId":"b46ab95a","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.859Z"}
[32m2026-01-17T15:43:46.859Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.859Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"56895f61-008e-4b41-923a-e5c0b154f16a","spanId":"a4aaa89d","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.859Z"}
[32m2026-01-17T15:43:46.859Z [INFO] POST /api/calculate-compliance-score {"method":"POST","url":"/api/calculate-compliance-score","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.859Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:43:46.859Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"17bd7eea-ccf5-4248-8598-821280e28b33","spanId":"2ab768ed","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.860Z"}
[32m2026-01-17T15:43:46.860Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.860Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:43:46.860Z [WARN] Unknown API route accessed {"path":"/api/calculate-compliance-score","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 374[2mms[22m[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"56895f61-008e-4b41-923a-e5c0b154f16a","spanId":"a4aaa89d","method":"POST","path":"/api/calculate-compliance-score","statusCode":404,"duration":1,"timestamp":"2026-01-17T15:43:46.860Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"a30f0476-c18f-4b23-9b21-4e273b2d550c","spanId":"b46ab95a","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.861Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:43:46.861Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"17bd7eea-ccf5-4248-8598-821280e28b33","spanId":"2ab768ed","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:43:46.868Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"a75d1757-4c0f-40c9-87fd-100bc6909d0d","spanId":"ee50aef6","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.870Z"}
[32m2026-01-17T15:43:46.870Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.870Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:43:46.871Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"4ad09c7f-0502-4a26-a5f2-8718b1f245d7","spanId":"73351f18","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.870Z"}
[32m2026-01-17T15:43:46.871Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.871Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"36003f06-fc9a-4183-b138-db861dd936a3","spanId":"7b9de506","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.871Z"}
[32m2026-01-17T15:43:46.872Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.872Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"a75d1757-4c0f-40c9-87fd-100bc6909d0d","spanId":"ee50aef6","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:43:46.872Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:43:46.872Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"4ad09c7f-0502-4a26-a5f2-8718b1f245d7","spanId":"73351f18","method":"GET","path":"/api/auth/user","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.873Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:43:46.872Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"36003f06-fc9a-4183-b138-db861dd936a3","spanId":"7b9de506","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.874Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"ee8c6e77-4593-4b24-9b79-7e1486cd7c04","spanId":"fbd0a2f6","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.876Z"}
[32m2026-01-17T15:43:46.876Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.876Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"68f8f7d3-283c-44c0-aa41-5cd894e2db5c","spanId":"66e64825","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.877Z"}
[32m2026-01-17T15:43:46.877Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.877Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:43:46.876Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:43:46.877Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"ee8c6e77-4593-4b24-9b79-7e1486cd7c04","spanId":"fbd0a2f6","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:43:46.878Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"68f8f7d3-283c-44c0-aa41-5cd894e2db5c","spanId":"66e64825","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.878Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 390[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 63[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[39m[32m 18[2mms[22m[39m
[31m     Î“Ã¥Ã† expected [ 500, 503 ] to include 401[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 35[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 21[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[32m 5[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"a39b3931-ebb3-4cf8-808c-93054ce87948","spanId":"9f80c664","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.881Z"}
[32m2026-01-17T15:43:46.882Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.882Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:43:46.882Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"1b1fce6f-06bd-49f2-a03a-75f3d161a7f1","spanId":"5d15f9d2","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.882Z"}
[32m2026-01-17T15:43:46.882Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.882Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:43:46.882Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"a39b3931-ebb3-4cf8-808c-93054ce87948","spanId":"9f80c664","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.883Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:43:46.882Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"1b1fce6f-06bd-49f2-a03a-75f3d161a7f1","spanId":"5d15f9d2","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:43:46.884Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"40a74d64-7af9-4c2c-9f7f-6c9c9ae0d1e2","spanId":"0b22a0fb","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.886Z"}
[32m2026-01-17T15:43:46.887Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.887Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:43:46.887Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"40a74d64-7af9-4c2c-9f7f-6c9c9ae0d1e2","spanId":"0b22a0fb","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.888Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"552294fe-ec37-4a72-aa2a-e66bb9f78562","spanId":"fccec08c","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.889Z"}
[32m2026-01-17T15:43:46.889Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.889Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:43:46.890Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"552294fe-ec37-4a72-aa2a-e66bb9f78562","spanId":"fccec08c","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:43:46.899Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"89aeb00a-9dad-4216-8027-2890e8c73e3e","spanId":"09cfac73","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.899Z"}
[32m2026-01-17T15:43:46.900Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.900Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:43:46.900Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"7af152a1-08f0-40a7-9112-c51a585e75fc","spanId":"24dba0df","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.902Z"}
[32m2026-01-17T15:43:46.902Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.902Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:43:46.900Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:43:46.903Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:43:46.907Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"89aeb00a-9dad-4216-8027-2890e8c73e3e","spanId":"09cfac73","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.901Z"}


[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"7af152a1-08f0-40a7-9112-c51a585e75fc","spanId":"24dba0df","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.904Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"f4312dfe-73ca-481b-a68a-6890b5fdee98","spanId":"a62921b7","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.905Z"}
[32m2026-01-17T15:43:46.905Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.905Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"00a5cf34-5f34-45ec-bb31-a7186349097e","spanId":"ebfca1c9","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:43:46.907Z"}
[32m2026-01-17T15:43:46.907Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:43:46.907Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:43:46.906Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"f4312dfe-73ca-481b-a68a-6890b5fdee98","spanId":"a62921b7","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.907Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"00a5cf34-5f34-45ec-bb31-a7186349097e","spanId":"ebfca1c9","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:43:46.909Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 415[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 97[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 28[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 22[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 15[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 15[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 418[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 68[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 19[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 5[2mms[22m[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 419[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 6 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
AssertionError: expected [ 500, 503 ] to include 401
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:57:28
     55|         expect(response.body).toHaveProperty('recommendations');
     56|       } else {
     57|         expect([500, 503]).toContain(response.status);
       |                            ^
     58|       }
     59|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/6]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/6]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/6]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/6]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/6]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/6]Î“Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m6 failed[39m[22m[2m | [22m[1m[32m62 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:43:43
[2m   Duration [22m 16.50s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/integration/gap-analysis.test.ts [22m[34mx14 [34m[39m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 418[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 68[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 19[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 5[2mms[22m[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 415[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 97[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 28[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 22[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 15[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 15[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:46:27.819Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"09d38513-d120-4977-bf82-06535071f9f4","spanId":"3b5fe61b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.905Z"}
[32m2026-01-17T15:46:27.907Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.907Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:46:27.914Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"09d38513-d120-4977-bf82-06535071f9f4","spanId":"3b5fe61b","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:46:27.919Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"2c7b454d-69f7-4515-af92-e4e1f9d14304","spanId":"0c686bf1","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.936Z"}
[32m2026-01-17T15:46:27.937Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.937Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:46:27.938Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"2c7b454d-69f7-4515-af92-e4e1f9d14304","spanId":"0c686bf1","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:46:27.939Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"4ba82505-cf52-4fe4-a8df-d7a7af33d0ab","spanId":"6f014292","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.943Z"}
[32m2026-01-17T15:46:27.944Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.944Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:46:27.944Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"4ba82505-cf52-4fe4-a8df-d7a7af33d0ab","spanId":"6f014292","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:46:27.945Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"a9ccca07-f424-4bb7-a75e-335f470a5407","spanId":"be37eead","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.949Z"}
[32m2026-01-17T15:46:27.949Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.949Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:46:27.949Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"a9ccca07-f424-4bb7-a75e-335f470a5407","spanId":"be37eead","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:46:27.950Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"9708b6f8-006e-4d46-95d4-238b09b547c7","spanId":"b2446b37","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.954Z"}
[32m2026-01-17T15:46:27.954Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.954Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:46:27.954Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"9708b6f8-006e-4d46-95d4-238b09b547c7","spanId":"b2446b37","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:46:27.955Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"b1c15824-614d-4cbe-a217-8be79d57338c","spanId":"f8f10f7d","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.963Z"}
[32m2026-01-17T15:46:27.963Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.963Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:46:27.964Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"b1c15824-614d-4cbe-a217-8be79d57338c","spanId":"f8f10f7d","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:46:27.965Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"df941907-e139-4b38-a7b9-d3abc2af4e9d","spanId":"30cf5464","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.969Z"}
[32m2026-01-17T15:46:27.969Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.969Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:46:27.970Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"df941907-e139-4b38-a7b9-d3abc2af4e9d","spanId":"30cf5464","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:46:27.971Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"18f87c77-1200-4067-9416-0b5d6e74cd38","spanId":"435b4216","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.975Z"}
[32m2026-01-17T15:46:27.975Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.975Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:46:27.976Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"18f87c77-1200-4067-9416-0b5d6e74cd38","spanId":"435b4216","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:46:27.984Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"05c3e501-e6da-4aca-84c2-946a0410f974","spanId":"0c6ecae4","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.989Z"}
[32m2026-01-17T15:46:27.989Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.989Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:46:27.990Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"05c3e501-e6da-4aca-84c2-946a0410f974","spanId":"0c6ecae4","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:46:27.992Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"117eb45d-595d-40bc-967b-099a87b9f002","spanId":"cc7d435d","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:27.996Z"}
[32m2026-01-17T15:46:27.997Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:27.997Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:46:27.997Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"117eb45d-595d-40bc-967b-099a87b9f002","spanId":"cc7d435d","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:46:27.998Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"276d0a84-6705-4d58-982b-68a5542b7a02","spanId":"6f9560d0","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:28.002Z"}
[32m2026-01-17T15:46:28.003Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:28.003Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:46:28.003Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"276d0a84-6705-4d58-982b-68a5542b7a02","spanId":"6f9560d0","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:46:28.005Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"76268e05-aa29-4e3e-a4e5-ef1bf1603e67","spanId":"73f41cd9","method":"POST","path":"/api/assess-risk","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:28.014Z"}
[32m2026-01-17T15:46:28.014Z [INFO] POST /api/assess-risk {"method":"POST","url":"/api/assess-risk","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:28.014Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:46:28.014Z [WARN] Unknown API route accessed {"path":"/api/assess-risk","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"76268e05-aa29-4e3e-a4e5-ef1bf1603e67","spanId":"73f41cd9","method":"POST","path":"/api/assess-risk","statusCode":404,"duration":1,"timestamp":"2026-01-17T15:46:28.015Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"b5a76868-c535-4f14-b4cf-6b23165390c6","spanId":"30fd1e38","method":"POST","path":"/api/calculate-compliance-score","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:28.024Z"}
[32m2026-01-17T15:46:28.024Z [INFO] POST /api/calculate-compliance-score {"method":"POST","url":"/api/calculate-compliance-score","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:28.024Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:46:28.024Z [WARN] Unknown API route accessed {"path":"/api/calculate-compliance-score","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"b5a76868-c535-4f14-b4cf-6b23165390c6","spanId":"30fd1e38","method":"POST","path":"/api/calculate-compliance-score","statusCode":404,"duration":1,"timestamp":"2026-01-17T15:46:28.025Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"b51cfa2a-65e4-4f16-9ea2-0a64e74078fa","spanId":"8f37b242","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:28.029Z"}
[32m2026-01-17T15:46:28.029Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:28.029Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:46:28.029Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"b51cfa2a-65e4-4f16-9ea2-0a64e74078fa","spanId":"8f37b242","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:46:28.031Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"05ce3adf-8cac-4d59-8ae4-eaca46298a51","spanId":"65ca001b","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:46:28.035Z"}
[32m2026-01-17T15:46:28.035Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:46:28.035Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:46:28.035Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"05ce3adf-8cac-4d59-8ae4-eaca46298a51","spanId":"65ca001b","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":1,"timestamp":"2026-01-17T15:46:28.036Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 267[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 53[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[39m[32m 5[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[32m 5[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 3 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:136:31
    134|         });
    135| 
    136|       expect(response.status).toBe(401);
       |                               ^
    137|     });
    138|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/3]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:156:31
    154|         });
    155| 
    156|       expect(response.status).toBe(401);
       |                               ^
    157|     });
    158|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/3]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:182:31
    180|         .get('/api/frameworks/SOC2/controls');
    181| 
    182|       expect(response.status).toBe(401);
       |                               ^
    183|     });
    184|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/3]Î“Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[90m (3)[39m
[2m      Tests [22m [1m[31m8 failed[39m[22m[2m | [22m[1m[32m40 passed[39m[22m[90m (48)[39m
[2m   Start at [22m 07:46:25
[2m   Duration [22m 2.04s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/integration/gap-analysis.test.ts [22m[34mx15 [34m[39m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 418[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 68[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 19[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 5[2mms[22m[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 415[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 97[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 28[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 26[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 22[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 15[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 15[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:47:43.480Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"2ec277fa-f2f8-4596-aaf3-f38a4925f749","spanId":"7437308a","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.555Z"}
[32m2026-01-17T15:47:43.558Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.558Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:47:43.564Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"2ec277fa-f2f8-4596-aaf3-f38a4925f749","spanId":"7437308a","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":18,"timestamp":"2026-01-17T15:47:43.573Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"1399cf05-b500-4368-a58c-977a1d258bc3","spanId":"94692052","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.581Z"}
[32m2026-01-17T15:47:43.582Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.582Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:47:43.582Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"1399cf05-b500-4368-a58c-977a1d258bc3","spanId":"94692052","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:47:43.589Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"85383469-541a-4ab3-b925-91dd6bba75cd","spanId":"4b0f81e8","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.594Z"}
[32m2026-01-17T15:47:43.594Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.594Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:47:43.595Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"85383469-541a-4ab3-b925-91dd6bba75cd","spanId":"4b0f81e8","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:47:43.596Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"50e60a95-6a81-4dd0-84ae-42f42b720634","spanId":"6b654b9a","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.600Z"}
[32m2026-01-17T15:47:43.600Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.600Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:47:43.600Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"50e60a95-6a81-4dd0-84ae-42f42b720634","spanId":"6b654b9a","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:47:43.601Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"2a67be29-d273-4b61-9020-08b7d9014deb","spanId":"bd5bad26","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.605Z"}
[32m2026-01-17T15:47:43.605Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.605Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:47:43.606Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"2a67be29-d273-4b61-9020-08b7d9014deb","spanId":"bd5bad26","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:47:43.606Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"2e0bc6ac-9c28-4aea-ba6f-7841ba2fdaa4","spanId":"1c30929a","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.610Z"}
[32m2026-01-17T15:47:43.610Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.610Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:47:43.610Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"2e0bc6ac-9c28-4aea-ba6f-7841ba2fdaa4","spanId":"1c30929a","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:47:43.611Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"8391ceaf-e34d-4230-9dd9-0afca803c308","spanId":"553863a2","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.614Z"}
[32m2026-01-17T15:47:43.614Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.614Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:47:43.614Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"8391ceaf-e34d-4230-9dd9-0afca803c308","spanId":"553863a2","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:47:43.615Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"c81a3cd2-d38a-4b53-b5f7-5778d3de9498","spanId":"89e57b2b","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.618Z"}
[32m2026-01-17T15:47:43.618Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.618Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:47:43.618Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"c81a3cd2-d38a-4b53-b5f7-5778d3de9498","spanId":"89e57b2b","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:47:43.619Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"c2fe2ec9-28eb-41b2-b49a-5337fcc37e3b","spanId":"5aa34197","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.623Z"}
[32m2026-01-17T15:47:43.623Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.623Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:47:43.624Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"c2fe2ec9-28eb-41b2-b49a-5337fcc37e3b","spanId":"5aa34197","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:47:43.625Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"4a89dc02-de93-40e0-b1a2-1fb30eefa636","spanId":"7263e5a5","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.629Z"}
[32m2026-01-17T15:47:43.630Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.630Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:47:43.630Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"4a89dc02-de93-40e0-b1a2-1fb30eefa636","spanId":"7263e5a5","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:47:43.631Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"697d5453-611d-47eb-8bb2-aeb6571f9a6f","spanId":"a9403866","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.634Z"}
[32m2026-01-17T15:47:43.634Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.634Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:47:43.634Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"697d5453-611d-47eb-8bb2-aeb6571f9a6f","spanId":"a9403866","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:47:43.635Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"c2b453f7-5152-4207-ac8f-ddb3b78191ba","spanId":"edc34104","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.638Z"}
[32m2026-01-17T15:47:43.638Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.638Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:47:43.638Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"c2b453f7-5152-4207-ac8f-ddb3b78191ba","spanId":"edc34104","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:47:43.639Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"f943ef90-89fe-4c79-a44e-f5879ead2128","spanId":"e840d304","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.642Z"}
[32m2026-01-17T15:47:43.642Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.642Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:47:43.642Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"f943ef90-89fe-4c79-a44e-f5879ead2128","spanId":"e840d304","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:47:43.643Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"1d442aff-c07a-417d-bd3c-6659633ce4ab","spanId":"32049e66","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.646Z"}
[32m2026-01-17T15:47:43.646Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.646Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:47:43.646Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"1d442aff-c07a-417d-bd3c-6659633ce4ab","spanId":"32049e66","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":1,"timestamp":"2026-01-17T15:47:43.647Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"834d7e45-6bd6-4a86-92d7-2074cf2ab4ac","spanId":"3141380c","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:47:43.653Z"}
[32m2026-01-17T15:47:43.653Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:47:43.653Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:47:43.653Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"834d7e45-6bd6-4a86-92d7-2074cf2ab4ac","spanId":"3141380c","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":1,"timestamp":"2026-01-17T15:47:43.654Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 205[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 45[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 5[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 4[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 4[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 7[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[39m[32m 4[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 2 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:170:31
    168|         });
    169| 
    170|       expect(response.status).toBe(401);
       |                               ^
    171|     });
    172|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/2]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:179:31
    177|         .get('/api/frameworks/SOC2/controls');
    178| 
    179|       expect(response.status).toBe(401);
       |                               ^
    180|     });
    181|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/2]Î“Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[90m (3)[39m
[2m      Tests [22m [1m[31m7 failed[39m[22m[2m | [22m[1m[32m41 passed[39m[22m[90m (48)[39m
[2m   Start at [22m 07:47:41
[2m   Duration [22m 1.79s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m


Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Suites 5 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts [ tests/integration/documents.test.ts ]
 FAIL   unit  tests/integration/gap-analysis.test.ts [ tests/integration/gap-analysis.test.ts ]
 FAIL   unit  tests/integration/e2e-flows.test.ts [ tests/integration/e2e-flows.test.ts ]
 FAIL   unit  tests/integration/api.test.ts [ tests/integration/api.test.ts ]
 FAIL   unit  tests/integration/auth.test.ts [ tests/integration/auth.test.ts ]
Error: Transform failed with 1 error:
C:/software/cyberdocgen/server/routes.ts:521:8: ERROR: The symbol "organizationsRouter" has already been declared
  Plugin: vite:esbuild
  File: C:/software/cyberdocgen/server/routes.ts:521:8
  
  The symbol "organizationsRouter" has already been declared
  519|    app.use('/api/organizations', organizationsRouter);
  520|  
  521|    const organizationsRouter = Router();
     |          ^
  522|    registerOrganizationsRoutes(organizationsRouter);
  523|    app.use('/api/organizations', organizationsRouter);
  
 Î“Â¥Â» failureErrorWithLog node_modules/esbuild/lib/main.js:1467:15
 Î“Â¥Â» node_modules/esbuild/lib/main.js:736:50
 Î“Â¥Â» responseCallbacks.<computed> node_modules/esbuild/lib/main.js:603:9
 Î“Â¥Â» handleIncomingPacket node_modules/esbuild/lib/main.js:658:12
 Î“Â¥Â» Socket.readFromStdout node_modules/esbuild/lib/main.js:581:7

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/5]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [2mno tests[22m
[2m   Start at [22m 07:51:08
[2m   Duration [22m 1.92s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:51:20.268Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:51:20.373Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:51:20.396Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"7b47a664-d626-4abc-9fc5-6bad2fbf1c7d","spanId":"4f64ae7c","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.407Z"}
[32m2026-01-17T15:51:20.423Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.423Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:51:20.423Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:51:20.440Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"7b47a664-d626-4abc-9fc5-6bad2fbf1c7d","spanId":"4f64ae7c","method":"POST","path":"/api/organizations","statusCode":401,"duration":43,"timestamp":"2026-01-17T15:51:20.450Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"a3a3114d-6499-4c72-b126-cc9ded426ce1","spanId":"099ce0f2","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.461Z"}
[32m2026-01-17T15:51:20.463Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.463Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:51:20.464Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"a3a3114d-6499-4c72-b126-cc9ded426ce1","spanId":"099ce0f2","method":"GET","path":"/api/organizations","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:51:20.467Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"7e656251-a87e-452e-bf4a-0fe552bbe78d","spanId":"84ce6398","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.467Z"}
[32m2026-01-17T15:51:20.470Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.470Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"9f4ad091-20b2-4361-9480-bc8d35988e0d","spanId":"a6237264","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.475Z"}
[32m2026-01-17T15:51:20.476Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.476Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:51:20.477Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"9f4ad091-20b2-4361-9480-bc8d35988e0d","spanId":"a6237264","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:51:20.479Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:51:20.481Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"6cc79eee-5a66-4515-9d23-0ea6b77bd0f9","spanId":"89df63cb","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.484Z"}
[32m2026-01-17T15:51:20.485Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.485Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:51:20.485Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"6cc79eee-5a66-4515-9d23-0ea6b77bd0f9","spanId":"89df63cb","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.487Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"2cc174ac-f0cb-4fdc-bee9-5dae1fa17b46","spanId":"b48e85c0","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.494Z"}
[32m2026-01-17T15:51:20.494Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.494Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:51:20.495Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"2cc174ac-f0cb-4fdc-bee9-5dae1fa17b46","spanId":"b48e85c0","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.497Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:51:20.495Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"7e656251-a87e-452e-bf4a-0fe552bbe78d","spanId":"84ce6398","method":"GET","path":"/","statusCode":200,"duration":29,"timestamp":"2026-01-17T15:51:20.496Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"a91684b7-fb65-45d3-8ab2-de87e32a6004","spanId":"34fc4c00","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.504Z"}
[32m2026-01-17T15:51:20.504Z [INFO] POST /api/ai/generate {"method":"POST","url":"/api/ai/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.504Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:51:20.505Z [INFO] API route accessed {"path":"/api/ai/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"a91684b7-fb65-45d3-8ab2-de87e32a6004","spanId":"34fc4c00","method":"POST","path":"/api/ai/generate","statusCode":404,"duration":10,"timestamp":"2026-01-17T15:51:20.514Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"be91c0d8-0df7-474b-8670-bffab2175828","spanId":"c4229f2b","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.520Z"}
[32m2026-01-17T15:51:20.520Z [INFO] POST /api/ai/analyze {"method":"POST","url":"/api/ai/analyze","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.520Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:51:20.521Z [INFO] API route accessed {"path":"/api/ai/analyze","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"1aedd729-3fa1-4b1b-bd41-31c33c2d8d91","spanId":"d83c29a5","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.528Z"}
[32m2026-01-17T15:51:20.530Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.530Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:51:20.531Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"1aedd729-3fa1-4b1b-bd41-31c33c2d8d91","spanId":"d83c29a5","method":"GET","path":"/","statusCode":200,"duration":12,"timestamp":"2026-01-17T15:51:20.540Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"be91c0d8-0df7-474b-8670-bffab2175828","spanId":"c4229f2b","method":"POST","path":"/api/ai/analyze","statusCode":404,"duration":30,"timestamp":"2026-01-17T15:51:20.550Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"ad2c1827-fa67-4533-a3de-d7e09dbaee05","spanId":"32cf74eb","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.555Z"}
[32m2026-01-17T15:51:20.556Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.556Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:51:20.557Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"ad2c1827-fa67-4533-a3de-d7e09dbaee05","spanId":"32cf74eb","method":"GET","path":"/iso-001","statusCode":200,"duration":4,"timestamp":"2026-01-17T15:51:20.559Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:51:20.559Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.559Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:51:20.560Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"c482dee9-331a-4b1d-a496-88311f52b61a","spanId":"2b37caa4","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.569Z"}
[32m2026-01-17T15:51:20.569Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.569Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:51:20.570Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"c482dee9-331a-4b1d-a496-88311f52b61a","spanId":"2b37caa4","method":"POST","path":"/api/evidence","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.571Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"cb44309f-b337-4681-9a96-762f8d91cc1b","spanId":"0c57dcb0","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.578Z"}
[32m2026-01-17T15:51:20.578Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.578Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:51:20.579Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"cb44309f-b337-4681-9a96-762f8d91cc1b","spanId":"0c57dcb0","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.581Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"08efb490-0f33-415b-8333-750cdc683997","spanId":"2b0d7e6f","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.584Z"}
[32m2026-01-17T15:51:20.585Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.585Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"e0287477-67b7-4744-b1a7-3a8a2cede3a4","spanId":"3c1c72a0","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.586Z"}
[32m2026-01-17T15:51:20.587Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.587Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:51:20.587Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"e0287477-67b7-4744-b1a7-3a8a2cede3a4","spanId":"3c1c72a0","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.589Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:51:20.585Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"08efb490-0f33-415b-8333-750cdc683997","spanId":"2b0d7e6f","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:51:20.591Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"cdae1d8d-ecba-4a45-b022-82a11af5bbb4","spanId":"9229b854","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.595Z"}
[32m2026-01-17T15:51:20.595Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.595Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:51:20.596Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"cdae1d8d-ecba-4a45-b022-82a11af5bbb4","spanId":"9229b854","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.598Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"47baa175-7f57-4413-9fde-6bfaf6110335","spanId":"b8bc915f","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.597Z"}
[32m2026-01-17T15:51:20.598Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.598Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:51:20.598Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"47baa175-7f57-4413-9fde-6bfaf6110335","spanId":"b8bc915f","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.600Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"41ffa118-e593-4fc6-93f2-214da6bd2758","spanId":"f24c46fe","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.603Z"}
[32m2026-01-17T15:51:20.604Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.604Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:51:20.604Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"41ffa118-e593-4fc6-93f2-214da6bd2758","spanId":"f24c46fe","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.606Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"4a6cd288-644c-495c-ab64-dfa44e7fda1a","spanId":"c52e0d57","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.609Z"}
[32m2026-01-17T15:51:20.610Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.610Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"ee028e9a-51ed-4b8a-a1d6-c18f653ed3b3","spanId":"f52ca4a9","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.611Z"}
[32m2026-01-17T15:51:20.611Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.611Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:51:20.612Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"ee028e9a-51ed-4b8a-a1d6-c18f653ed3b3","spanId":"f52ca4a9","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.613Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:51:20.611Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"4a6cd288-644c-495c-ab64-dfa44e7fda1a","spanId":"c52e0d57","method":"POST","path":"/export-document","statusCode":200,"duration":5,"timestamp":"2026-01-17T15:51:20.614Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"53d74398-0fe0-48dc-833e-03d3c79ea3cb","spanId":"0fe12b7b","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.618Z"}
[32m2026-01-17T15:51:20.618Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.618Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:51:20.619Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"9fac9940-656b-4a34-8517-2018957584c2","spanId":"853c66c5","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.619Z"}
[32m2026-01-17T15:51:20.619Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.619Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"53d74398-0fe0-48dc-833e-03d3c79ea3cb","spanId":"0fe12b7b","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.620Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:51:20.620Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"9fac9940-656b-4a34-8517-2018957584c2","spanId":"853c66c5","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T15:51:20.622Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"352aff8d-3593-4d3a-af85-ea27e30fbdee","spanId":"de7d2d93","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.625Z"}
[32m2026-01-17T15:51:20.626Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.626Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:51:20.626Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"a2a0bf48-bca5-4169-af5b-4130e313c490","spanId":"707115f2","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.627Z"}
[32m2026-01-17T15:51:20.628Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.628Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:51:20.628Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"a2a0bf48-bca5-4169-af5b-4130e313c490","spanId":"707115f2","method":"POST","path":"/api/generate-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.630Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"352aff8d-3593-4d3a-af85-ea27e30fbdee","spanId":"de7d2d93","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":12,"timestamp":"2026-01-17T15:51:20.637Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"64ad8692-8e13-4ac0-9be9-9036ecd2c837","spanId":"5a7aa0cd","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.627Z"}
[32m2026-01-17T15:51:20.636Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.636Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"86f1443a-de3d-46c3-b47c-24de46d1e03c","spanId":"ba28538f","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.641Z"}
[32m2026-01-17T15:51:20.641Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.641Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:51:20.642Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"86f1443a-de3d-46c3-b47c-24de46d1e03c","spanId":"ba28538f","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.643Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:51:20.642Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:51:20.644Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"cf56dd1d-e85e-44d3-8cdd-4683e9d0561b","spanId":"7429f3d5","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.647Z"}
[32m2026-01-17T15:51:20.648Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.648Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"44dcc79c-86b4-42c8-9a00-376aaf5549f7","spanId":"36a73c4c","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.635Z"}
[32m2026-01-17T15:51:20.648Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.648Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:51:20.648Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"cf56dd1d-e85e-44d3-8cdd-4683e9d0561b","spanId":"7429f3d5","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.650Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T15:51:20.649Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"44dcc79c-86b4-42c8-9a00-376aaf5549f7","spanId":"36a73c4c","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":16,"timestamp":"2026-01-17T15:51:20.651Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"11649bee-f0ca-47ff-a096-c66d32d2e645","spanId":"75b12d4c","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.658Z"}
[32m2026-01-17T15:51:20.659Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.659Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:51:20.656Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:51:20.659Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"11649bee-f0ca-47ff-a096-c66d32d2e645","spanId":"75b12d4c","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.661Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"64ad8692-8e13-4ac0-9be9-9036ecd2c837","spanId":"5a7aa0cd","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":38,"timestamp":"2026-01-17T15:51:20.665Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:51:20.664Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.664Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"2ea0530e-ca08-4f4a-99ad-44c6e73850b6","spanId":"280a011f","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.666Z"}
[32m2026-01-17T15:51:20.666Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.666Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:51:20.667Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"2ea0530e-ca08-4f4a-99ad-44c6e73850b6","spanId":"280a011f","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.668Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"1181bf46-6831-4f9b-92eb-2b7a38fc2e45","spanId":"d9198ad4","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.666Z"}
[32m2026-01-17T15:51:20.668Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.668Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:51:20.669Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:51:20.669Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"402a4661-aa2f-466f-8349-dbf27ffa97f1","spanId":"ff88a3cf","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.673Z"}
[32m2026-01-17T15:51:20.674Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.674Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:51:20.667Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.667Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"1181bf46-6831-4f9b-92eb-2b7a38fc2e45","spanId":"d9198ad4","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:51:20.671Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"d8b097ab-cf01-48ba-9507-bb798704bf9d","spanId":"696ddf1d","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.677Z"}
[32m2026-01-17T15:51:20.678Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.678Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:51:20.674Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"43989d2a-5b97-4a91-aa58-c3c7b1d7bcc5","spanId":"d9e3e34b","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.678Z"}
[32m2026-01-17T15:51:20.678Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.678Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:51:20.679Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"402a4661-aa2f-466f-8349-dbf27ffa97f1","spanId":"ff88a3cf","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.676Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"444a7037-e1af-4fa6-ade9-b4129216a707","spanId":"8e71a276","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.681Z"}
[32m2026-01-17T15:51:20.682Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.682Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:51:20.679Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"d8b097ab-cf01-48ba-9507-bb798704bf9d","spanId":"696ddf1d","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:51:20.682Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"fa687d54-164e-4129-a999-ab2a73df261e","spanId":"34c1d980","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.680Z"}
[32m2026-01-17T15:51:20.680Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.680Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"43989d2a-5b97-4a91-aa58-c3c7b1d7bcc5","spanId":"d9e3e34b","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.680Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:51:20.680Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"fa687d54-164e-4129-a999-ab2a73df261e","spanId":"34c1d980","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.682Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 491[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 87[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 10[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 17[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 36[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 7[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"4a0ac520-6cfe-42e7-9172-c7950df552a8","spanId":"3d12ddaf","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.689Z"}
[32m2026-01-17T15:51:20.690Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.690Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"e68910b6-812b-4c0a-90e0-b8c01c293acb","spanId":"b4f945fd","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.689Z"}
[32m2026-01-17T15:51:20.690Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.690Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:51:20.683Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:51:20.690Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"444a7037-e1af-4fa6-ade9-b4129216a707","spanId":"8e71a276","method":"GET","path":"/api/auth/user","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:51:20.691Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"e68910b6-812b-4c0a-90e0-b8c01c293acb","spanId":"b4f945fd","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.692Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:51:20.690Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:51:20.682Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"4a0ac520-6cfe-42e7-9172-c7950df552a8","spanId":"3d12ddaf","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:51:20.697Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"d8a6ad38-2cf2-4395-918f-6496ff907c24","spanId":"8c056a92","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.698Z"}
[32m2026-01-17T15:51:20.699Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.699Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:51:20.700Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"d8a6ad38-2cf2-4395-918f-6496ff907c24","spanId":"8c056a92","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.701Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"11511d4b-4792-4be8-8656-0c275215634d","spanId":"27be3524","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.703Z"}
[32m2026-01-17T15:51:20.703Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.703Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:51:20.704Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"11511d4b-4792-4be8-8656-0c275215634d","spanId":"27be3524","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.705Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"8c0ce3ad-22d9-4210-ade0-cb5c808e7437","spanId":"63fe3289","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.713Z"}
[32m2026-01-17T15:51:20.714Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.714Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:51:20.714Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"8c0ce3ad-22d9-4210-ade0-cb5c808e7437","spanId":"63fe3289","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.716Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"22529c84-862f-4562-9a98-98b0540bf2f2","spanId":"84ee95d3","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.716Z"}
[32m2026-01-17T15:51:20.716Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.716Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:51:20.717Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"e91c06fc-e8d4-47c9-ac6c-72ce0e60719f","spanId":"75144fb5","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.720Z"}
[32m2026-01-17T15:51:20.720Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.720Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"22529c84-862f-4562-9a98-98b0540bf2f2","spanId":"84ee95d3","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:51:20.720Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:51:20.721Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"e91c06fc-e8d4-47c9-ac6c-72ce0e60719f","spanId":"75144fb5","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.722Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 426[2mms[22m[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"6e399e28-8e02-4a8b-99de-e18decc83429","spanId":"64de6399","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.725Z"}
[32m2026-01-17T15:51:20.725Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.725Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:51:20.727Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"e05df0e8-9c3b-41eb-be31-7c8fb354dbba","spanId":"2e5f9fa7","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.712Z"}
[32m2026-01-17T15:51:20.731Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.731Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"6e399e28-8e02-4a8b-99de-e18decc83429","spanId":"64de6399","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:51:20.732Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:51:20.732Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"e05df0e8-9c3b-41eb-be31-7c8fb354dbba","spanId":"2e5f9fa7","method":"GET","path":"/api/auth/user","statusCode":401,"duration":29,"timestamp":"2026-01-17T15:51:20.741Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"52626f83-7fb0-472d-837d-547189aadb28","spanId":"a2dfd50b","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.745Z"}
[32m2026-01-17T15:51:20.746Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.746Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"d8f64c0f-ddc8-4094-8a01-4e1a3bb9f9d8","spanId":"8fbdfe27","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.745Z"}
[32m2026-01-17T15:51:20.746Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.746Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:51:20.747Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:51:20.748Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"52626f83-7fb0-472d-837d-547189aadb28","spanId":"a2dfd50b","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:51:20.752Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"d8f64c0f-ddc8-4094-8a01-4e1a3bb9f9d8","spanId":"8fbdfe27","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:51:20.750Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"9b2bcd2e-d6eb-40ce-b946-d82a50c6c851","spanId":"fe8bd367","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.761Z"}
[32m2026-01-17T15:51:20.762Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.762Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"88c61b38-c3bc-4b64-8fa8-5e4c25b95776","spanId":"03b89261","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.759Z"}
[32m2026-01-17T15:51:20.759Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.759Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:51:20.760Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"88c61b38-c3bc-4b64-8fa8-5e4c25b95776","spanId":"03b89261","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.762Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"bc21894f-45c2-446e-9065-55f21d5acfe5","spanId":"ca60dfbb","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.762Z"}
[32m2026-01-17T15:51:20.763Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.763Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:51:20.762Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"9b2bcd2e-d6eb-40ce-b946-d82a50c6c851","spanId":"fe8bd367","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.764Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:51:20.764Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"df8b221f-0497-43e9-9b61-4e8d242c08c0","spanId":"186cfcee","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.767Z"}
[32m2026-01-17T15:51:20.767Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.767Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"bc21894f-45c2-446e-9065-55f21d5acfe5","spanId":"ca60dfbb","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:51:20.768Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:51:20.768Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"df8b221f-0497-43e9-9b61-4e8d242c08c0","spanId":"186cfcee","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.770Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"516ab9d1-2652-4ac1-920c-ae72f7e8eae5","spanId":"0366b6d1","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.774Z"}
[32m2026-01-17T15:51:20.774Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.774Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"522ed422-cfb3-4f94-8fb2-e0d3a7641861","spanId":"693dd711","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.774Z"}
[32m2026-01-17T15:51:20.774Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.774Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"7b34bf57-a4df-4f2e-821a-a65419144125","spanId":"ff405262","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.775Z"}
[32m2026-01-17T15:51:20.775Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.775Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:51:20.775Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:51:20.775Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:51:20.776Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"522ed422-cfb3-4f94-8fb2-e0d3a7641861","spanId":"693dd711","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.777Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"516ab9d1-2652-4ac1-920c-ae72f7e8eae5","spanId":"0366b6d1","method":"GET","path":"/api/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:20.777Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"7b34bf57-a4df-4f2e-821a-a65419144125","spanId":"ff405262","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:51:20.777Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"8106fe39-1b09-4e52-882c-4535202daebf","spanId":"b9962717","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.785Z"}
[32m2026-01-17T15:51:20.787Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.787Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:51:20.792Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"8106fe39-1b09-4e52-882c-4535202daebf","spanId":"b9962717","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:51:20.795Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"64d644fa-0aef-42bd-b948-c0e5e793b702","spanId":"cd00e537","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.784Z"}
[32m2026-01-17T15:51:20.785Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.785Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:51:20.797Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"64d644fa-0aef-42bd-b948-c0e5e793b702","spanId":"cd00e537","method":"GET","path":"/api/auth/user","statusCode":401,"duration":15,"timestamp":"2026-01-17T15:51:20.799Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"db455543-9121-4b7a-831b-7221357920b1","spanId":"7be7126c","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.801Z"}
[32m2026-01-17T15:51:20.801Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.801Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:51:20.802Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"db455543-9121-4b7a-831b-7221357920b1","spanId":"7be7126c","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:51:20.805Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"884240e2-290d-43ec-94ca-92e31a11f807","spanId":"3c83a626","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.810Z"}
[32m2026-01-17T15:51:20.811Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.811Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:51:20.811Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"884240e2-290d-43ec-94ca-92e31a11f807","spanId":"3c83a626","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.812Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:51:20.813Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"ee5642e8-358c-4a0b-93fa-99b23af1dc72","spanId":"0b0d655a","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.822Z"}
[32m2026-01-17T15:51:20.822Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.822Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:51:20.823Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"ee5642e8-358c-4a0b-93fa-99b23af1dc72","spanId":"0b0d655a","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.824Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"f0de95cf-ce3a-4915-b179-bd6b66e1dbc7","spanId":"c4e358d9","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.828Z"}
[32m2026-01-17T15:51:20.828Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.828Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"babd2626-abd8-4778-a95e-f5e14c64458d","spanId":"86aadf93","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.829Z"}
[32m2026-01-17T15:51:20.829Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.829Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:51:20.830Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:51:20.830Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"babd2626-abd8-4778-a95e-f5e14c64458d","spanId":"86aadf93","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:20.831Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:51:20.829Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"b95aa08d-e0eb-4086-a4c6-59ed21153713","spanId":"5a29947a","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.836Z"}
[32m2026-01-17T15:51:20.836Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.836Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:51:20.837Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"b95aa08d-e0eb-4086-a4c6-59ed21153713","spanId":"5a29947a","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":4,"timestamp":"2026-01-17T15:51:20.840Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"f0de95cf-ce3a-4915-b179-bd6b66e1dbc7","spanId":"c4e358d9","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":15,"timestamp":"2026-01-17T15:51:20.842Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 487[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 155[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 20[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 28[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 32[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 23[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 20[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 533[2mms[22m[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"6f1f78ce-1074-423f-97af-d9f08c5d3ff5","spanId":"44970368","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:20.858Z"}
[32m2026-01-17T15:51:20.859Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:20.859Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:51:20.860Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"6f1f78ce-1074-423f-97af-d9f08c5d3ff5","spanId":"44970368","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:51:20.861Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 473[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 97[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 33[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 22[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 7 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:170:31
    168|         });
    169| 
    170|       expect(response.status).toBe(401);
       |                               ^
    171|     });
    172|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/7]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:179:31
    177|         .get('/api/frameworks/SOC2/controls');
    178| 
    179|       expect(response.status).toBe(401);
       |                               ^
    180|     });
    181|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/7]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/7]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/7]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/7]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/7]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/7]Î“Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m7 failed[39m[22m[2m | [22m[1m[32m61 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:51:16
[2m   Duration [22m 20.06s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/middleware/routeValidation.ts [22m[39m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:51:27.930Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:51:27.938Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:51:27.956Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:51:28.080Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"50fe43f9-046e-472f-80a2-d3d56f47d51d","spanId":"dbe3f112","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.075Z"}
[32m2026-01-17T15:51:28.079Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.079Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:51:28.097Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"50fe43f9-046e-472f-80a2-d3d56f47d51d","spanId":"dbe3f112","method":"POST","path":"/api/organizations","statusCode":401,"duration":38,"timestamp":"2026-01-17T15:51:28.113Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"ebb6d5ba-9cb1-4475-b1eb-4e75e90f200f","spanId":"306413f7","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.136Z"}
[32m2026-01-17T15:51:28.137Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.137Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:51:28.140Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"ebb6d5ba-9cb1-4475-b1eb-4e75e90f200f","spanId":"306413f7","method":"GET","path":"/api/organizations","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:51:28.143Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"995470d1-72fd-4b9c-884c-16e9eab0906b","spanId":"edabe641","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.152Z"}
[32m2026-01-17T15:51:28.153Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.153Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:51:28.153Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:51:28.154Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"995470d1-72fd-4b9c-884c-16e9eab0906b","spanId":"edabe641","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:51:28.156Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"d005c1f7-d282-4246-8fc1-ec55bf686aaa","spanId":"6775a423","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.163Z"}
[32m2026-01-17T15:51:28.163Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.163Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:51:28.164Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"d005c1f7-d282-4246-8fc1-ec55bf686aaa","spanId":"6775a423","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:51:28.167Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"23c71784-e837-4565-9ec4-95ed6ac509e1","spanId":"518021af","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.174Z"}
[32m2026-01-17T15:51:28.175Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.175Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:51:28.175Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:51:28.195Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.195Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:51:28.201Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"9a9fe43d-fe89-4ca0-b89b-d6ca815c88e3","spanId":"d617596d","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.211Z"}
[32m2026-01-17T15:51:28.212Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.212Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"23c71784-e837-4565-9ec4-95ed6ac509e1","spanId":"518021af","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":20,"timestamp":"2026-01-17T15:51:28.198Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:51:28.213Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"9a9fe43d-fe89-4ca0-b89b-d6ca815c88e3","spanId":"d617596d","method":"GET","path":"/api/auth/user","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:51:28.222Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"35d2dbdd-58f7-4735-a210-c8e969b9847b","spanId":"2f23ff91","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.228Z"}
[32m2026-01-17T15:51:28.229Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.229Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"939226b5-ad80-4d28-94d0-34eab62f1ab4","spanId":"1146ff18","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.201Z"}
[32m2026-01-17T15:51:28.231Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.231Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:51:28.230Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"35d2dbdd-58f7-4735-a210-c8e969b9847b","spanId":"2f23ff91","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:51:28.235Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"6df33e91-fcf8-471c-91e4-d5414a86dc34","spanId":"a78c4cb8","method":"POST","path":"/api/ai/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.235Z"}
[32m2026-01-17T15:51:28.236Z [INFO] POST /api/ai/generate {"method":"POST","url":"/api/ai/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.236Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:51:28.237Z [INFO] API route accessed {"path":"/api/ai/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"6df33e91-fcf8-471c-91e4-d5414a86dc34","spanId":"a78c4cb8","method":"POST","path":"/api/ai/generate","statusCode":404,"duration":4,"timestamp":"2026-01-17T15:51:28.239Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"f3cb4471-bcf4-43b2-a5b3-c5ff8d8b3e9e","spanId":"1e44966b","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.241Z"}
[32m2026-01-17T15:51:28.242Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.242Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:51:28.242Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"f3cb4471-bcf4-43b2-a5b3-c5ff8d8b3e9e","spanId":"1e44966b","method":"GET","path":"/api/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.244Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:51:28.243Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"939226b5-ad80-4d28-94d0-34eab62f1ab4","spanId":"1146ff18","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":58,"timestamp":"2026-01-17T15:51:28.259Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:51:28.264Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"1013fa48-68a2-4cc5-b6d2-13988c6a311a","spanId":"524962a3","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.271Z"}
[32m2026-01-17T15:51:28.273Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.272Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:51:28.273Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"1013fa48-68a2-4cc5-b6d2-13988c6a311a","spanId":"524962a3","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:51:28.282Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"a90ac229-dfed-4a0c-9181-e0c69f916a1a","spanId":"3cc8fcaf","method":"POST","path":"/api/ai/analyze","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.284Z"}
[32m2026-01-17T15:51:28.287Z [INFO] POST /api/ai/analyze {"method":"POST","url":"/api/ai/analyze","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.287Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:51:28.288Z [INFO] API route accessed {"path":"/api/ai/analyze","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"ac68b6a4-0b8c-4442-af63-6b81c9e07c6a","spanId":"e546c2ea","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.288Z"}
[32m2026-01-17T15:51:28.289Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.289Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"a90ac229-dfed-4a0c-9181-e0c69f916a1a","spanId":"3cc8fcaf","method":"POST","path":"/api/ai/analyze","statusCode":404,"duration":7,"timestamp":"2026-01-17T15:51:28.291Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:51:28.290Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"ac68b6a4-0b8c-4442-af63-6b81c9e07c6a","spanId":"e546c2ea","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:51:28.292Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"00be2e09-c9c8-42e6-9365-b7acf2e35dfa","spanId":"0bfa0a97","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.302Z"}
[32m2026-01-17T15:51:28.302Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.302Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:51:28.290Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.290Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:51:28.316Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.308Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:51:28.317Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"3f59c676-bdac-4c17-a1dd-25592215f172","spanId":"611acc28","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.317Z"}
[32m2026-01-17T15:51:28.318Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.318Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:51:28.318Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:51:28.303Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:51:28.319Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"3f59c676-bdac-4c17-a1dd-25592215f172","spanId":"611acc28","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.320Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"00be2e09-c9c8-42e6-9365-b7acf2e35dfa","spanId":"0bfa0a97","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":19,"timestamp":"2026-01-17T15:51:28.321Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 466[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"fc61d2e7-6fb0-435a-948e-5fdb6212933a","spanId":"4026189f","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.327Z"}
[32m2026-01-17T15:51:28.327Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.327Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:51:28.329Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"fc61d2e7-6fb0-435a-948e-5fdb6212933a","spanId":"4026189f","method":"POST","path":"/api/evidence","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:51:28.331Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:51:28.329Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"f0b92004-f844-46ae-b02e-698a5f513ec1","spanId":"2901e4f4","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.334Z"}
[32m2026-01-17T15:51:28.334Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.334Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"d15eb88f-7a3f-4780-aee5-61c19d11d870","spanId":"c396c5fc","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.341Z"}
[32m2026-01-17T15:51:28.342Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.342Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:51:28.342Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"d15eb88f-7a3f-4780-aee5-61c19d11d870","spanId":"c396c5fc","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.344Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:51:28.335Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"a54f80fa-a29d-48be-9521-40d2bc2d771c","spanId":"b3c9904d","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.350Z"}
[32m2026-01-17T15:51:28.351Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.351Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"f0b92004-f844-46ae-b02e-698a5f513ec1","spanId":"2901e4f4","method":"GET","path":"/api/auth/user","statusCode":401,"duration":17,"timestamp":"2026-01-17T15:51:28.350Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"2c0ba6c1-e3f8-441d-896d-503fd6687b21","spanId":"d6cf19da","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.351Z"}
[32m2026-01-17T15:51:28.352Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.352Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:51:28.352Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:51:28.353Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"2c0ba6c1-e3f8-441d-896d-503fd6687b21","spanId":"d6cf19da","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.354Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"a54f80fa-a29d-48be-9521-40d2bc2d771c","spanId":"b3c9904d","method":"GET","path":"/api/evidence","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:51:28.355Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"3550e6ad-7f33-49fb-b0ee-8f9de4d7a51c","spanId":"8bac996e","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.357Z"}
[32m2026-01-17T15:51:28.358Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.358Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"80ccdd36-d389-4c2a-99d2-379978af94c9","spanId":"61957d29","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.359Z"}
[32m2026-01-17T15:51:28.360Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.360Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"1b83ddd8-13ab-4b71-9e62-60005f6d4b12","spanId":"1cae21ee","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.361Z"}
[32m2026-01-17T15:51:28.361Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.361Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:51:28.359Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:51:28.360Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:51:28.362Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"3550e6ad-7f33-49fb-b0ee-8f9de4d7a51c","spanId":"8bac996e","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:51:28.363Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"80ccdd36-d389-4c2a-99d2-379978af94c9","spanId":"61957d29","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:28.361Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"1b83ddd8-13ab-4b71-9e62-60005f6d4b12","spanId":"1cae21ee","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:28.363Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"fd2c6cd5-9061-4229-840a-f05fe3a9532c","spanId":"0eb36b2d","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.369Z"}
[32m2026-01-17T15:51:28.370Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.370Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"7041a37f-c3a8-430f-92ea-700f81868ed2","spanId":"d6e20805","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.380Z"}
[32m2026-01-17T15:51:28.381Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.381Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:51:28.370Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:51:28.381Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"fd2c6cd5-9061-4229-840a-f05fe3a9532c","spanId":"0eb36b2d","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:51:28.383Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"7041a37f-c3a8-430f-92ea-700f81868ed2","spanId":"d6e20805","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:28.383Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"9f15c338-0620-41a8-b43b-db94b750c315","spanId":"1ed84877","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.389Z"}
[32m2026-01-17T15:51:28.390Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.390Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:51:28.391Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"9f15c338-0620-41a8-b43b-db94b750c315","spanId":"1ed84877","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.392Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"5d1cf567-707b-4152-8bc8-dd9dcff149c6","spanId":"f3e3f31c","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.397Z"}
[32m2026-01-17T15:51:28.397Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.397Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:51:28.398Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"5d1cf567-707b-4152-8bc8-dd9dcff149c6","spanId":"f3e3f31c","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:28.399Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"46f54efa-faa0-44ad-8086-2514ad0c8380","spanId":"257f9f2f","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.399Z"}
[32m2026-01-17T15:51:28.400Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.400Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:51:28.407Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"46f54efa-faa0-44ad-8086-2514ad0c8380","spanId":"257f9f2f","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:51:28.409Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"6c830842-57a5-4e7f-9d42-43943d60c46b","spanId":"bb7ca062","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.410Z"}
[32m2026-01-17T15:51:28.411Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.411Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:51:28.412Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"6c830842-57a5-4e7f-9d42-43943d60c46b","spanId":"bb7ca062","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:51:28.415Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"868196ad-9a35-41ee-9efe-aab2fecfcd00","spanId":"0ee2e546","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.416Z"}
[32m2026-01-17T15:51:28.416Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.416Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"0e155c46-a038-461e-921f-92f31a20b76c","spanId":"ffe22143","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.415Z"}
[32m2026-01-17T15:51:28.416Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.416Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:51:28.417Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"868196ad-9a35-41ee-9efe-aab2fecfcd00","spanId":"0ee2e546","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.419Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:51:28.419Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"3404f869-026f-4fb3-b475-ea8da1f4a789","spanId":"0b1c71f7","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.421Z"}
[32m2026-01-17T15:51:28.422Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.422Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"0e155c46-a038-461e-921f-92f31a20b76c","spanId":"ffe22143","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:51:28.423Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:51:28.422Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"3404f869-026f-4fb3-b475-ea8da1f4a789","spanId":"0b1c71f7","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:51:28.426Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"ee0beb4f-f695-4815-9a76-67553adbc047","spanId":"d55edfd1","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.431Z"}
[32m2026-01-17T15:51:28.432Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.432Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:51:28.432Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"ee0beb4f-f695-4815-9a76-67553adbc047","spanId":"d55edfd1","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:51:28.435Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"035651a7-43a5-4ff7-ba84-9cc8862c89b5","spanId":"6d94b5d8","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.433Z"}
[32m2026-01-17T15:51:28.434Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.434Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:51:28.436Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"035651a7-43a5-4ff7-ba84-9cc8862c89b5","spanId":"6d94b5d8","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:51:28.438Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"207b13ed-216f-4202-84d9-509b35b5bb45","spanId":"d9aadf22","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.441Z"}
[32m2026-01-17T15:51:28.442Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.442Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:51:28.442Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"207b13ed-216f-4202-84d9-509b35b5bb45","spanId":"d9aadf22","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.444Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"20f767aa-0069-47da-b565-e1b3304811f4","spanId":"ba1fe5fc","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.444Z"}
[32m2026-01-17T15:51:28.445Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.445Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:51:28.445Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"20f767aa-0069-47da-b565-e1b3304811f4","spanId":"ba1fe5fc","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.447Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"daf7439c-cbd9-4ae2-99d6-fd4b4f995bac","spanId":"cfb1be97","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.449Z"}
[32m2026-01-17T15:51:28.449Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.449Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:51:28.450Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"daf7439c-cbd9-4ae2-99d6-fd4b4f995bac","spanId":"cfb1be97","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:51:28.451Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"9122c2ec-810c-4fb3-961d-e57703eaff4f","spanId":"7421261f","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.452Z"}
[32m2026-01-17T15:51:28.453Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.453Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:51:28.454Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"9122c2ec-810c-4fb3-961d-e57703eaff4f","spanId":"7421261f","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.455Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"c08c7b46-f3f3-4c56-8297-edc0de1a2754","spanId":"03a44f0e","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.450Z"}
[32m2026-01-17T15:51:28.454Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.454Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"d134d791-cd36-4858-8185-1cb9e4857bf8","spanId":"59952e5f","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.460Z"}
[32m2026-01-17T15:51:28.460Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.460Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"7e633b77-7d08-44e8-852c-86580a07f815","spanId":"b68076a9","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.459Z"}
[32m2026-01-17T15:51:28.460Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.460Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"08560f3e-4d43-49fd-a329-c82150c063a0","spanId":"e2dfc336","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.460Z"}
[32m2026-01-17T15:51:28.460Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.460Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:51:28.461Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"7e633b77-7d08-44e8-852c-86580a07f815","spanId":"b68076a9","method":"GET","path":"/api/auth/user","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.462Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:51:28.461Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"08560f3e-4d43-49fd-a329-c82150c063a0","spanId":"e2dfc336","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.463Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:51:28.460Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"d134d791-cd36-4858-8185-1cb9e4857bf8","spanId":"59952e5f","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:51:28.468Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:51:28.465Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"69d9dfed-7158-4a6c-baa0-dd04c46dbf87","spanId":"f5fb543b","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.469Z"}
[32m2026-01-17T15:51:28.469Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.469Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:51:28.470Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"69d9dfed-7158-4a6c-baa0-dd04c46dbf87","spanId":"f5fb543b","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.472Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"d66f8b03-1e06-4649-b548-90dd9def95d6","spanId":"27bc9e0e","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.474Z"}
[32m2026-01-17T15:51:28.474Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.474Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:51:28.475Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"d66f8b03-1e06-4649-b548-90dd9def95d6","spanId":"27bc9e0e","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:28.476Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:51:28.476Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"0b5beb54-bbd5-4a42-a206-93ac0a510c85","spanId":"b18d6600","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.477Z"}
[32m2026-01-17T15:51:28.477Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.477Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:51:28.478Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"0b5beb54-bbd5-4a42-a206-93ac0a510c85","spanId":"b18d6600","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:51:28.480Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"d176b4fe-8624-4f45-8ca8-70a70734f38d","spanId":"8aa6acf4","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.480Z"}
[32m2026-01-17T15:51:28.480Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.480Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:51:28.481Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"d176b4fe-8624-4f45-8ca8-70a70734f38d","spanId":"8aa6acf4","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:28.482Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"aa256d43-d219-44ae-8a08-c4e3310008fb","spanId":"fb185486","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.486Z"}
[32m2026-01-17T15:51:28.486Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.486Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:51:28.487Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"aa256d43-d219-44ae-8a08-c4e3310008fb","spanId":"fb185486","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:28.488Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"c08c7b46-f3f3-4c56-8297-edc0de1a2754","spanId":"03a44f0e","method":"GET","path":"/","statusCode":200,"duration":39,"timestamp":"2026-01-17T15:51:28.488Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 628[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation[32m 94[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences[32m 59[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
[31m   [31mâ”œÃ¹[31m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis[39m[32m 48[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 404 "Not Found"[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status[32m 29[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence[32m 23[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control[32m 20[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats[32m 6[2mms[22m[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"01652e99-6888-4a7a-9cd8-e5cb85b6ff35","spanId":"4e84394c","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.492Z"}
[32m2026-01-17T15:51:28.492Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.492Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:51:28.493Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"01652e99-6888-4a7a-9cd8-e5cb85b6ff35","spanId":"4e84394c","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":11,"timestamp":"2026-01-17T15:51:28.503Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:51:28.505Z [ERROR] Database health check failed {"error":"Unknown error"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 540[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 101[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 29[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 23[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 29[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 34[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 15[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[39m[32m 17[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 631[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 231[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 47[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 24[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 47[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 25[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 11[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 19[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 25[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"a86f77c3-6683-4c6f-98eb-a834351748d4","spanId":"03424df6","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.524Z"}
[32m2026-01-17T15:51:28.525Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.525Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:51:28.526Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"a86f77c3-6683-4c6f-98eb-a834351748d4","spanId":"03424df6","method":"GET","path":"/","statusCode":200,"duration":17,"timestamp":"2026-01-17T15:51:28.541Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"3a7fea38-ce6b-4afb-bb87-9c3e0fd8ef7f","spanId":"e43f1e33","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.556Z"}
[32m2026-01-17T15:51:28.557Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.557Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:51:28.568Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"3a7fea38-ce6b-4afb-bb87-9c3e0fd8ef7f","spanId":"e43f1e33","method":"GET","path":"/iso-001","statusCode":200,"duration":15,"timestamp":"2026-01-17T15:51:28.571Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"ca5191f9-2330-4d6c-8d87-a2a5904871c4","spanId":"24bb2a57","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.596Z"}
[32m2026-01-17T15:51:28.597Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.597Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:51:28.598Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"ca5191f9-2330-4d6c-8d87-a2a5904871c4","spanId":"24bb2a57","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:51:28.605Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"bc8cc52e-a24e-4f47-a1b9-45e2fbfbd930","spanId":"99b951e6","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.613Z"}
[32m2026-01-17T15:51:28.614Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.614Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:51:28.615Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"bc8cc52e-a24e-4f47-a1b9-45e2fbfbd930","spanId":"99b951e6","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:51:28.617Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"180186ec-2720-4326-9eac-a44e80b1a43d","spanId":"3bb24d5a","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.653Z"}
[32m2026-01-17T15:51:28.653Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.653Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:51:28.654Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"180186ec-2720-4326-9eac-a44e80b1a43d","spanId":"3bb24d5a","method":"POST","path":"/export-document","statusCode":200,"duration":4,"timestamp":"2026-01-17T15:51:28.657Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"56bdf080-a641-470f-8b57-63b7db094bdc","spanId":"ac3835da","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.664Z"}
[32m2026-01-17T15:51:28.664Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.664Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:51:28.665Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"56bdf080-a641-470f-8b57-63b7db094bdc","spanId":"ac3835da","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T15:51:28.667Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"6955f836-2ae2-44fc-9c44-e3dda8a8bebf","spanId":"af49a0e1","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.673Z"}
[32m2026-01-17T15:51:28.673Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.673Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:51:28.674Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"6955f836-2ae2-44fc-9c44-e3dda8a8bebf","spanId":"af49a0e1","method":"POST","path":"/api/generate-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.676Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"07a26635-57bf-4926-ab39-2212d3cfda57","spanId":"3425c58b","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.683Z"}
[32m2026-01-17T15:51:28.684Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.684Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T15:51:28.684Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"07a26635-57bf-4926-ab39-2212d3cfda57","spanId":"3425c58b","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.686Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"457d0ee0-fdba-4416-9c78-8f4d2dde8849","spanId":"e58debc0","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.693Z"}
[32m2026-01-17T15:51:28.694Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.694Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:51:28.695Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"457d0ee0-fdba-4416-9c78-8f4d2dde8849","spanId":"e58debc0","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.696Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"8978d4bc-cbcf-48f0-bffc-6f8ec74d135b","spanId":"053655a3","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.702Z"}
[32m2026-01-17T15:51:28.702Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.702Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:51:28.703Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"8978d4bc-cbcf-48f0-bffc-6f8ec74d135b","spanId":"053655a3","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:28.704Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"5b57d2dd-50c9-4fd9-a889-4b552444dfc2","spanId":"e8076758","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.709Z"}
[32m2026-01-17T15:51:28.710Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.710Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:51:28.710Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"5b57d2dd-50c9-4fd9-a889-4b552444dfc2","spanId":"e8076758","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.712Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"15a20057-a560-41f5-b2fa-935f6580b979","spanId":"8bfca41a","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.716Z"}
[32m2026-01-17T15:51:28.716Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.716Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:51:28.717Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"15a20057-a560-41f5-b2fa-935f6580b979","spanId":"8bfca41a","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:51:28.722Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"92740017-63a9-4a4c-8cc5-2f5552b13538","spanId":"8a94503a","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.731Z"}
[32m2026-01-17T15:51:28.732Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.732Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:51:28.732Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"92740017-63a9-4a4c-8cc5-2f5552b13538","spanId":"8a94503a","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:28.734Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"f504df38-bc91-4c82-a7ff-c39bfefc2ed3","spanId":"b46e6010","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:28.739Z"}
[32m2026-01-17T15:51:28.739Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:28.739Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:51:28.740Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"f504df38-bc91-4c82-a7ff-c39bfefc2ed3","spanId":"b46e6010","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:28.741Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 585[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 7 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:170:31
    168|         });
    169| 
    170|       expect(response.status).toBe(401);
       |                               ^
    171|     });
    172|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/7]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:179:31
    177|         .get('/api/frameworks/SOC2/controls');
    178| 
    179|       expect(response.status).toBe(401);
       |                               ^
    180|     });
    181|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/7]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document generation
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:88:12
     86|             context: 'Enterprise SaaS company'
     87|           })
     88|           .expect(401);
       |            ^
     89|       });
     90| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/7]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Document Generation > should require authentication for AI document analysis
Error: expected 401 "Unauthorized", got 404 "Not Found"
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:98:12
     96|             analysisType: 'gap-analysis'
     97|           })
     98|           .expect(401);
       |            ^
     99|       });
    100| 
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/7]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/7]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[6/7]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[7/7]Î“Ã„Â»


[2m Test Files [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m7 failed[39m[22m[2m | [22m[1m[32m61 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:51:24
[2m   Duration [22m 20.71s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/integration/e2e-flows.test.ts [22m[34mx17 [34m[39m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 540[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 101[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 29[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 23[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 29[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 34[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 8[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 15[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[39m[32m 17[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 631[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 231[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 47[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 24[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 47[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 25[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 11[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 19[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 25[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:51:45.800Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"6d617800-8e3e-4ca8-aed2-1eb669b52207","spanId":"d0f91730","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.868Z"}
[32m2026-01-17T15:51:45.870Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.870Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:51:45.876Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"6d617800-8e3e-4ca8-aed2-1eb669b52207","spanId":"d0f91730","method":"POST","path":"/api/organizations","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:51:45.881Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"3f50dcca-9749-4d5d-bbb0-e992daf50c85","spanId":"42e06f19","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.887Z"}
[32m2026-01-17T15:51:45.888Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.888Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:51:45.888Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"3f50dcca-9749-4d5d-bbb0-e992daf50c85","spanId":"42e06f19","method":"GET","path":"/api/organizations","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:45.890Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"1dfb4476-0b73-482c-bad6-e37138845e68","spanId":"2a737b61","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.894Z"}
[32m2026-01-17T15:51:45.894Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.894Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:51:45.895Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"1dfb4476-0b73-482c-bad6-e37138845e68","spanId":"2a737b61","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.896Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"71bfb5bb-5216-4c16-9102-ebce121b7345","spanId":"73c7a2bb","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.900Z"}
[32m2026-01-17T15:51:45.901Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.901Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:51:45.901Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"71bfb5bb-5216-4c16-9102-ebce121b7345","spanId":"73c7a2bb","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:45.903Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"e8141c9f-84ff-400d-808c-984f870fe5a5","spanId":"d7d2e222","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.907Z"}
[32m2026-01-17T15:51:45.907Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.907Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:51:45.908Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"e8141c9f-84ff-400d-808c-984f870fe5a5","spanId":"d7d2e222","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.909Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"febc7081-c773-4319-9128-351b3ad6579f","spanId":"a9a8eb6c","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.914Z"}
[32m2026-01-17T15:51:45.914Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.914Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:51:45.915Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"febc7081-c773-4319-9128-351b3ad6579f","spanId":"a9a8eb6c","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.916Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"9e23f228-603a-4708-bf0e-4d0c1204f05c","spanId":"e853b02d","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.919Z"}
[32m2026-01-17T15:51:45.920Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.920Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:51:45.920Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"9e23f228-603a-4708-bf0e-4d0c1204f05c","spanId":"e853b02d","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:51:45.922Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:51:45.927Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.927Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:51:45.927Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"58a95900-5555-47d5-b55a-5b81fb2280a9","spanId":"9c67cb15","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.933Z"}
[32m2026-01-17T15:51:45.934Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.934Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:51:45.934Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"58a95900-5555-47d5-b55a-5b81fb2280a9","spanId":"9c67cb15","method":"POST","path":"/api/evidence","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.935Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"13cfefc8-c238-4a80-b014-a01b529569cf","spanId":"63f417d2","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.940Z"}
[32m2026-01-17T15:51:45.940Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.940Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:51:45.941Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"13cfefc8-c238-4a80-b014-a01b529569cf","spanId":"63f417d2","method":"GET","path":"/api/evidence","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.942Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"ec99d554-1209-4d25-a568-49198b3ca650","spanId":"bf7060f7","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.945Z"}
[32m2026-01-17T15:51:45.945Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.945Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:51:45.945Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"ec99d554-1209-4d25-a568-49198b3ca650","spanId":"bf7060f7","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:51:45.946Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"a32e6a8c-9c46-48e3-9b79-06cd67d82627","spanId":"02c1eb43","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.949Z"}
[32m2026-01-17T15:51:45.949Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.949Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:51:45.949Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"a32e6a8c-9c46-48e3-9b79-06cd67d82627","spanId":"02c1eb43","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:51:45.950Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"7866065c-a3bf-40ab-9da1-34e93d0cb99c","spanId":"422d8bb3","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.952Z"}
[32m2026-01-17T15:51:45.952Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.952Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:51:45.953Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"7866065c-a3bf-40ab-9da1-34e93d0cb99c","spanId":"422d8bb3","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:51:45.953Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"1ceca81a-0cbd-4442-a00e-d1baee77ed57","spanId":"550106ce","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.957Z"}
[32m2026-01-17T15:51:45.958Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.958Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:51:45.958Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"1ceca81a-0cbd-4442-a00e-d1baee77ed57","spanId":"550106ce","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.959Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"91e9b91e-739e-4bf1-8283-1ea887ea97d8","spanId":"1814ad62","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.961Z"}
[32m2026-01-17T15:51:45.962Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.962Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:51:45.962Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"91e9b91e-739e-4bf1-8283-1ea887ea97d8","spanId":"1814ad62","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.963Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"bab49bbe-573f-4f23-b7b0-6d0331617fc4","spanId":"e7b584aa","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.966Z"}
[32m2026-01-17T15:51:45.967Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.967Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:51:45.967Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"bab49bbe-573f-4f23-b7b0-6d0331617fc4","spanId":"e7b584aa","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.968Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"94f45a5a-c79a-49f4-ae63-89a0425430a1","spanId":"ec707e0a","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.971Z"}
[32m2026-01-17T15:51:45.971Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.971Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:51:45.972Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"94f45a5a-c79a-49f4-ae63-89a0425430a1","spanId":"ec707e0a","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:51:45.972Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"4ce08256-a39d-439d-92c0-023bae77f443","spanId":"b835441c","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.975Z"}
[32m2026-01-17T15:51:45.975Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.975Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:51:45.976Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"4ce08256-a39d-439d-92c0-023bae77f443","spanId":"b835441c","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:51:45.976Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"9efb31af-459a-4874-873b-33b24adcdfc4","spanId":"1c5dc662","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.981Z"}
[32m2026-01-17T15:51:45.981Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.981Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:51:45.982Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"9efb31af-459a-4874-873b-33b24adcdfc4","spanId":"1c5dc662","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:51:45.982Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"0be2c196-d51d-4c8d-be20-b37d63c8d7d9","spanId":"929002a8","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.985Z"}
[32m2026-01-17T15:51:45.985Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.985Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:51:45.986Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"0be2c196-d51d-4c8d-be20-b37d63c8d7d9","spanId":"929002a8","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.987Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"0d67d175-91bd-4fd6-84f7-8befbd629137","spanId":"a403456b","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.990Z"}
[32m2026-01-17T15:51:45.991Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.991Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:51:45.991Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"0d67d175-91bd-4fd6-84f7-8befbd629137","spanId":"a403456b","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.992Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"c1605e00-750e-4674-97dc-af59447f9a2e","spanId":"bab31097","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:51:45.994Z"}
[32m2026-01-17T15:51:45.995Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:51:45.995Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:51:45.995Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"c1605e00-750e-4674-97dc-af59447f9a2e","spanId":"bab31097","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:51:45.996Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[32m 243[2mms[22m[39m

[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (3)[39m
[2m      Tests [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m43 passed[39m[22m[90m (48)[39m
[2m   Start at [22m 07:51:43
[2m   Duration [22m 1.86s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes/gapAnalysis.ts [22m[39m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:55:46.187Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:55:46.203Z [INFO] Registering Gap Analysis routes[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"462ecb0d-c221-4681-9d15-2e4d32956e7f","spanId":"8045d672","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.317Z"}
[32m2026-01-17T15:55:46.320Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.320Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:55:46.329Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"462ecb0d-c221-4681-9d15-2e4d32956e7f","spanId":"8045d672","method":"GET","path":"/","statusCode":200,"duration":29,"timestamp":"2026-01-17T15:55:46.345Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"d80d456e-ca91-4016-891e-5731ede57592","spanId":"8a474068","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.376Z"}
[32m2026-01-17T15:55:46.377Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.377Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:55:46.378Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"d80d456e-ca91-4016-891e-5731ede57592","spanId":"8a474068","method":"GET","path":"/","statusCode":200,"duration":12,"timestamp":"2026-01-17T15:55:46.388Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"0261d390-6dc2-437b-bbe3-b526e904e6cc","spanId":"c1d099ea","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.400Z"}
[32m2026-01-17T15:55:46.401Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.401Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:55:46.401Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"0261d390-6dc2-437b-bbe3-b526e904e6cc","spanId":"c1d099ea","method":"GET","path":"/iso-001","statusCode":200,"duration":3,"timestamp":"2026-01-17T15:55:46.403Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"62d5c564-b48b-449b-aac9-63a436c698e6","spanId":"cd0bea50","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.429Z"}
[32m2026-01-17T15:55:46.429Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.429Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:55:46.430Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"62d5c564-b48b-449b-aac9-63a436c698e6","spanId":"cd0bea50","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:55:46.436Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"ce3d13f9-94c1-4b7f-be2d-86ab8a66b7c8","spanId":"ce7165d7","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.443Z"}
[32m2026-01-17T15:55:46.443Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.443Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:55:46.477Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:55:46.444Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"ce3d13f9-94c1-4b7f-be2d-86ab8a66b7c8","spanId":"ce7165d7","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":66,"timestamp":"2026-01-17T15:55:46.509Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"e13e01f9-bb4d-494e-9718-41e9a7bd1f55","spanId":"c849bf05","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.519Z"}
[32m2026-01-17T15:55:46.519Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.519Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:55:46.521Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"e13e01f9-bb4d-494e-9718-41e9a7bd1f55","spanId":"c849bf05","method":"POST","path":"/export-document","statusCode":200,"duration":14,"timestamp":"2026-01-17T15:55:46.533Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:55:46.537Z [INFO] Registering Gap Analysis routes[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"66046c54-f17c-479f-95c7-ad312bd693b4","spanId":"c3d92fc1","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.538Z"}
[32m2026-01-17T15:55:46.539Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.539Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:55:46.539Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"66046c54-f17c-479f-95c7-ad312bd693b4","spanId":"c3d92fc1","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T15:55:46.541Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:55:46.543Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:55:46.560Z [INFO] Registering Gap Analysis routes[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"f03682ba-b048-4519-91e2-b7372247879f","spanId":"e3ad38ea","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.595Z"}
[32m2026-01-17T15:55:46.595Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.595Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:55:46.596Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"f03682ba-b048-4519-91e2-b7372247879f","spanId":"e3ad38ea","method":"POST","path":"/api/generate-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:46.598Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"87f9399c-2ac7-4406-bcb5-1e81b0fbe25f","spanId":"5fbebb1e","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.605Z"}
[32m2026-01-17T15:55:46.605Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.605Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T15:55:46.606Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"87f9399c-2ac7-4406-bcb5-1e81b0fbe25f","spanId":"5fbebb1e","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:46.608Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"16f485d9-3dad-486b-89aa-a39a5420dff5","spanId":"ebde0915","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.613Z"}
[32m2026-01-17T15:55:46.614Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.614Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:55:46.615Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"16f485d9-3dad-486b-89aa-a39a5420dff5","spanId":"ebde0915","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:46.616Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"ccaea179-4a93-43b8-bf96-69ef6e68f86f","spanId":"7fb0a2da","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.622Z"}
[32m2026-01-17T15:55:46.622Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.622Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:55:46.623Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"ccaea179-4a93-43b8-bf96-69ef6e68f86f","spanId":"7fb0a2da","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:46.624Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"91594720-f30a-4a0f-86c6-e674f99deffa","spanId":"8368b103","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.637Z"}
[32m2026-01-17T15:55:46.637Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.637Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:55:46.637Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"91594720-f30a-4a0f-86c6-e674f99deffa","spanId":"8368b103","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:46.640Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"accd19d0-cab0-4d3c-af67-abdb1a30f696","spanId":"9afccbf2","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.647Z"}
[32m2026-01-17T15:55:46.647Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.647Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:55:46.648Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"accd19d0-cab0-4d3c-af67-abdb1a30f696","spanId":"9afccbf2","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:46.649Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"a1d155b0-b7c7-4b9e-97a9-631a72807367","spanId":"a9ab4a68","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.653Z"}
[32m2026-01-17T15:55:46.654Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.654Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:55:46.654Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"a1d155b0-b7c7-4b9e-97a9-631a72807367","spanId":"a9ab4a68","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:46.655Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"d7a9b59d-b5a3-4228-bfbc-a00108e0bd0d","spanId":"ba79f413","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.661Z"}
[32m2026-01-17T15:55:46.661Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.661Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:55:46.661Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"d7a9b59d-b5a3-4228-bfbc-a00108e0bd0d","spanId":"ba79f413","method":"POST","path":"/api/save-document","statusCode":401,"duration":19,"timestamp":"2026-01-17T15:55:46.680Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 604[2mms[22m[39m
stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:55:46.805Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:55:46.821Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:55:46.826Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:55:46.850Z [INFO] Registering Gap Analysis routes[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:55:46.851Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.851Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:55:46.855Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:55:46.874Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.874Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"f47b3c7d-a16e-4d75-8f1d-039171a8ea9f","spanId":"bfd208ec","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.874Z"}
[32m2026-01-17T15:55:46.875Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.875Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:55:46.878Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"37403fd1-04cd-4ea6-8e8e-e5eba359bce0","spanId":"37623a82","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.892Z"}
[32m2026-01-17T15:55:46.893Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.893Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:55:46.894Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"37403fd1-04cd-4ea6-8e8e-e5eba359bce0","spanId":"37623a82","method":"GET","path":"/api/auth/user","statusCode":401,"duration":15,"timestamp":"2026-01-17T15:55:46.907Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"635f8dbd-471d-42ff-880b-06d9f305705e","spanId":"6fe6b3ec","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.913Z"}
[32m2026-01-17T15:55:46.914Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.914Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:55:46.915Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"635f8dbd-471d-42ff-880b-06d9f305705e","spanId":"6fe6b3ec","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:55:46.918Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"d483871c-a50f-48dd-baa0-adb15a9eaa6f","spanId":"6b5ce6a0","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.923Z"}
[32m2026-01-17T15:55:46.924Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.924Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:55:46.925Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:55:46.880Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"d483871c-a50f-48dd-baa0-adb15a9eaa6f","spanId":"6b5ce6a0","method":"GET","path":"/api/documents","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:46.927Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"f47b3c7d-a16e-4d75-8f1d-039171a8ea9f","spanId":"bfd208ec","method":"GET","path":"/api/auth/user","statusCode":401,"duration":54,"timestamp":"2026-01-17T15:55:46.928Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"c71cbfe8-e609-4af5-a87c-b7d01c77c25f","spanId":"cdb94788","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.939Z"}
[32m2026-01-17T15:55:46.940Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.940Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:55:46.941Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"c71cbfe8-e609-4af5-a87c-b7d01c77c25f","spanId":"cdb94788","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:55:46.944Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"81ea7e7f-a4ca-4144-8088-0367dc99d650","spanId":"053000ef","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.956Z"}
[32m2026-01-17T15:55:46.957Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.957Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:55:46.958Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"81ea7e7f-a4ca-4144-8088-0367dc99d650","spanId":"053000ef","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:46.960Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 538[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"c19802d1-52e6-40b0-94cf-18fba0fa49ee","spanId":"17f3e2a0","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.963Z"}
[32m2026-01-17T15:55:46.968Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.968Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"8b6ef4da-7db9-4cdd-a40b-2039c1afefcc","spanId":"161470e5","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.972Z"}
[32m2026-01-17T15:55:46.981Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.981Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:55:46.982Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"8b6ef4da-7db9-4cdd-a40b-2039c1afefcc","spanId":"161470e5","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:55:46.985Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"be54497b-33ed-4919-a771-4ca8372cfda5","spanId":"37e15a09","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:46.991Z"}
[32m2026-01-17T15:55:46.992Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:46.992Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:55:46.993Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"be54497b-33ed-4919-a771-4ca8372cfda5","spanId":"37e15a09","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:46.994Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:55:46.988Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"b4b0a71d-d4b2-4f77-adc0-d0cc7e24c7f6","spanId":"cecb55f7","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.007Z"}
[32m2026-01-17T15:55:47.008Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.008Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:55:47.009Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"b4b0a71d-d4b2-4f77-adc0-d0cc7e24c7f6","spanId":"cecb55f7","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.011Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"c19802d1-52e6-40b0-94cf-18fba0fa49ee","spanId":"17f3e2a0","method":"POST","path":"/api/organizations","statusCode":401,"duration":50,"timestamp":"2026-01-17T15:55:47.012Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"117b874d-b6a1-489f-aa48-a6a658c2df8d","spanId":"c7c58f32","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.019Z"}
[32m2026-01-17T15:55:47.019Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.019Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:55:47.020Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"117b874d-b6a1-489f-aa48-a6a658c2df8d","spanId":"c7c58f32","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:55:47.021Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"4d724373-745c-419b-ae5c-5a59cd83e801","spanId":"8ac743d2","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.028Z"}
[32m2026-01-17T15:55:47.028Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.028Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"dcb855e5-9181-40df-a095-f9903697db30","spanId":"3d1fb654","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.028Z"}
[32m2026-01-17T15:55:47.029Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.028Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:55:47.029Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"4d724373-745c-419b-ae5c-5a59cd83e801","spanId":"8ac743d2","method":"GET","path":"/api/auth/user","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:47.030Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:55:47.029Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"dcb855e5-9181-40df-a095-f9903697db30","spanId":"3d1fb654","method":"GET","path":"/api/organizations","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:55:47.037Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"7c35d56b-cec1-407b-83ef-102560113e74","spanId":"c8a1660d","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.043Z"}
[32m2026-01-17T15:55:47.044Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.044Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:55:47.045Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"7c35d56b-cec1-407b-83ef-102560113e74","spanId":"c8a1660d","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:55:47.048Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"2d76f99b-8d82-4e6c-88e5-9a433a222769","spanId":"3c13640e","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.054Z"}
[32m2026-01-17T15:55:47.055Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.055Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:55:47.056Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"2d76f99b-8d82-4e6c-88e5-9a433a222769","spanId":"3c13640e","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.058Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:55:47.063Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"5af34767-ed71-4dea-b2bf-8d7db02dee0e","spanId":"72620d4a","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.068Z"}
[32m2026-01-17T15:55:47.068Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.068Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:55:47.069Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"5af34767-ed71-4dea-b2bf-8d7db02dee0e","spanId":"72620d4a","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:47.071Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"cfbae730-a828-4311-b797-7d7d199e86de","spanId":"dd4d1800","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.078Z"}
[32m2026-01-17T15:55:47.079Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.078Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:55:47.079Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"cfbae730-a828-4311-b797-7d7d199e86de","spanId":"dd4d1800","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.082Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"fae03b33-903a-42c7-bb4e-677aed3b8b07","spanId":"7b24b5b2","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.088Z"}
[32m2026-01-17T15:55:47.088Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.088Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:55:47.089Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"fae03b33-903a-42c7-bb4e-677aed3b8b07","spanId":"7b24b5b2","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:47.091Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:55:47.101Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:55:47.100Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.100Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:55:47.101Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 681[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 210[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 51[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 63[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 39[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 18[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 19[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 48[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"5a8d1828-011e-45ec-9b46-b3d8b76a0001","spanId":"46ac1acb","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.116Z"}
[32m2026-01-17T15:55:47.117Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.117Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:55:47.118Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"5a8d1828-011e-45ec-9b46-b3d8b76a0001","spanId":"46ac1acb","method":"POST","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.120Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"038e1274-9acc-4e0a-ab85-5af4d63248cb","spanId":"f0019aff","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.134Z"}
[32m2026-01-17T15:55:47.134Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.134Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:55:47.135Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"038e1274-9acc-4e0a-ab85-5af4d63248cb","spanId":"f0019aff","method":"GET","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.137Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:55:47.150Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:55:47.171Z [INFO] Registering Gap Analysis routes[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"4c49f479-472c-48c4-b3e6-7718d1c85c02","spanId":"5b729670","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.168Z"}
[32m2026-01-17T15:55:47.183Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.183Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:55:47.184Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"4c49f479-472c-48c4-b3e6-7718d1c85c02","spanId":"5b729670","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":18,"timestamp":"2026-01-17T15:55:47.186Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"b862f37d-2f78-4619-a2a4-596c67df52c6","spanId":"757b7640","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.190Z"}
[32m2026-01-17T15:55:47.191Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.191Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:55:47.191Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"b862f37d-2f78-4619-a2a4-596c67df52c6","spanId":"757b7640","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:47.192Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"cb460111-de45-4ec0-bc43-4c10d5214ed0","spanId":"9a7a47d1","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.196Z"}
[32m2026-01-17T15:55:47.196Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.196Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:55:47.197Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"cb460111-de45-4ec0-bc43-4c10d5214ed0","spanId":"9a7a47d1","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:47.198Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"6a75261c-d3c7-405f-b337-593d9e382914","spanId":"2edbe8bb","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.216Z"}
[32m2026-01-17T15:55:47.224Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.224Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:55:47.234Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"6a75261c-d3c7-405f-b337-593d9e382914","spanId":"2edbe8bb","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":21,"timestamp":"2026-01-17T15:55:47.237Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"ce5e648e-32df-458e-80be-386dc4e99e8e","spanId":"3889303d","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.244Z"}
[32m2026-01-17T15:55:47.248Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.248Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:55:47.249Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"ce5e648e-32df-458e-80be-386dc4e99e8e","spanId":"3889303d","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:55:47.250Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"d2d04534-e592-4284-b67a-b4d7d1d2ec74","spanId":"c16c8c4b","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.255Z"}
[32m2026-01-17T15:55:47.255Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.255Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:55:47.256Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"d2d04534-e592-4284-b67a-b4d7d1d2ec74","spanId":"c16c8c4b","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:47.257Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"2dac6db9-c1f7-4b90-a85e-b41e4adb305d","spanId":"46fe6f05","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.269Z"}
[32m2026-01-17T15:55:47.270Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.270Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:55:47.275Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"2dac6db9-c1f7-4b90-a85e-b41e4adb305d","spanId":"46fe6f05","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:55:47.277Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"6f19cb0b-55c2-47ce-8f06-bab4a06a7d54","spanId":"d50505fb","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.281Z"}
[32m2026-01-17T15:55:47.282Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.282Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:55:47.282Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"6f19cb0b-55c2-47ce-8f06-bab4a06a7d54","spanId":"d50505fb","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:47.284Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"a2133f02-3692-4b95-ba8a-a3f7383c78b7","spanId":"ce468cce","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.288Z"}
[32m2026-01-17T15:55:47.288Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.288Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:55:47.288Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"a2133f02-3692-4b95-ba8a-a3f7383c78b7","spanId":"ce468cce","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:47.290Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"ad1d3b9c-b55d-4bef-9589-ee33ee86793c","spanId":"b3cf1454","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.294Z"}
[32m2026-01-17T15:55:47.296Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.295Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:55:47.296Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"ad1d3b9c-b55d-4bef-9589-ee33ee86793c","spanId":"b3cf1454","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.298Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"18baa4fc-f3d6-45d7-b9ed-acb4868d8c25","spanId":"b99fbc5e","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.306Z"}
[32m2026-01-17T15:55:47.306Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.306Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:55:47.306Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"18baa4fc-f3d6-45d7-b9ed-acb4868d8c25","spanId":"b99fbc5e","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:47.308Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"4f614473-2919-4c31-b78f-5f1fcc1387c5","spanId":"1974999f","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.312Z"}
[32m2026-01-17T15:55:47.313Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.313Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:55:47.313Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"4f614473-2919-4c31-b78f-5f1fcc1387c5","spanId":"1974999f","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:47.315Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 633[2mms[22m[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"a3e7a291-299b-43b2-805d-83a4ce729242","spanId":"f09e156c","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.314Z"}
[32m2026-01-17T15:55:47.318Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.318Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:55:47.329Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"a3e7a291-299b-43b2-805d-83a4ce729242","spanId":"f09e156c","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":35,"timestamp":"2026-01-17T15:55:47.349Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"29b1e790-2665-41d3-9285-67c6efc6f990","spanId":"e370915d","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.370Z"}
[32m2026-01-17T15:55:47.372Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.372Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:55:47.373Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"29b1e790-2665-41d3-9285-67c6efc6f990","spanId":"e370915d","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:55:47.377Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"d2259d72-db8a-4751-bca0-9463c61864e0","spanId":"784afa89","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.384Z"}
[32m2026-01-17T15:55:47.385Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.385Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:55:47.386Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"d2259d72-db8a-4751-bca0-9463c61864e0","spanId":"784afa89","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.388Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"d75b99af-1d55-4676-9e2d-13b6da5929d4","spanId":"a3095d8b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.400Z"}
[32m2026-01-17T15:55:47.401Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.401Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:55:47.402Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"d75b99af-1d55-4676-9e2d-13b6da5929d4","spanId":"a3095d8b","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:47.403Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"de4a6475-8cb5-468f-956d-579d184c247b","spanId":"68928761","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.409Z"}
[32m2026-01-17T15:55:47.412Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.412Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:55:47.413Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"de4a6475-8cb5-468f-956d-579d184c247b","spanId":"68928761","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:55:47.417Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"8b016f9f-d63b-4fdc-a3ee-7fac09a76ebf","spanId":"9b1b06a3","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.424Z"}
[32m2026-01-17T15:55:47.425Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.425Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:55:47.426Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"8b016f9f-d63b-4fdc-a3ee-7fac09a76ebf","spanId":"9b1b06a3","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:55:47.431Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"b5781946-0a7d-436d-a645-9f9aaaf9c1b6","spanId":"02462df3","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.436Z"}
[32m2026-01-17T15:55:47.437Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.437Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:55:47.439Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"b5781946-0a7d-436d-a645-9f9aaaf9c1b6","spanId":"02462df3","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.440Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"3c79371e-afe5-4f54-b6d7-4044a1e5ff28","spanId":"263c2eec","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.446Z"}
[32m2026-01-17T15:55:47.447Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.447Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:55:47.448Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"3c79371e-afe5-4f54-b6d7-4044a1e5ff28","spanId":"263c2eec","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.450Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"9f52af40-18a9-4544-b00c-897cfca7a2ce","spanId":"5802c6e8","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.467Z"}
[32m2026-01-17T15:55:47.468Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.468Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:55:47.469Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"9f52af40-18a9-4544-b00c-897cfca7a2ce","spanId":"5802c6e8","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:55:47.472Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"2d3b17ae-06ba-4403-9794-77979eff9407","spanId":"067d50ec","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.479Z"}
[32m2026-01-17T15:55:47.480Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.480Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:55:47.480Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"2d3b17ae-06ba-4403-9794-77979eff9407","spanId":"067d50ec","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:47.481Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"6378a940-d58f-49c5-a965-37fca281bf96","spanId":"9e83d6a5","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.493Z"}
[32m2026-01-17T15:55:47.494Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.494Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:55:47.495Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"6378a940-d58f-49c5-a965-37fca281bf96","spanId":"9e83d6a5","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:47.497Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"d7476a86-1151-48fb-85e8-7b48aaed4e90","spanId":"3257067b","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.502Z"}
[32m2026-01-17T15:55:47.503Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.503Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:55:47.503Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"d7476a86-1151-48fb-85e8-7b48aaed4e90","spanId":"3257067b","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:47.504Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"a7c8178c-faba-4421-b25e-2186a60c1c63","spanId":"5bce74b9","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.508Z"}
[32m2026-01-17T15:55:47.508Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.508Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:55:47.509Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"a7c8178c-faba-4421-b25e-2186a60c1c63","spanId":"5bce74b9","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:47.510Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"f238139b-ed8e-491d-9f67-c0eb92f970b4","spanId":"5fe70361","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.515Z"}
[32m2026-01-17T15:55:47.516Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.516Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:55:47.516Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"f238139b-ed8e-491d-9f67-c0eb92f970b4","spanId":"5fe70361","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:55:47.518Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"68d4f263-f26e-4aca-a577-d73a815f4521","spanId":"50d37176","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:47.525Z"}
[32m2026-01-17T15:55:47.526Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:47.526Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:55:47.526Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"68d4f263-f26e-4aca-a577-d73a815f4521","spanId":"50d37176","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":3,"timestamp":"2026-01-17T15:55:47.528Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 452[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 88[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 22[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 23[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 6[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 5 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:170:31
    168|         });
    169| 
    170|       expect(response.status).toBe(401);
       |                               ^
    171|     });
    172|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/5]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:179:31
    177|         .get('/api/frameworks/SOC2/controls');
    178| 
    179|       expect(response.status).toBe(401);
       |                               ^
    180|     });
    181|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/5]Î“Ã„Â»


[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m63 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:55:41
[2m   Duration [22m 25.73s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes/gapAnalysis.ts [22m[39m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:55:56.485Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:55:56.499Z [INFO] Registering Gap Analysis routes[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:55:56.497Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:55:56.512Z [INFO] Registering Gap Analysis routes[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"9a05b25f-464b-48c5-9c0b-af6c7ef49a31","spanId":"54e7a5ba","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.604Z"}
[32m2026-01-17T15:55:56.607Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.607Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:55:56.617Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"9a05b25f-464b-48c5-9c0b-af6c7ef49a31","spanId":"54e7a5ba","method":"GET","path":"/","statusCode":200,"duration":28,"timestamp":"2026-01-17T15:55:56.631Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:55:56.654Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"1c3e413a-3942-422d-a1d0-995a8eecdfdd","spanId":"2c45f13c","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.662Z"}
[32m2026-01-17T15:55:56.663Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.663Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:55:56.664Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:55:56.670Z [INFO] Registering Gap Analysis routes[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"1c3e413a-3942-422d-a1d0-995a8eecdfdd","spanId":"2c45f13c","method":"GET","path":"/","statusCode":200,"duration":11,"timestamp":"2026-01-17T15:55:56.673Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"18f17f59-dd9c-4df7-9bab-7fc4b6e4f40e","spanId":"f5a40ff0","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.687Z"}
[32m2026-01-17T15:55:56.688Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.688Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:55:56.689Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"18f17f59-dd9c-4df7-9bab-7fc4b6e4f40e","spanId":"f5a40ff0","method":"GET","path":"/iso-001","statusCode":200,"duration":4,"timestamp":"2026-01-17T15:55:56.691Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"d911a83e-58a6-4183-b9f6-51c2cdb5a634","spanId":"2ebdcdc4","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.711Z"}
[32m2026-01-17T15:55:56.712Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.712Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:55:56.713Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"d911a83e-58a6-4183-b9f6-51c2cdb5a634","spanId":"2ebdcdc4","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:55:56.719Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"bb2cb199-9663-447c-bc40-301101dbb2ca","spanId":"c5b2cd1b","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.726Z"}
[32m2026-01-17T15:55:56.726Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.726Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:55:56.727Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"bb2cb199-9663-447c-bc40-301101dbb2ca","spanId":"c5b2cd1b","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:56.729Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:55:56.730Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:55:56.743Z [INFO] Registering Gap Analysis routes[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"77f5608a-813c-4fad-8494-092c43470bfa","spanId":"e665af23","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.771Z"}
[32m2026-01-17T15:55:56.774Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.774Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"8e3c2e71-5d9b-4409-b114-a69ebc771c1e","spanId":"dc43f5ae","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.795Z"}
[32m2026-01-17T15:55:56.795Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.795Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:55:56.796Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"8e3c2e71-5d9b-4409-b114-a69ebc771c1e","spanId":"dc43f5ae","method":"POST","path":"/export-document","statusCode":200,"duration":24,"timestamp":"2026-01-17T15:55:56.819Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"9c4f5cb0-0977-4aff-afc7-f78a1f19065d","spanId":"e2e4574e","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.829Z"}
[32m2026-01-17T15:55:56.830Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.830Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:55:56.830Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"9c4f5cb0-0977-4aff-afc7-f78a1f19065d","spanId":"e2e4574e","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T15:55:56.832Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:55:56.830Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"15e26ef0-4980-42b1-9a55-6f1a2b3d644c","spanId":"b35d32dc","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.837Z"}
[32m2026-01-17T15:55:56.837Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.837Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:55:56.838Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"15e26ef0-4980-42b1-9a55-6f1a2b3d644c","spanId":"b35d32dc","method":"POST","path":"/api/generate-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:56.839Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"77f5608a-813c-4fad-8494-092c43470bfa","spanId":"e665af23","method":"POST","path":"/api/organizations","statusCode":401,"duration":74,"timestamp":"2026-01-17T15:55:56.845Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"0b20b380-2713-4e0f-9938-898352460e2d","spanId":"873dcec4","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.846Z"}
[32m2026-01-17T15:55:56.847Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.847Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"7df34135-abdd-46f2-b5c0-f3e1cbefe134","spanId":"0cb07655","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.856Z"}
[32m2026-01-17T15:55:56.857Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.857Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"f5fcc613-dc72-4f93-9120-955bd64fa0ad","spanId":"fa5779c4","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.851Z"}
[32m2026-01-17T15:55:56.856Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.856Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:55:56.858Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"7df34135-abdd-46f2-b5c0-f3e1cbefe134","spanId":"0cb07655","method":"GET","path":"/api/organizations","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:55:56.863Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T15:55:56.848Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:55:56.861Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"be5bc70e-8b9d-4647-8b59-973db7cc676c","spanId":"1d402635","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.875Z"}
[32m2026-01-17T15:55:56.876Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.876Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:55:56.877Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"be5bc70e-8b9d-4647-8b59-973db7cc676c","spanId":"1d402635","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:55:56.878Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:55:56.881Z [INFO] Registering Gap Analysis routes[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:55:56.875Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"f5fcc613-dc72-4f93-9120-955bd64fa0ad","spanId":"fa5779c4","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":35,"timestamp":"2026-01-17T15:55:56.885Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"45df7551-d069-4cb9-94b7-45b6f31a5ea5","spanId":"4b48529a","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.887Z"}
[32m2026-01-17T15:55:56.888Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.888Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:55:56.893Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"45df7551-d069-4cb9-94b7-45b6f31a5ea5","spanId":"4b48529a","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:55:56.895Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"0b20b380-2713-4e0f-9938-898352460e2d","spanId":"873dcec4","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":48,"timestamp":"2026-01-17T15:55:56.894Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"6acd9e66-db5e-4485-bb2a-c873b3c3c3a7","spanId":"e6ab6a83","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.902Z"}
[32m2026-01-17T15:55:56.903Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.903Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"23fff24a-fb31-474c-9373-4710a53471fa","spanId":"0888fe30","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.902Z"}
[32m2026-01-17T15:55:56.903Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.903Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:55:56.903Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"6acd9e66-db5e-4485-bb2a-c873b3c3c3a7","spanId":"e6ab6a83","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:56.905Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:55:56.904Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"23fff24a-fb31-474c-9373-4710a53471fa","spanId":"0888fe30","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:55:56.907Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"6ebdb8df-ca63-4c19-bfc7-c8c22a3d7e02","spanId":"aa12f7f5","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.911Z"}
[32m2026-01-17T15:55:56.912Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.912Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:55:56.912Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"6ebdb8df-ca63-4c19-bfc7-c8c22a3d7e02","spanId":"aa12f7f5","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:56.914Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"73afabec-1fec-4533-9972-6414a812c641","spanId":"f7d613d8","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.915Z"}
[32m2026-01-17T15:55:56.916Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.916Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:55:56.917Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"73afabec-1fec-4533-9972-6414a812c641","spanId":"f7d613d8","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:56.918Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"c153b1c3-72a5-47bc-8d6b-1fc442541c04","spanId":"0c1285d5","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.919Z"}
[32m2026-01-17T15:55:56.919Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.919Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:55:56.920Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"4f399060-07c0-455a-b10b-caf27b6283c7","spanId":"34934cb2","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.923Z"}
[32m2026-01-17T15:55:56.923Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.923Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"c153b1c3-72a5-47bc-8d6b-1fc442541c04","spanId":"0c1285d5","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:56.921Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:55:56.924Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"4f399060-07c0-455a-b10b-caf27b6283c7","spanId":"34934cb2","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:56.926Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"6272c5a2-f0ee-4c7a-b1a1-26f18253b717","spanId":"b1bc6c77","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.927Z"}
[32m2026-01-17T15:55:56.927Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.927Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:55:56.928Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"da99fd2e-a731-46fd-8eb8-d164ab4e800c","spanId":"d477f7e5","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.932Z"}
[32m2026-01-17T15:55:56.932Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.932Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"6272c5a2-f0ee-4c7a-b1a1-26f18253b717","spanId":"b1bc6c77","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:56.930Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:55:56.933Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"da99fd2e-a731-46fd-8eb8-d164ab4e800c","spanId":"d477f7e5","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:56.935Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"7369c898-add5-4a06-ba22-8bb7682d1efb","spanId":"ffd86e62","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.941Z"}
[32m2026-01-17T15:55:56.942Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.942Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"4b06b986-72d3-41a4-9ef4-8238f5e0f086","spanId":"1728ddad","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.945Z"}
[32m2026-01-17T15:55:56.946Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.946Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:55:56.944Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"7369c898-add5-4a06-ba22-8bb7682d1efb","spanId":"ffd86e62","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:55:56.946Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:55:56.947Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"4b06b986-72d3-41a4-9ef4-8238f5e0f086","spanId":"1728ddad","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:56.949Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"c962d0d3-c163-4fcc-98a0-54821c6ee266","spanId":"5d4f3257","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.953Z"}
[32m2026-01-17T15:55:56.954Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.954Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:55:56.955Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.955Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:55:56.956Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:55:56.954Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"c962d0d3-c163-4fcc-98a0-54821c6ee266","spanId":"5d4f3257","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:56.956Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:55:56.957Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:55:56.975Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.975Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:55:56.979Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"709ed182-8d56-49d6-9bef-fce72191a59d","spanId":"c6213bfb","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:56.992Z"}
[32m2026-01-17T15:55:56.993Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:56.993Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:55:56.994Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"709ed182-8d56-49d6-9bef-fce72191a59d","spanId":"c6213bfb","method":"GET","path":"/api/auth/user","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:55:57.006Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"374f79ab-2a67-4214-9d61-b4c7d8efb74e","spanId":"2cbe4b30","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.006Z"}
[32m2026-01-17T15:55:57.007Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.007Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:55:57.007Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"374f79ab-2a67-4214-9d61-b4c7d8efb74e","spanId":"2cbe4b30","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.009Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"a6997fb1-5c57-49b4-870c-0465cc859143","spanId":"627ead35","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.013Z"}
[32m2026-01-17T15:55:57.014Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.014Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"485fc390-3b14-4adc-9bf2-99e2ee8d5e66","spanId":"aeb2372a","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.014Z"}
[32m2026-01-17T15:55:57.015Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.015Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"6903b526-0216-4073-ab20-ee14bde758e0","spanId":"a47717bc","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.014Z"}
[32m2026-01-17T15:55:57.015Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.015Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:55:57.014Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:55:57.015Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"485fc390-3b14-4adc-9bf2-99e2ee8d5e66","spanId":"aeb2372a","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.017Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:55:57.016Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"a6997fb1-5c57-49b4-870c-0465cc859143","spanId":"627ead35","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:57.017Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"6903b526-0216-4073-ab20-ee14bde758e0","spanId":"a47717bc","method":"POST","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:57.018Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"13036caa-ac00-4ff2-b769-ddf72446f721","spanId":"9191b23a","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.023Z"}
[32m2026-01-17T15:55:57.024Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.024Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"9f4faa5d-f9d5-43a1-9f91-448942187bb4","spanId":"8df709a6","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.025Z"}
[32m2026-01-17T15:55:57.025Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.025Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:55:57.024Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"13036caa-ac00-4ff2-b769-ddf72446f721","spanId":"9191b23a","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:57.025Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:55:57.026Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"9f4faa5d-f9d5-43a1-9f91-448942187bb4","spanId":"8df709a6","method":"GET","path":"/api/evidence","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:57.027Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 633[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"7e37f358-021e-43e0-bf6a-a9a5dfcde8da","spanId":"83f81420","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.031Z"}
[32m2026-01-17T15:55:57.032Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.032Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:55:57.032Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"7e37f358-021e-43e0-bf6a-a9a5dfcde8da","spanId":"83f81420","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:57.034Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"0496ae0f-c51f-42bc-99b2-7eca4de3030c","spanId":"9dec8de3","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.058Z"}
[32m2026-01-17T15:55:57.061Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.061Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:55:57.062Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"0496ae0f-c51f-42bc-99b2-7eca4de3030c","spanId":"9dec8de3","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:55:57.065Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"34d18aa4-8adf-4897-bf61-30e21f8fb01a","spanId":"48137cc0","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.094Z"}
[32m2026-01-17T15:55:57.095Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.095Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"820f268b-11a5-4703-b4a1-77b4423d7058","spanId":"d4254a7f","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.096Z"}
[32m2026-01-17T15:55:57.097Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.097Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:55:57.095Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"34d18aa4-8adf-4897-bf61-30e21f8fb01a","spanId":"48137cc0","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.097Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:55:57.098Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"820f268b-11a5-4703-b4a1-77b4423d7058","spanId":"d4254a7f","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.099Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"7730b3a6-08dc-4789-8246-fa98574c364e","spanId":"925a25e5","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.104Z"}
[32m2026-01-17T15:55:57.105Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.105Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:55:57.106Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"7730b3a6-08dc-4789-8246-fa98574c364e","spanId":"925a25e5","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:57.108Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"26fb1b7f-24df-4204-b1e5-c0c44e6ec1ff","spanId":"62a08bcf","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.109Z"}
[32m2026-01-17T15:55:57.110Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.110Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:55:57.110Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"26fb1b7f-24df-4204-b1e5-c0c44e6ec1ff","spanId":"62a08bcf","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.112Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"e241237d-13ec-426d-90b0-2a6ced8cce05","spanId":"5074443d","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.117Z"}
[32m2026-01-17T15:55:57.122Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.122Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:55:57.123Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"e241237d-13ec-426d-90b0-2a6ced8cce05","spanId":"5074443d","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:55:57.124Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"a6c3824e-cc77-4752-ad6f-5c912485fa40","spanId":"cc90397b","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.128Z"}
[32m2026-01-17T15:55:57.129Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.129Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"346d717f-c56d-40d8-9f17-be042a598ff4","spanId":"9d334034","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.128Z"}
[32m2026-01-17T15:55:57.129Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.129Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:55:57.129Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"346d717f-c56d-40d8-9f17-be042a598ff4","spanId":"9d334034","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.131Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:55:57.130Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"a6c3824e-cc77-4752-ad6f-5c912485fa40","spanId":"cc90397b","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:57.132Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"06abeb7e-149a-4608-a2d0-51dc864a0246","spanId":"cafa296d","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.136Z"}
[32m2026-01-17T15:55:57.137Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.137Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"92d07393-ced4-4720-bdf3-a2141af87c82","spanId":"537063f4","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.136Z"}
[32m2026-01-17T15:55:57.136Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.136Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:55:57.137Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:55:57.136Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"70e96548-0c88-41fe-8bab-7a5890b7c264","spanId":"2c07f639","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.138Z"}
[32m2026-01-17T15:55:57.139Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.139Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"06abeb7e-149a-4608-a2d0-51dc864a0246","spanId":"cafa296d","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:57.138Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"92d07393-ced4-4720-bdf3-a2141af87c82","spanId":"537063f4","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:57.137Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:55:57.140Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"70e96548-0c88-41fe-8bab-7a5890b7c264","spanId":"2c07f639","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.141Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"eb00091d-7ddc-45bc-84d7-102a2021f666","spanId":"9d6b04a3","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.143Z"}
[32m2026-01-17T15:55:57.143Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.143Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:55:57.143Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"eb00091d-7ddc-45bc-84d7-102a2021f666","spanId":"9d6b04a3","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:57.145Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"cb28f24a-5766-4129-815a-8d2dc3024849","spanId":"6b455eb2","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.148Z"}
[32m2026-01-17T15:55:57.148Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.148Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"c738f12c-5cb4-49fa-b563-279b0b248f76","spanId":"3d375b98","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.148Z"}
[32m2026-01-17T15:55:57.149Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.149Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:55:57.149Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:55:57.149Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"160fc64d-d396-4f65-b568-af0e2ee540af","spanId":"30c4fe49","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.148Z"}
[32m2026-01-17T15:55:57.149Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.149Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:55:57.149Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"c738f12c-5cb4-49fa-b563-279b0b248f76","spanId":"3d375b98","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:55:57.159Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"cb28f24a-5766-4129-815a-8d2dc3024849","spanId":"6b455eb2","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:55:57.159Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:55:57.157Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"160fc64d-d396-4f65-b568-af0e2ee540af","spanId":"30c4fe49","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:55:57.159Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"166de693-33b5-49ea-b160-5feb5aa368f6","spanId":"c8a18633","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.162Z"}
[32m2026-01-17T15:55:57.163Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.163Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:55:57.163Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"166de693-33b5-49ea-b160-5feb5aa368f6","spanId":"c8a18633","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:57.164Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"e18b8403-128d-4592-b1d7-fdc15b9b674d","spanId":"a4c8c1d0","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.164Z"}
[32m2026-01-17T15:55:57.165Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.165Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"12340cea-0978-4f1d-8375-d971669075c7","spanId":"523ae828","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.164Z"}
[32m2026-01-17T15:55:57.165Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.165Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:55:57.165Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"e18b8403-128d-4592-b1d7-fdc15b9b674d","spanId":"a4c8c1d0","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:55:57.166Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:55:57.165Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"12340cea-0978-4f1d-8375-d971669075c7","spanId":"523ae828","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.167Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"46e0ffe4-a4c7-4b59-9f95-442f2b3b624c","spanId":"33a114ad","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.172Z"}
[32m2026-01-17T15:55:57.172Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.172Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"21ad10d5-2526-42e7-9abb-70fae291e72f","spanId":"d7ad1804","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.172Z"}
[32m2026-01-17T15:55:57.173Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.173Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:55:57.173Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:55:57.173Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"21ad10d5-2526-42e7-9abb-70fae291e72f","spanId":"d7ad1804","method":"GET","path":"/api/auth/user","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.175Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"46e0ffe4-a4c7-4b59-9f95-442f2b3b624c","spanId":"33a114ad","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:55:57.174Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:55:57.175Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.175Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:55:57.179Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"3268d804-aefb-4520-a17b-4562b8522fe1","spanId":"3fdfb22b","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.181Z"}
[32m2026-01-17T15:55:57.183Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.183Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:55:57.184Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"3268d804-aefb-4520-a17b-4562b8522fe1","spanId":"3fdfb22b","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:55:57.186Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"93e23db1-5dba-4767-abae-0518ac258bab","spanId":"a5327861","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.190Z"}
[32m2026-01-17T15:55:57.191Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.191Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"e534b024-d10d-4212-a4d5-ec366751c780","spanId":"49e741cb","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.190Z"}
[32m2026-01-17T15:55:57.191Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.191Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:55:57.191Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"93e23db1-5dba-4767-abae-0518ac258bab","spanId":"a5327861","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.193Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"bab627df-e371-4e4c-963c-9c70afd9b55e","spanId":"889f42b5","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.198Z"}
[32m2026-01-17T15:55:57.198Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.198Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:55:57.199Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"f44c3b64-9c5a-40bf-99ab-7d45f8b6fb4f","spanId":"9777eba9","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.198Z"}
[32m2026-01-17T15:55:57.199Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.199Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"bab627df-e371-4e4c-963c-9c70afd9b55e","spanId":"889f42b5","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:57.200Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:55:57.199Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"f44c3b64-9c5a-40bf-99ab-7d45f8b6fb4f","spanId":"9777eba9","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":2,"timestamp":"2026-01-17T15:55:57.200Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"72ebbbf0-ddf3-4fc0-afc8-389865a6b4e1","spanId":"6fd23481","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.205Z"}
[32m2026-01-17T15:55:57.205Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.205Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:55:57.206Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"72ebbbf0-ddf3-4fc0-afc8-389865a6b4e1","spanId":"6fd23481","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:55:57.207Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:55:57.192Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:55:57.209Z [ERROR] Database health check failed {"error":"Unknown error"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 670[2mms[22m[39m
[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"e534b024-d10d-4212-a4d5-ec366751c780","spanId":"49e741cb","method":"GET","path":"/api/auth/user","statusCode":401,"duration":20,"timestamp":"2026-01-17T15:55:57.210Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 550[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 83[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 109[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 32[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 22[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 6[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 22[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 7[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 17[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[39m[32m 25[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"31b86a10-6794-48fc-9f12-5873dca706fb","spanId":"6e13cfce","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.218Z"}
[32m2026-01-17T15:55:57.219Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.219Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:55:57.220Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"31b86a10-6794-48fc-9f12-5873dca706fb","spanId":"6e13cfce","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:55:57.228Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:55:57.234Z [ERROR] Database health check failed {"error":"Unknown error"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 839[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check [33m 391[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 23[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 49[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 76[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 17[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 8[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 39[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 22[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"bb1121fe-c4d4-4513-bbe2-9195b57f259a","spanId":"af761e69","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.245Z"}
[32m2026-01-17T15:55:57.245Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.245Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:55:57.246Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"bb1121fe-c4d4-4513-bbe2-9195b57f259a","spanId":"af761e69","method":"GET","path":"/api/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:55:57.248Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"e5be2c80-0980-4c15-a94b-f854b1adb3bd","spanId":"9d2232ad","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:55:57.273Z"}
[32m2026-01-17T15:55:57.274Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:55:57.274Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:55:57.274Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"e5be2c80-0980-4c15-a94b-f854b1adb3bd","spanId":"9d2232ad","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:55:57.277Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 587[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 5 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:170:31
    168|         });
    169| 
    170|       expect(response.status).toBe(401);
       |                               ^
    171|     });
    172|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/5]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:179:31
    177|         .get('/api/frameworks/SOC2/controls');
    178| 
    179|       expect(response.status).toBe(401);
       |                               ^
    180|     });
    181|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/5]Î“Ã„Â»


[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m63 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:55:52
[2m   Duration [22m 24.11s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes/gapAnalysis.ts [22m[39m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:56:54.464Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:56:54.478Z [INFO] Initializing Gap Analysis router[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"41e465cb-e74b-4a33-9853-a8d4a537e305","spanId":"188780fc","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.591Z"}
[32m2026-01-17T15:56:54.596Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.596Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:56:54.615Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"41e465cb-e74b-4a33-9853-a8d4a537e305","spanId":"188780fc","method":"POST","path":"/api/organizations","statusCode":401,"duration":43,"timestamp":"2026-01-17T15:56:54.633Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:56:54.678Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"6d85632a-be96-4d4b-9268-91eb5d3803f6","spanId":"329a22f9","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.689Z"}
[32m2026-01-17T15:56:54.690Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.690Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:56:54.691Z [INFO] Initializing Gap Analysis router[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:56:54.691Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"6d85632a-be96-4d4b-9268-91eb5d3803f6","spanId":"329a22f9","method":"GET","path":"/api/organizations","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:56:54.695Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"5a0f9433-c342-48ea-bbe7-0f14f5c95439","spanId":"b35eb9be","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.704Z"}
[32m2026-01-17T15:56:54.705Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.705Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:56:54.705Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"5a0f9433-c342-48ea-bbe7-0f14f5c95439","spanId":"b35eb9be","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:54.707Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:56:54.707Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"11e40b92-0c02-449c-a0bd-76a46daf09eb","spanId":"e94fa9db","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.714Z"}
[32m2026-01-17T15:56:54.714Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.714Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:56:54.715Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"11e40b92-0c02-449c-a0bd-76a46daf09eb","spanId":"e94fa9db","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:54.717Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:56:54.718Z [INFO] Initializing Gap Analysis router[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"ee6c6636-cbb0-4fcd-9dd6-b89ef35f9e1f","spanId":"5b476423","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.765Z"}
[32m2026-01-17T15:56:54.765Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.765Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:56:54.766Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"ee6c6636-cbb0-4fcd-9dd6-b89ef35f9e1f","spanId":"5b476423","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:54.768Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:56:54.771Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"a4361d28-567c-44bb-891d-865200ef8659","spanId":"3c893974","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.778Z"}
[32m2026-01-17T15:56:54.779Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.779Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:56:54.780Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"a4361d28-567c-44bb-891d-865200ef8659","spanId":"3c893974","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:56:54.782Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:56:54.783Z [INFO] Initializing Gap Analysis router[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"d1824553-0725-410e-a60c-5f985e104180","spanId":"5631795e","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.805Z"}
[32m2026-01-17T15:56:54.809Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.809Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"9c9f47c1-6aba-40e5-bc70-c56274fa0c0b","spanId":"52b32d5b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.804Z"}
[32m2026-01-17T15:56:54.810Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.810Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:56:54.821Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"d1824553-0725-410e-a60c-5f985e104180","spanId":"5631795e","method":"GET","path":"/","statusCode":200,"duration":29,"timestamp":"2026-01-17T15:56:54.834Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:56:54.879Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"34b5f967-0046-4620-ab9f-718ba8c0b9d2","spanId":"a2d4a5ec","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.862Z"}
[32m2026-01-17T15:56:54.863Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.863Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:56:54.864Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"34b5f967-0046-4620-ab9f-718ba8c0b9d2","spanId":"a2d4a5ec","method":"GET","path":"/","statusCode":200,"duration":12,"timestamp":"2026-01-17T15:56:54.874Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:56:54.875Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"e7a7e041-575f-4107-90f9-5ed51b17aafc","spanId":"01651307","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.888Z"}
[32m2026-01-17T15:56:54.889Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.889Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T15:56:54.884Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:56:54.890Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"9c9f47c1-6aba-40e5-bc70-c56274fa0c0b","spanId":"52b32d5b","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":87,"timestamp":"2026-01-17T15:56:54.891Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"e7a7e041-575f-4107-90f9-5ed51b17aafc","spanId":"01651307","method":"GET","path":"/iso-001","statusCode":200,"duration":6,"timestamp":"2026-01-17T15:56:54.894Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:56:54.894Z [INFO] Initializing Gap Analysis router[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"c45faee1-dfb6-45b2-9132-6be4f6b319e5","spanId":"739147e0","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.906Z"}
[32m2026-01-17T15:56:54.907Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.907Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:56:54.908Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"c45faee1-dfb6-45b2-9132-6be4f6b319e5","spanId":"739147e0","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:56:54.910Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"23fdec62-1bf9-45df-acf0-8b6f9cff3941","spanId":"36491c44","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.912Z"}
[32m2026-01-17T15:56:54.913Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.913Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"94005020-1893-4ca2-8e5c-04d61f437fee","spanId":"846797da","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.916Z"}
[32m2026-01-17T15:56:54.916Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.916Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:56:54.915Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m
[32m2026-01-17T15:56:54.916Z [INFO] Gap Analysis router hit {"path":"/recommendations/test-id","originalUrl":"/api/gap-analysis/recommendations/test-id","baseUrl":"/api/gap-analysis","method":"PATCH"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"23fdec62-1bf9-45df-acf0-8b6f9cff3941","spanId":"36491c44","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:56:54.918Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:56:54.921Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.921Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:56:54.922Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:56:54.917Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"94005020-1893-4ca2-8e5c-04d61f437fee","spanId":"846797da","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:56:54.923Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"74d8a578-532f-421f-a5a8-b7791dd63afa","spanId":"9db12f8d","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.924Z"}
[32m2026-01-17T15:56:54.925Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.925Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:56:54.926Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"74d8a578-532f-421f-a5a8-b7791dd63afa","spanId":"9db12f8d","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:56:54.928Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"e8a47512-077a-48cd-a4b5-10a8f9cb8dfa","spanId":"dceb88e4","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.934Z"}
[32m2026-01-17T15:56:54.935Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.934Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:56:54.935Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"e8a47512-077a-48cd-a4b5-10a8f9cb8dfa","spanId":"dceb88e4","method":"POST","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:56:54.938Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"e89bb508-d803-49f4-ae35-b476402b89d3","spanId":"f27dd2ac","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.940Z"}
[32m2026-01-17T15:56:54.941Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.941Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:56:54.942Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"db020afc-a3e4-44e8-89ea-0f68ec562f7b","spanId":"85374240","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.943Z"}
[32m2026-01-17T15:56:54.944Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.944Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m[32m2026-01-17T15:56:54.943Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"e89bb508-d803-49f4-ae35-b476402b89d3","spanId":"f27dd2ac","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:56:54.944Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"dfdec88a-30f8-42c5-8e8c-afe13acbd948","spanId":"a797fdc4","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.944Z"}
[32m2026-01-17T15:56:54.944Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.944Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:56:54.944Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:56:54.945Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"db020afc-a3e4-44e8-89ea-0f68ec562f7b","spanId":"85374240","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:54.946Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"dfdec88a-30f8-42c5-8e8c-afe13acbd948","spanId":"a797fdc4","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:54.947Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"05fe6679-e0c9-4565-b45d-d6c2a0d87496","spanId":"bceb173e","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.953Z"}
[32m2026-01-17T15:56:54.954Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.954Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"eb5b512a-5ce9-4fb6-8ad2-1148fcc679b3","spanId":"ec8b614d","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.954Z"}
[32m2026-01-17T15:56:54.955Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.954Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:56:54.954Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m[32m2026-01-17T15:56:54.955Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"05fe6679-e0c9-4565-b45d-d6c2a0d87496","spanId":"bceb173e","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:54.956Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:56:54.955Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"eb5b512a-5ce9-4fb6-8ad2-1148fcc679b3","spanId":"ec8b614d","method":"POST","path":"/export-document","statusCode":200,"duration":4,"timestamp":"2026-01-17T15:56:54.958Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"37e74778-ce51-4b3f-8721-164e91f4bbec","spanId":"fc28e2f2","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.958Z"}
[32m2026-01-17T15:56:54.959Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.959Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:56:54.960Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"37e74778-ce51-4b3f-8721-164e91f4bbec","spanId":"fc28e2f2","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:54.961Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"913cd900-d2fb-4626-9b74-b98ac59bbb05","spanId":"baa1c757","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.965Z"}
[32m2026-01-17T15:56:54.966Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.966Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:56:54.966Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"913cd900-d2fb-4626-9b74-b98ac59bbb05","spanId":"baa1c757","method":"POST","path":"/export-document","statusCode":400,"duration":4,"timestamp":"2026-01-17T15:56:54.969Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"12c538c2-af72-4255-810b-68673e9b2dd2","spanId":"b9df667e","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.969Z"}
[32m2026-01-17T15:56:54.969Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.969Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:56:54.970Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"12c538c2-af72-4255-810b-68673e9b2dd2","spanId":"b9df667e","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:54.971Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"f100ad32-e6dd-45b4-83a8-ea32a46cd175","spanId":"d63529e1","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.976Z"}
[32m2026-01-17T15:56:54.977Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.977Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:56:54.977Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"9013c1ee-18a5-4de6-ae63-392464d262e3","spanId":"262d299b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.977Z"}
[32m2026-01-17T15:56:54.978Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.978Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"027ee9c9-efc9-4bfa-9381-3623dd5bcec7","spanId":"d5f9fded","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.979Z"}
[32m2026-01-17T15:56:54.979Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.979Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"f100ad32-e6dd-45b4-83a8-ea32a46cd175","spanId":"d63529e1","method":"POST","path":"/api/generate-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:54.979Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:56:54.979Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m[32m2026-01-17T15:56:54.979Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:56:54.980Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"9013c1ee-18a5-4de6-ae63-392464d262e3","spanId":"262d299b","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:56:54.981Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"027ee9c9-efc9-4bfa-9381-3623dd5bcec7","spanId":"d5f9fded","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:54.981Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"3bc73070-4629-441f-b987-6f91672cddc3","spanId":"adbe0321","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.987Z"}
[32m2026-01-17T15:56:54.988Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.988Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:56:54.990Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"fc2216b3-40db-455a-86a1-ed0f7700e3a3","spanId":"c0a150fe","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.987Z"}
[32m2026-01-17T15:56:54.991Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.991Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"3bc73070-4629-441f-b987-6f91672cddc3","spanId":"adbe0321","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:56:54.992Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:56:54.992Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m[32m2026-01-17T15:56:54.993Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"fc2216b3-40db-455a-86a1-ed0f7700e3a3","spanId":"c0a150fe","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:56:54.994Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"21e478cb-dd20-4032-8a1f-1677493940ab","spanId":"6bc22a26","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.994Z"}
[32m2026-01-17T15:56:54.994Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.994Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"67651848-5336-4214-9be4-6f13b07d4948","spanId":"c05495bc","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:54.997Z"}
[32m2026-01-17T15:56:54.997Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:54.997Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T15:56:54.996Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"21e478cb-dd20-4032-8a1f-1677493940ab","spanId":"6bc22a26","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:56:54.998Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:56:54.998Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"67651848-5336-4214-9be4-6f13b07d4948","spanId":"c05495bc","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:54.999Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"a7cdc323-88dc-4296-9353-1c8e1638a885","spanId":"1aeadc6a","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.004Z"}
[32m2026-01-17T15:56:55.005Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.005Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"c9acf300-eb9f-41a2-8f8c-639eb056e87a","spanId":"fb0c2200","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.004Z"}
[32m2026-01-17T15:56:55.005Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.005Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:56:55.006Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:56:55.006Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"a7cdc323-88dc-4296-9353-1c8e1638a885","spanId":"1aeadc6a","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:55.007Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"c9acf300-eb9f-41a2-8f8c-639eb056e87a","spanId":"fb0c2200","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:56:55.008Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"5feb8f55-61dc-4642-8169-8455575d4b69","spanId":"d368d03b","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.009Z"}
[32m2026-01-17T15:56:55.010Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.010Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:56:55.010Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"5feb8f55-61dc-4642-8169-8455575d4b69","spanId":"d368d03b","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:55.012Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"c3629249-0ee7-4ecc-81ec-4cdc4b0f1eee","spanId":"c71546ba","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.016Z"}
[32m2026-01-17T15:56:55.016Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.016Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"f991d4e6-a46a-40e4-9264-fb06e8cdcdbc","spanId":"f7eb0f85","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.016Z"}
[32m2026-01-17T15:56:55.016Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.016Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:56:55.017Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"d9c12176-85a4-404a-8c91-39b1b93079e5","spanId":"d90fc90c","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.018Z"}
[32m2026-01-17T15:56:55.018Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.018Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"c3629249-0ee7-4ecc-81ec-4cdc4b0f1eee","spanId":"c71546ba","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:55.018Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:56:55.019Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:56:55.017Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m
[32m2026-01-17T15:56:55.018Z [INFO] Gap Analysis router hit {"path":"/reports","originalUrl":"/api/gap-analysis/reports","baseUrl":"/api/gap-analysis","method":"GET"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"d9c12176-85a4-404a-8c91-39b1b93079e5","spanId":"d90fc90c","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:55.020Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"f991d4e6-a46a-40e4-9264-fb06e8cdcdbc","spanId":"f7eb0f85","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:56:55.020Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:56:55.022Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"2bf47b15-ee27-4eca-8e41-8eba2cd5371a","spanId":"91425f91","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.024Z"}
[32m2026-01-17T15:56:55.024Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.024Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"db147fa7-e41f-4be7-8bd7-13fb8a5503f2","spanId":"27227e8d","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.024Z"}
[32m2026-01-17T15:56:55.025Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.025Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:56:55.025Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"2bf47b15-ee27-4eca-8e41-8eba2cd5371a","spanId":"91425f91","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:55.026Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:56:55.025Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T15:56:55.025Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"GET"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"db147fa7-e41f-4be7-8bd7-13fb8a5503f2","spanId":"27227e8d","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:55.027Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"07fc1ec8-78ec-49b9-8f9a-a66f4bd5fb48","spanId":"0bd3c685","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.027Z"}
[32m2026-01-17T15:56:55.027Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.027Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"b6a0c2ea-b865-492b-bbd1-92ef1bda8075","spanId":"d4338c03","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.032Z"}
[32m2026-01-17T15:56:55.032Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.032Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:56:55.033Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"b6a0c2ea-b865-492b-bbd1-92ef1bda8075","spanId":"d4338c03","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:55.034Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:56:55.033Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m
[32m2026-01-17T15:56:55.034Z [INFO] Gap Analysis router hit {"path":"/reports/test-report-id","originalUrl":"/api/gap-analysis/reports/test-report-id","baseUrl":"/api/gap-analysis","method":"GET"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"e64c0101-ee2b-4927-baaf-7e80608d0038","spanId":"d9e81ea6","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.037Z"}
[32m2026-01-17T15:56:55.038Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.038Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"07fc1ec8-78ec-49b9-8f9a-a66f4bd5fb48","spanId":"0bd3c685","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:56:55.038Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"2b0f41ea-a385-4580-a15f-f13f7471eb2b","spanId":"67e753a6","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.038Z"}
[32m2026-01-17T15:56:55.039Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.039Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:56:55.038Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m
[32m2026-01-17T15:56:55.039Z [INFO] Gap Analysis router hit {"path":"/ISO27001","originalUrl":"/api/gap-analysis/ISO27001","baseUrl":"/api/gap-analysis","method":"GET"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"e64c0101-ee2b-4927-baaf-7e80608d0038","spanId":"d9e81ea6","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:55.040Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:56:55.039Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"2b0f41ea-a385-4580-a15f-f13f7471eb2b","spanId":"67e753a6","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:55.041Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:56:55.044Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.044Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"64036119-9f97-4d90-8a2b-de5bf60740f2","spanId":"51aebae4","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.047Z"}
[32m2026-01-17T15:56:55.047Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.047Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:56:55.048Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"b5fec084-84ad-4a2c-9833-7caffa8267a8","spanId":"a02f2550","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.048Z"}
[32m2026-01-17T15:56:55.048Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.048Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"64036119-9f97-4d90-8a2b-de5bf60740f2","spanId":"51aebae4","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:55.049Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:56:55.048Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:56:55.049Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"b5fec084-84ad-4a2c-9833-7caffa8267a8","spanId":"a02f2550","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:55.050Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"124729b7-4054-4769-a7dc-2aa6eb47bc39","spanId":"e55951d3","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.051Z"}
[32m2026-01-17T15:56:55.052Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.052Z"}[0m

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 397[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"9165bfca-b024-43e8-b4b2-f2fd2812751d","spanId":"1d23b328","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.053Z"}
[32m2026-01-17T15:56:55.054Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.054Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:56:55.054Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:56:55.053Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m
[32m2026-01-17T15:56:55.054Z [INFO] Gap Analysis router hit {"path":"/recommendations/test-rec-id","originalUrl":"/api/gap-analysis/recommendations/test-rec-id","baseUrl":"/api/gap-analysis","method":"PATCH"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"9165bfca-b024-43e8-b4b2-f2fd2812751d","spanId":"1d23b328","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:55.055Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"124729b7-4054-4769-a7dc-2aa6eb47bc39","spanId":"e55951d3","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:56:55.055Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"0d7c7dbf-b168-4c8a-b1b3-3f70cbf30fc0","spanId":"20a31608","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.058Z"}
[32m2026-01-17T15:56:55.059Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.059Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"f7698ad8-2b39-4db8-9d4a-8ec2c35e4d6b","spanId":"a9b965e3","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.064Z"}
[32m2026-01-17T15:56:55.065Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.065Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:56:55.060Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:56:55.065Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"0d7c7dbf-b168-4c8a-b1b3-3f70cbf30fc0","spanId":"20a31608","method":"GET","path":"/api/auth/user","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:56:55.066Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"f7698ad8-2b39-4db8-9d4a-8ec2c35e4d6b","spanId":"a9b965e3","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:56:55.067Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"da830f7e-6519-4292-99f3-c9b21401a77c","spanId":"7411a85a","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.066Z"}
[32m2026-01-17T15:56:55.067Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.067Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:56:55.066Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:56:55.067Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"da830f7e-6519-4292-99f3-c9b21401a77c","spanId":"7411a85a","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:55.069Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 694[2mms[22m[39m
[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"3b9dc825-c282-4a6b-bcee-4f5b5f78081b","spanId":"3f9cb1a9","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.071Z"}
[32m2026-01-17T15:56:55.072Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.072Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:56:55.073Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"0f6fdddc-aca2-4067-8495-c0fe588b6684","spanId":"3980268b","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.074Z"}
[32m2026-01-17T15:56:55.075Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.075Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"3b9dc825-c282-4a6b-bcee-4f5b5f78081b","spanId":"3f9cb1a9","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:56:55.075Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:56:55.075Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"0f6fdddc-aca2-4067-8495-c0fe588b6684","spanId":"3980268b","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:55.077Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"47c82e3b-312f-435c-9fb2-105af56e6bbd","spanId":"131c28e3","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.082Z"}
[32m2026-01-17T15:56:55.083Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.083Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"e5b49a91-a469-40ff-bd58-de377a667a8e","spanId":"20c8923b","method":"POST","path":"/api/ai/analyze-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.083Z"}
[32m2026-01-17T15:56:55.083Z [INFO] POST /api/ai/analyze-gaps {"method":"POST","url":"/api/ai/analyze-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.083Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:56:55.088Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.088Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:56:55.084Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:56:55.084Z [INFO] API route accessed {"path":"/api/ai/analyze-gaps","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"47c82e3b-312f-435c-9fb2-105af56e6bbd","spanId":"131c28e3","method":"GET","path":"/api/documents","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:56:55.087Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"e5b49a91-a469-40ff-bd58-de377a667a8e","spanId":"20c8923b","method":"POST","path":"/api/ai/analyze-gaps","statusCode":404,"duration":4,"timestamp":"2026-01-17T15:56:55.086Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:56:55.092Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"79071d57-6d73-4deb-9000-5e29fcdfd86f","spanId":"d842b610","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.103Z"}
[32m2026-01-17T15:56:55.104Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.104Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"82718770-308b-4550-8fe7-7280fc671b88","spanId":"290b454c","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.117Z"}
[32m2026-01-17T15:56:55.117Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.117Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:56:55.118Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"82718770-308b-4550-8fe7-7280fc671b88","spanId":"290b454c","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:55.120Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:56:55.105Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"79071d57-6d73-4deb-9000-5e29fcdfd86f","spanId":"d842b610","method":"GET","path":"/api/auth/user","statusCode":401,"duration":22,"timestamp":"2026-01-17T15:56:55.126Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"d90f863d-5aed-488c-808e-de8da9e2bff8","spanId":"21e41980","method":"GET","path":"/api/frameworks/SOC2/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.128Z"}
[32m2026-01-17T15:56:55.129Z [INFO] GET /api/frameworks/SOC2/controls {"method":"GET","url":"/api/frameworks/SOC2/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.129Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:56:55.129Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/controls","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"d90f863d-5aed-488c-808e-de8da9e2bff8","spanId":"21e41980","method":"GET","path":"/api/frameworks/SOC2/controls","statusCode":404,"duration":6,"timestamp":"2026-01-17T15:56:55.134Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 524[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis[32m 145[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request[32m 24[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report[32m 25[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score[32m 8[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis[39m[32m 24[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
[31m   [31mâ”œÃ¹[31m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements[39m[32m 34[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 404 to be 401 // Object.is equality[39m
 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 429[2mms[22m[39m
[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"b13f97b3-be77-4f3f-8add-d76598b0dd24","spanId":"af2d2f2a","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.135Z"}
[32m2026-01-17T15:56:55.147Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.147Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:56:55.148Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"b13f97b3-be77-4f3f-8add-d76598b0dd24","spanId":"af2d2f2a","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":16,"timestamp":"2026-01-17T15:56:55.151Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"6051a0f4-5dc4-4f5a-9d04-9910216b9fc6","spanId":"74b450f2","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.176Z"}
[32m2026-01-17T15:56:55.177Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.177Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:56:55.178Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"6051a0f4-5dc4-4f5a-9d04-9910216b9fc6","spanId":"74b450f2","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:56:55.185Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"db58c23b-5099-48de-8ec4-51c1db1ed1ff","spanId":"cd362a99","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.234Z"}
[32m2026-01-17T15:56:55.234Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.234Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:56:55.237Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T15:56:55.238Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"db58c23b-5099-48de-8ec4-51c1db1ed1ff","spanId":"cd362a99","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":41,"timestamp":"2026-01-17T15:56:55.274Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"fbb584a1-f0fc-4ea2-bd0f-632800b12f64","spanId":"aeb2f96d","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.291Z"}
[32m2026-01-17T15:56:55.292Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.292Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:56:55.294Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"fbb584a1-f0fc-4ea2-bd0f-632800b12f64","spanId":"aeb2f96d","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:56:55.296Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"84280d73-c54a-442b-91ef-093c10d6c2a7","spanId":"3d17f1d8","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.303Z"}
[32m2026-01-17T15:56:55.303Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.303Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:56:55.304Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"84280d73-c54a-442b-91ef-093c10d6c2a7","spanId":"3d17f1d8","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T15:56:55.305Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"353e8777-65e1-4802-b3ac-6269d7dd6b6e","spanId":"339e65cc","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:56:55.328Z"}
[32m2026-01-17T15:56:55.329Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:56:55.329Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:56:55.329Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"353e8777-65e1-4802-b3ac-6269d7dd6b6e","spanId":"339e65cc","method":"GET","path":"/api/auth/user","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:56:55.331Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:56:55.378Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:56:55.415Z [ERROR] Database health check failed {"error":"Unknown error"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 609[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 119[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 20[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 29[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 24[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 53[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 66[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 14[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 25[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 53[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 31[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 5 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > AI-Powered Analysis > should require authentication for AI gap analysis
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:170:31
    168|         });
    169| 
    170|       expect(response.status).toBe(401);
       |                               ^
    171|     });
    172|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/5]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Framework Requirements > should return framework control requirements
AssertionError: expected 404 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 404

 Î“Â¥Â» tests/integration/gap-analysis.test.ts:179:31
    177|         .get('/api/frameworks/SOC2/controls');
    178| 
    179|       expect(response.status).toBe(401);
       |                               ^
    180|     });
    181|   });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/5]Î“Ã„Â»


[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m3 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m5 failed[39m[22m[2m | [22m[1m[32m63 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:56:49
[2m   Duration [22m 28.41s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/integration/gap-analysis.test.ts [22m[34mx22 [34m[39m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 609[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 119[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 20[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 29[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 24[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 53[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 66[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 14[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 25[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 53[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 31[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:57:33.424Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:57:33.433Z [INFO] Initializing Gap Analysis router[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"b4bf546d-2fd9-48ab-a753-80b13a79cd18","spanId":"23c9b222","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.503Z"}
[32m2026-01-17T15:57:33.505Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.505Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:57:33.511Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T15:57:33.515Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"b4bf546d-2fd9-48ab-a753-80b13a79cd18","spanId":"23c9b222","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":18,"timestamp":"2026-01-17T15:57:33.520Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"3552cc56-d13c-497a-b69c-ecf09ed22e8d","spanId":"6d0b187a","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.530Z"}
[32m2026-01-17T15:57:33.531Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.531Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:57:33.532Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m
[32m2026-01-17T15:57:33.532Z [INFO] Gap Analysis router hit {"path":"/recommendations/test-id","originalUrl":"/api/gap-analysis/recommendations/test-id","baseUrl":"/api/gap-analysis","method":"PATCH"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"3552cc56-d13c-497a-b69c-ecf09ed22e8d","spanId":"6d0b187a","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:33.533Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"8367a285-cc9d-4a28-b9c5-193a3204fa90","spanId":"c05ccf4e","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.539Z"}
[32m2026-01-17T15:57:33.539Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.539Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:57:33.540Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"8367a285-cc9d-4a28-b9c5-193a3204fa90","spanId":"c05ccf4e","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:33.541Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"1d2825f1-9de3-4940-9737-e455e4726696","spanId":"eb455f3f","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.546Z"}
[32m2026-01-17T15:57:33.546Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.546Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:57:33.547Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m[32m2026-01-17T15:57:33.547Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"1d2825f1-9de3-4940-9737-e455e4726696","spanId":"eb455f3f","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:33.548Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"daec16cf-2ec4-4f36-a1ed-89ff0d7c4b14","spanId":"0ed7c364","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.553Z"}
[32m2026-01-17T15:57:33.553Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.553Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:57:33.554Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m[32m2026-01-17T15:57:33.554Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"daec16cf-2ec4-4f36-a1ed-89ff0d7c4b14","spanId":"0ed7c364","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:33.555Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"cff3a6f5-28d2-4d63-bda8-06f2761768a5","spanId":"d46b784f","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.559Z"}
[32m2026-01-17T15:57:33.560Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.560Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:57:33.560Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m[32m2026-01-17T15:57:33.561Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"cff3a6f5-28d2-4d63-bda8-06f2761768a5","spanId":"d46b784f","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:33.562Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"36c4b0d0-f482-443f-a725-c5c86355839a","spanId":"9e05f157","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.565Z"}
[32m2026-01-17T15:57:33.566Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.566Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:57:33.566Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m[32m2026-01-17T15:57:33.567Z [INFO] Gap Analysis router hit {"path":"/","originalUrl":"/api/gap-analysis","baseUrl":"/api/gap-analysis","method":"POST"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"36c4b0d0-f482-443f-a725-c5c86355839a","spanId":"9e05f157","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:33.568Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"e35d4077-a084-41a5-875c-95e825efca3f","spanId":"e7be6ced","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.572Z"}
[32m2026-01-17T15:57:33.572Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.572Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:57:33.572Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"e35d4077-a084-41a5-875c-95e825efca3f","spanId":"e7be6ced","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:33.574Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"5bd28b03-0ef4-4534-b596-51f37faa12f3","spanId":"bee02233","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.578Z"}
[32m2026-01-17T15:57:33.578Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.578Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:57:33.579Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m
[32m2026-01-17T15:57:33.579Z [INFO] Gap Analysis router hit {"path":"/reports","originalUrl":"/api/gap-analysis/reports","baseUrl":"/api/gap-analysis","method":"GET"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"5bd28b03-0ef4-4534-b596-51f37faa12f3","spanId":"bee02233","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:33.580Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"89ab2647-c48d-4ed7-9ffe-a8661d19988f","spanId":"42463963","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.584Z"}
[32m2026-01-17T15:57:33.584Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.584Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:57:33.584Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m
[32m2026-01-17T15:57:33.584Z [INFO] Gap Analysis router hit {"path":"/reports/test-report-id","originalUrl":"/api/gap-analysis/reports/test-report-id","baseUrl":"/api/gap-analysis","method":"GET"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"89ab2647-c48d-4ed7-9ffe-a8661d19988f","spanId":"42463963","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:57:33.585Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"890e7cb5-9f18-4f7a-b0dc-27d9eb561430","spanId":"2123462a","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.588Z"}
[32m2026-01-17T15:57:33.589Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.589Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:57:33.589Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m
[32m2026-01-17T15:57:33.590Z [INFO] Gap Analysis router hit {"path":"/recommendations/test-rec-id","originalUrl":"/api/gap-analysis/recommendations/test-rec-id","baseUrl":"/api/gap-analysis","method":"PATCH"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"890e7cb5-9f18-4f7a-b0dc-27d9eb561430","spanId":"2123462a","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:33.591Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"db35228d-9c03-488a-b827-c78b2a3ac7b1","spanId":"7a3e31c1","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.595Z"}
[32m2026-01-17T15:57:33.596Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.596Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:57:33.596Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"db35228d-9c03-488a-b827-c78b2a3ac7b1","spanId":"7a3e31c1","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:33.597Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"83e26db5-3844-4915-ad83-3c10dd1f56a6","spanId":"a227d997","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.600Z"}
[32m2026-01-17T15:57:33.600Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.600Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:57:33.601Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"83e26db5-3844-4915-ad83-3c10dd1f56a6","spanId":"a227d997","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:57:33.601Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"92e5b936-c591-47bf-9bd2-2b1f6e3329d8","spanId":"dac88625","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.604Z"}
[32m2026-01-17T15:57:33.604Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.604Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:57:33.605Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"92e5b936-c591-47bf-9bd2-2b1f6e3329d8","spanId":"dac88625","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:33.606Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"98537752-fd45-4f14-826b-59508270ef4f","spanId":"505349fd","method":"GET","path":"/api/frameworks/SOC2/required-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:33.613Z"}
[32m2026-01-17T15:57:33.613Z [INFO] GET /api/frameworks/SOC2/required-templates {"method":"GET","url":"/api/frameworks/SOC2/required-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:33.613Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:57:33.613Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/required-templates","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"98537752-fd45-4f14-826b-59508270ef4f","spanId":"505349fd","method":"GET","path":"/api/frameworks/SOC2/required-templates","statusCode":401,"duration":1,"timestamp":"2026-01-17T15:57:33.614Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 222[2mms[22m[39m

[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m1 passed[39m[22m[90m (2)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m23 passed[39m[22m[90m (26)[39m
[2m   Start at [22m 07:57:31
[2m   Duration [22m 1.94s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes/gapAnalysis.ts [22m[39m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T15:57:45.013Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T15:57:45.197Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T15:57:45.279Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T15:57:45.292Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:57:45.297Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.297Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T15:57:45.300Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"1f1b48e8-72b8-4329-b815-97651453520a","spanId":"d9622f4d","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.315Z"}
[32m2026-01-17T15:57:45.316Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.316Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"e869a654-ef97-4e72-a3ca-7bcb80a4099e","spanId":"a6aaa33e","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.322Z"}
[32m2026-01-17T15:57:45.327Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.327Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T15:57:45.317Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"1f1b48e8-72b8-4329-b815-97651453520a","spanId":"d9622f4d","method":"GET","path":"/api/auth/user","statusCode":401,"duration":16,"timestamp":"2026-01-17T15:57:45.331Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"f6a10948-187a-48fb-befc-8a26471f8a81","spanId":"310e1524","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.337Z"}
[32m2026-01-17T15:57:45.338Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.338Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T15:57:45.335Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T15:57:45.339Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"f6a10948-187a-48fb-befc-8a26471f8a81","spanId":"310e1524","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:57:45.343Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"4f6b7b3d-9cf2-493c-b224-61725c821bae","spanId":"2cf96872","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.425Z"}
[32m2026-01-17T15:57:45.426Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.426Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T15:57:45.427Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"4f6b7b3d-9cf2-493c-b224-61725c821bae","spanId":"2cf96872","method":"GET","path":"/api/documents","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.429Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T15:57:45.340Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"aaedf0fe-d4cb-4f89-accd-8bd52fe14e3b","spanId":"d755f139","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.461Z"}
[32m2026-01-17T15:57:45.461Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.461Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T15:57:45.462Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"aaedf0fe-d4cb-4f89-accd-8bd52fe14e3b","spanId":"d755f139","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.464Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"0540aaf5-c68f-4565-b999-d3b6501b6dd0","spanId":"47a49e26","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.462Z"}
[32m2026-01-17T15:57:45.466Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.466Z"}[0m

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 529[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"e869a654-ef97-4e72-a3ca-7bcb80a4099e","spanId":"a6aaa33e","method":"POST","path":"/api/organizations","statusCode":401,"duration":160,"timestamp":"2026-01-17T15:57:45.482Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"0540aaf5-c68f-4565-b999-d3b6501b6dd0","spanId":"47a49e26","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":45,"timestamp":"2026-01-17T15:57:45.507Z"}
stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T15:57:45.477Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}


stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T15:57:45.516Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"56b785db-7ae9-4294-9f37-10346e2dbcb4","spanId":"532560a3","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.518Z"}
[32m2026-01-17T15:57:45.519Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.519Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T15:57:45.520Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"56b785db-7ae9-4294-9f37-10346e2dbcb4","spanId":"532560a3","method":"GET","path":"/api/organizations","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:57:45.523Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"f24418af-613d-46ae-bfe4-9aa1a67d0249","spanId":"0a9e035f","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.531Z"}
[32m2026-01-17T15:57:45.532Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.532Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T15:57:45.533Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"f24418af-613d-46ae-bfe4-9aa1a67d0249","spanId":"0a9e035f","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.535Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:57:45.537Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.537Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"07dd1393-c7f2-4b3d-93dd-f238548d9f94","spanId":"399c31f5","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.540Z"}
[32m2026-01-17T15:57:45.541Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.541Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T15:57:45.541Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T15:57:45.542Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"07dd1393-c7f2-4b3d-93dd-f238548d9f94","spanId":"399c31f5","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.543Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"55813d77-0984-41fc-90b0-b6b9814cd4fe","spanId":"8b535d2d","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.552Z"}
[32m2026-01-17T15:57:45.552Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.552Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T15:57:45.553Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"aa201ffe-4463-4dde-8785-44f46fb2c534","spanId":"1aea505c","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.553Z"}
[32m2026-01-17T15:57:45.554Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.554Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"55813d77-0984-41fc-90b0-b6b9814cd4fe","spanId":"8b535d2d","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.555Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T15:57:45.555Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"826e0816-8508-4218-a994-a9dfeffe57b4","spanId":"64e347b6","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.564Z"}
[32m2026-01-17T15:57:45.565Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.565Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T15:57:45.566Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"aa201ffe-4463-4dde-8785-44f46fb2c534","spanId":"1aea505c","method":"GET","path":"/api/auth/user","statusCode":401,"duration":14,"timestamp":"2026-01-17T15:57:45.567Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"826e0816-8508-4218-a994-a9dfeffe57b4","spanId":"64e347b6","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.568Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"e0221b53-76fa-4b8a-8da5-e93c7eaad5ff","spanId":"01a269d3","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.577Z"}
[32m2026-01-17T15:57:45.577Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.577Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T15:57:45.578Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"24ae9988-56c7-4e99-8392-d203b15fa465","spanId":"26d69b02","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.579Z"}
[32m2026-01-17T15:57:45.580Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.580Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"e0221b53-76fa-4b8a-8da5-e93c7eaad5ff","spanId":"01a269d3","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.580Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T15:57:45.581Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"24ae9988-56c7-4e99-8392-d203b15fa465","spanId":"26d69b02","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:57:45.586Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:57:45.587Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.587Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T15:57:45.587Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"c8ac57df-25e0-4f31-a129-638fe755650a","spanId":"f91ecd7a","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.603Z"}
[32m2026-01-17T15:57:45.604Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.604Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T15:57:45.605Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"c8ac57df-25e0-4f31-a129-638fe755650a","spanId":"f91ecd7a","method":"POST","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.607Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"bcad0ace-7515-43f3-8d42-161f3d8e04b1","spanId":"6e9320c7","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.598Z"}
[32m2026-01-17T15:57:45.614Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.614Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"eb9be0ff-7f73-4935-9931-5749c46c4512","spanId":"cac31f20","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.614Z"}
[32m2026-01-17T15:57:45.615Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.615Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T15:57:45.615Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T15:57:45.616Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"bcad0ace-7515-43f3-8d42-161f3d8e04b1","spanId":"6e9320c7","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":20,"timestamp":"2026-01-17T15:57:45.618Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"eb9be0ff-7f73-4935-9931-5749c46c4512","spanId":"cac31f20","method":"GET","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.618Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"ec2958ad-d7d0-4efe-9d62-c3e691a7e778","spanId":"a802a37d","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.626Z"}
[32m2026-01-17T15:57:45.627Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.627Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T15:57:45.627Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"ec2958ad-d7d0-4efe-9d62-c3e691a7e778","spanId":"a802a37d","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.629Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"8461bef2-327a-4d1e-a026-cd22b2063e4c","spanId":"044729dc","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.640Z"}
[32m2026-01-17T15:57:45.641Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.641Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"ad35023f-7ee2-4177-82cb-e9e9bf34743e","spanId":"fd10db9e","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.641Z"}
[32m2026-01-17T15:57:45.642Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.642Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T15:57:45.641Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"8461bef2-327a-4d1e-a026-cd22b2063e4c","spanId":"044729dc","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.644Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T15:57:45.643Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"ad35023f-7ee2-4177-82cb-e9e9bf34743e","spanId":"fd10db9e","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.645Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"e6ab0c3c-716b-4ce7-85e5-e5e43c60624c","spanId":"5d0e62a9","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.651Z"}
[32m2026-01-17T15:57:45.651Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.651Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T15:57:45.652Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"e6ab0c3c-716b-4ce7-85e5-e5e43c60624c","spanId":"5d0e62a9","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:45.653Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"b2712b5f-8da8-4bfa-81af-567fa3571b40","spanId":"4669c02d","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.653Z"}
[32m2026-01-17T15:57:45.653Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.653Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"9c2a404e-918a-4e10-8405-ac55c4af65f5","spanId":"efa23ee3","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.653Z"}
[32m2026-01-17T15:57:45.654Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.654Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T15:57:45.655Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"9c2a404e-918a-4e10-8405-ac55c4af65f5","spanId":"efa23ee3","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.657Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:57:45.655Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"b2712b5f-8da8-4bfa-81af-567fa3571b40","spanId":"4669c02d","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:57:45.658Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"4e3748ef-4b81-48c0-bcd4-77c6933bb946","spanId":"84f1ae8e","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.662Z"}
[32m2026-01-17T15:57:45.663Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.663Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T15:57:45.664Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"4e3748ef-4b81-48c0-bcd4-77c6933bb946","spanId":"84f1ae8e","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.665Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"1d0ae6c0-3024-48bf-9029-f94056ad6d89","spanId":"a48f216f","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.665Z"}
[32m2026-01-17T15:57:45.666Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.666Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T15:57:45.667Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"1d0ae6c0-3024-48bf-9029-f94056ad6d89","spanId":"a48f216f","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.668Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"d2f34bf9-24cd-4f6f-b78b-9439b13fa24b","spanId":"7bab7795","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.673Z"}
[32m2026-01-17T15:57:45.674Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.674Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"31de0ae6-7f2c-4696-bdf2-765f6fdc9d72","spanId":"079ba571","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.675Z"}
[32m2026-01-17T15:57:45.675Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.675Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T15:57:45.675Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T15:57:45.676Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"d2f34bf9-24cd-4f6f-b78b-9439b13fa24b","spanId":"7bab7795","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.677Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"31de0ae6-7f2c-4696-bdf2-765f6fdc9d72","spanId":"079ba571","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.678Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"501bc9f3-34de-4cc9-b78a-35e5503ed4f3","spanId":"82a3c15c","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.677Z"}
[32m2026-01-17T15:57:45.678Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.678Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T15:57:45.678Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"501bc9f3-34de-4cc9-b78a-35e5503ed4f3","spanId":"82a3c15c","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:57:45.682Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"fb32cf50-d4f0-42c6-a6c4-29487c8e4dde","spanId":"e906ba99","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.683Z"}
[32m2026-01-17T15:57:45.684Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.684Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T15:57:45.685Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"fb32cf50-d4f0-42c6-a6c4-29487c8e4dde","spanId":"e906ba99","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":3,"timestamp":"2026-01-17T15:57:45.686Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T15:57:45.696Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"5d8656dc-54c4-4ea3-bc0a-87e0a38cbafa","spanId":"5d32c72d","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.724Z"}
[32m2026-01-17T15:57:45.724Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.724Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T15:57:45.725Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"5d8656dc-54c4-4ea3-bc0a-87e0a38cbafa","spanId":"5d32c72d","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.727Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"58a842c0-c78d-4399-bb9b-64673769ab35","spanId":"c0a26ae2","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.731Z"}
[32m2026-01-17T15:57:45.731Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.731Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T15:57:45.732Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"afd94da7-10cf-4d4a-b1e7-f059384075f5","spanId":"e57af5ad","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.733Z"}
[32m2026-01-17T15:57:45.733Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.733Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"58a842c0-c78d-4399-bb9b-64673769ab35","spanId":"c0a26ae2","method":"GET","path":"/api/auth/user","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:57:45.741Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T15:57:45.740Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"b44e2993-8afb-4ef1-998d-28290e6df8a2","spanId":"858988af","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.733Z"}
[32m2026-01-17T15:57:45.741Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.741Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"afd94da7-10cf-4d4a-b1e7-f059384075f5","spanId":"e57af5ad","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":9,"timestamp":"2026-01-17T15:57:45.741Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T15:57:45.742Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"b44e2993-8afb-4ef1-998d-28290e6df8a2","spanId":"858988af","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":11,"timestamp":"2026-01-17T15:57:45.744Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"74b1c42c-1b08-4efd-80e4-636fb7d732cf","spanId":"42e464f1","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.746Z"}
[32m2026-01-17T15:57:45.746Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.746Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T15:57:45.747Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"870a0dd8-a672-4d44-9f45-e779149b6187","spanId":"7f1f09db","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.755Z"}
[32m2026-01-17T15:57:45.755Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.755Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T15:57:45.756Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"74b1c42c-1b08-4efd-80e4-636fb7d732cf","spanId":"42e464f1","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":10,"timestamp":"2026-01-17T15:57:45.756Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"870a0dd8-a672-4d44-9f45-e779149b6187","spanId":"7f1f09db","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:45.759Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"2de46641-7c5b-46e6-8e01-735f5ffe6242","spanId":"7f609b6e","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.764Z"}
[32m2026-01-17T15:57:45.765Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.765Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T15:57:45.765Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"2de46641-7c5b-46e6-8e01-735f5ffe6242","spanId":"7f609b6e","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.767Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"c99ef7f5-6615-458f-95d5-ff1e250fde33","spanId":"dd2faf0b","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.767Z"}
[32m2026-01-17T15:57:45.771Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.771Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T15:57:45.771Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"c99ef7f5-6615-458f-95d5-ff1e250fde33","spanId":"dd2faf0b","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":8,"timestamp":"2026-01-17T15:57:45.775Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"7debae78-3972-47e8-bfe8-c5f9e9505f57","spanId":"7c769dd6","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.784Z"}
[32m2026-01-17T15:57:45.784Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.784Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T15:57:45.785Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"7debae78-3972-47e8-bfe8-c5f9e9505f57","spanId":"7c769dd6","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:45.787Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"e61d8f3a-dd60-480a-a053-b711b73d381e","spanId":"7110847b","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.793Z"}
[32m2026-01-17T15:57:45.794Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.794Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T15:57:45.794Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"e61d8f3a-dd60-480a-a053-b711b73d381e","spanId":"7110847b","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.796Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"afd4cf23-fcad-4e6a-8e15-03add8cfdbe2","spanId":"5e2f54ee","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.803Z"}
[32m2026-01-17T15:57:45.804Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.804Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T15:57:45.805Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"a4e49a3c-8d38-4506-a59f-5b5159c537ed","spanId":"68fa5379","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.805Z"}
[32m2026-01-17T15:57:45.808Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.808Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"afd4cf23-fcad-4e6a-8e15-03add8cfdbe2","spanId":"5e2f54ee","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:57:45.808Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T15:57:45.808Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"a4e49a3c-8d38-4506-a59f-5b5159c537ed","spanId":"68fa5379","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:57:45.810Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"01fe4228-4aec-4c02-a3ec-ca9180be2e5c","spanId":"24e13648","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.815Z"}
[32m2026-01-17T15:57:45.816Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.816Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T15:57:45.816Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"d5dac653-2d56-446b-911a-c19e993cef85","spanId":"bbf70d16","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.812Z"}
[32m2026-01-17T15:57:45.815Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.815Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"01fe4228-4aec-4c02-a3ec-ca9180be2e5c","spanId":"24e13648","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.818Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"c76f489b-e785-4fc0-a480-1d19066a7844","spanId":"8d4f332f","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.818Z"}
[32m2026-01-17T15:57:45.818Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.818Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T15:57:45.819Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"c76f489b-e785-4fc0-a480-1d19066a7844","spanId":"8d4f332f","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:45.820Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T15:57:45.822Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"0de04e13-1c56-4827-a74d-9766ef4736c8","spanId":"703145f6","method":"GET","path":"/api/frameworks/SOC2/required-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.824Z"}
[32m2026-01-17T15:57:45.824Z [INFO] GET /api/frameworks/SOC2/required-templates {"method":"GET","url":"/api/frameworks/SOC2/required-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.824Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T15:57:45.825Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/required-templates","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"0de04e13-1c56-4827-a74d-9766ef4736c8","spanId":"703145f6","method":"GET","path":"/api/frameworks/SOC2/required-templates","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:57:45.831Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"99f61382-05f5-4f3f-a7e4-0698b86a5e7a","spanId":"c3ff4d21","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.826Z"}
[32m2026-01-17T15:57:45.827Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.827Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T15:57:45.824Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T15:57:45.831Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"99f61382-05f5-4f3f-a7e4-0698b86a5e7a","spanId":"c3ff4d21","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:57:45.833Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 679[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"85eafbd6-0d75-4f22-9d28-be86c96dc153","spanId":"b9a0a0f5","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.840Z"}
[32m2026-01-17T15:57:45.840Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.840Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T15:57:45.841Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"85eafbd6-0d75-4f22-9d28-be86c96dc153","spanId":"b9a0a0f5","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:45.843Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"d5dac653-2d56-446b-911a-c19e993cef85","spanId":"bbf70d16","method":"GET","path":"/","statusCode":200,"duration":34,"timestamp":"2026-01-17T15:57:45.846Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"d2d5563b-7d61-444c-8509-4f38064ccae7","spanId":"c5f12d31","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.848Z"}
[32m2026-01-17T15:57:45.848Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.848Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T15:57:45.848Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"d2d5563b-7d61-444c-8509-4f38064ccae7","spanId":"c5f12d31","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":5,"timestamp":"2026-01-17T15:57:45.853Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 777[2mms[22m[39m
stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T15:57:45.875Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"7783cbcc-f1c8-45a2-8d9b-3a4e2a04f1be","spanId":"6d26957c","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.881Z"}
[32m2026-01-17T15:57:45.882Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.882Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:57:45.882Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[33m 749[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 146[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 27[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 40[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 45[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 10[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 72[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 43[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[39m[32m 46[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"7783cbcc-f1c8-45a2-8d9b-3a4e2a04f1be","spanId":"6d26957c","method":"GET","path":"/","statusCode":200,"duration":11,"timestamp":"2026-01-17T15:57:45.891Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"3aa954a8-6236-4718-a873-44480b5092e9","spanId":"a28804e5","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.909Z"}
[32m2026-01-17T15:57:45.910Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.910Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T15:57:45.911Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"3aa954a8-6236-4718-a873-44480b5092e9","spanId":"a28804e5","method":"GET","path":"/iso-001","statusCode":200,"duration":5,"timestamp":"2026-01-17T15:57:45.914Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"e2df90f4-58e6-40f2-abca-ea55ae612537","spanId":"a659a0d7","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.947Z"}
[32m2026-01-17T15:57:45.948Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.948Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T15:57:45.949Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"e2df90f4-58e6-40f2-abca-ea55ae612537","spanId":"a659a0d7","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":18,"timestamp":"2026-01-17T15:57:45.965Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"1dd4e5e7-0c52-43f5-96a6-eb5a47269f73","spanId":"d14138ff","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:45.980Z"}
[32m2026-01-17T15:57:45.981Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:45.981Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T15:57:45.983Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"1dd4e5e7-0c52-43f5-96a6-eb5a47269f73","spanId":"d14138ff","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":6,"timestamp":"2026-01-17T15:57:45.986Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"690bf754-bf5a-47c1-9ddf-6221ff6cbc8e","spanId":"04bd2f04","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.006Z"}
[32m2026-01-17T15:57:46.006Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.006Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T15:57:46.011Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"690bf754-bf5a-47c1-9ddf-6221ff6cbc8e","spanId":"04bd2f04","method":"POST","path":"/export-document","statusCode":200,"duration":8,"timestamp":"2026-01-17T15:57:46.014Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"44fcce75-4094-47ec-9881-a4b3212990fc","spanId":"38d60f65","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.020Z"}
[32m2026-01-17T15:57:46.020Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.020Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T15:57:46.021Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"44fcce75-4094-47ec-9881-a4b3212990fc","spanId":"38d60f65","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T15:57:46.023Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"029a0763-4c50-42a4-bba5-4c37069e19a8","spanId":"9d592c68","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.029Z"}
[32m2026-01-17T15:57:46.029Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.029Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T15:57:46.030Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"029a0763-4c50-42a4-bba5-4c37069e19a8","spanId":"9d592c68","method":"POST","path":"/api/generate-document","statusCode":401,"duration":28,"timestamp":"2026-01-17T15:57:46.057Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"c3e4b984-a5e6-4d99-957c-b1f56e9f68ac","spanId":"2a4a77c7","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.067Z"}
[32m2026-01-17T15:57:46.068Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.068Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T15:57:46.069Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"c3e4b984-a5e6-4d99-957c-b1f56e9f68ac","spanId":"2a4a77c7","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":4,"timestamp":"2026-01-17T15:57:46.071Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"dfa1ac0c-22b0-419d-8484-f481f1f3cd4c","spanId":"7f51ceba","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.105Z"}
[32m2026-01-17T15:57:46.106Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.106Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T15:57:46.107Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"dfa1ac0c-22b0-419d-8484-f481f1f3cd4c","spanId":"7f51ceba","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":12,"timestamp":"2026-01-17T15:57:46.117Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"604e0bac-6aee-49e6-85f4-8407d74fdc25","spanId":"7c6aea23","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.125Z"}
[32m2026-01-17T15:57:46.125Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.125Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T15:57:46.126Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"604e0bac-6aee-49e6-85f4-8407d74fdc25","spanId":"7c6aea23","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":7,"timestamp":"2026-01-17T15:57:46.132Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"37406d15-5967-4ba0-9de2-467bdb5541e4","spanId":"3be77f93","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.141Z"}
[32m2026-01-17T15:57:46.142Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.142Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T15:57:46.142Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"37406d15-5967-4ba0-9de2-467bdb5541e4","spanId":"3be77f93","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:46.143Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"90af089c-6704-4c83-8267-a6d16593a676","spanId":"db9d3353","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.148Z"}
[32m2026-01-17T15:57:46.148Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.148Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T15:57:46.149Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"90af089c-6704-4c83-8267-a6d16593a676","spanId":"db9d3353","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:46.151Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"2d302458-b87e-4592-b6d5-fd896d7e8274","spanId":"44ea9e3b","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.157Z"}
[32m2026-01-17T15:57:46.158Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.158Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T15:57:46.158Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"2d302458-b87e-4592-b6d5-fd896d7e8274","spanId":"44ea9e3b","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T15:57:46.160Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"43aa7ee4-f712-4011-b53f-dec574db0173","spanId":"0f7e3b1e","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T15:57:46.173Z"}
[32m2026-01-17T15:57:46.174Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T15:57:46.174Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T15:57:46.174Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"43aa7ee4-f712-4011-b53f-dec574db0173","spanId":"0f7e3b1e","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T15:57:46.175Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 542[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 3 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/3]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/3]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(5) } to have property "x-content-type-options"
 Î“Â¥Â» tests/integration/auth.test.ts:111:32
    109|         .get('/health');
    110| 
    111|       expect(response.headers).toHaveProperty('x-content-type-options'Î“Ã‡Âª
       |                                ^
    112|       expect(response.headers['x-content-type-options']).toBe('nosniffÎ“Ã‡Âª
    113|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/3]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m65 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 07:57:40
[2m   Duration [22m 23.99s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T16:00:04.926Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"a84073e6-223f-4d0b-8e46-792b6f06c88b","spanId":"c67b4f83","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.072Z"}
[32m2026-01-17T16:00:05.075Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.075Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T16:00:05.090Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"a84073e6-223f-4d0b-8e46-792b6f06c88b","spanId":"c67b4f83","method":"POST","path":"/api/organizations","statusCode":401,"duration":40,"timestamp":"2026-01-17T16:00:05.110Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"ff1d31a5-5b7b-40ad-9070-2b078a1525af","spanId":"9b7f8d92","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.122Z"}
[32m2026-01-17T16:00:05.123Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.123Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T16:00:05.124Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"ff1d31a5-5b7b-40ad-9070-2b078a1525af","spanId":"9b7f8d92","method":"GET","path":"/api/organizations","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:00:05.127Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"8176562a-6b73-489e-b5ad-f86abd363322","spanId":"610714a1","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.134Z"}
[32m2026-01-17T16:00:05.135Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.135Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T16:00:05.135Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"8176562a-6b73-489e-b5ad-f86abd363322","spanId":"610714a1","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.137Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"cc7b7fff-3532-4880-b5a5-ff680d0a9329","spanId":"34e1e816","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.142Z"}
[32m2026-01-17T16:00:05.142Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.142Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T16:00:05.143Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"cc7b7fff-3532-4880-b5a5-ff680d0a9329","spanId":"34e1e816","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.145Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"5acefe6b-022a-4d42-9508-0258aa07e029","spanId":"c608251e","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.153Z"}
[32m2026-01-17T16:00:05.153Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.153Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T16:00:05.154Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"5acefe6b-022a-4d42-9508-0258aa07e029","spanId":"c608251e","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:05.155Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"557d7034-1bbd-468c-9faa-9c2b926331fc","spanId":"7f9b7c99","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.174Z"}
[32m2026-01-17T16:00:05.175Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.175Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T16:00:05.176Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"557d7034-1bbd-468c-9faa-9c2b926331fc","spanId":"7f9b7c99","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:00:05.178Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"54f3b5f9-226d-4063-9a21-890e822fc45e","spanId":"e0cb5332","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.184Z"}
[32m2026-01-17T16:00:05.184Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.184Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T16:00:05.185Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"54f3b5f9-226d-4063-9a21-890e822fc45e","spanId":"e0cb5332","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:00:05.189Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T16:00:05.195Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.195Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T16:00:05.196Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"2929119b-c973-4517-b4a3-2e03b9dc3c4a","spanId":"d12a6a5a","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.210Z"}
[32m2026-01-17T16:00:05.211Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.211Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T16:00:05.211Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"2929119b-c973-4517-b4a3-2e03b9dc3c4a","spanId":"d12a6a5a","method":"POST","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:00:05.214Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"0c6a622a-76b4-46f7-94d3-e9526a26abaa","spanId":"d93504d3","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.230Z"}
[32m2026-01-17T16:00:05.231Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.231Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T16:00:05.231Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"0c6a622a-76b4-46f7-94d3-e9526a26abaa","spanId":"d93504d3","method":"GET","path":"/api/evidence","statusCode":401,"duration":18,"timestamp":"2026-01-17T16:00:05.248Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"6cb1ba72-55ee-493e-b951-9ed3b453c64a","spanId":"1b6b0acf","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.261Z"}
[32m2026-01-17T16:00:05.262Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.262Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T16:00:05.262Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"6cb1ba72-55ee-493e-b951-9ed3b453c64a","spanId":"1b6b0acf","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.264Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"b8eeb3e9-4ca5-4846-af33-57f0b0e08a54","spanId":"069eebe3","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.269Z"}
[32m2026-01-17T16:00:05.270Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.270Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T16:00:05.270Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"b8eeb3e9-4ca5-4846-af33-57f0b0e08a54","spanId":"069eebe3","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.272Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"0ac816e3-0af4-4370-bd07-7669ef5ada4f","spanId":"0325737a","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.277Z"}
[32m2026-01-17T16:00:05.278Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.278Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T16:00:05.278Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"0ac816e3-0af4-4370-bd07-7669ef5ada4f","spanId":"0325737a","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.280Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"86cec763-f41a-492b-bf9e-6fa2cba37be6","spanId":"c352aed6","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.286Z"}
[32m2026-01-17T16:00:05.286Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.286Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T16:00:05.287Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"86cec763-f41a-492b-bf9e-6fa2cba37be6","spanId":"c352aed6","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.289Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"32ec5094-3536-42da-966a-a9c4fd0bc583","spanId":"791190e5","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.296Z"}
[32m2026-01-17T16:00:05.296Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.296Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T16:00:05.297Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"32ec5094-3536-42da-966a-a9c4fd0bc583","spanId":"791190e5","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.299Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"6ccefde7-aa06-4e1a-a9d3-9eb0f5ec6003","spanId":"e2f46379","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.305Z"}
[32m2026-01-17T16:00:05.306Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.306Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T16:00:05.306Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"6ccefde7-aa06-4e1a-a9d3-9eb0f5ec6003","spanId":"e2f46379","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.308Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"5b9734e3-23d2-4190-ad9d-9e24bbeb367f","spanId":"81305fff","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.315Z"}
[32m2026-01-17T16:00:05.315Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.315Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T16:00:05.315Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"5b9734e3-23d2-4190-ad9d-9e24bbeb367f","spanId":"81305fff","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:00:05.319Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"db45ed0f-cdeb-4ac3-978c-c9d71400f5b3","spanId":"d005d8b4","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.326Z"}
[32m2026-01-17T16:00:05.326Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.326Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T16:00:05.326Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"db45ed0f-cdeb-4ac3-978c-c9d71400f5b3","spanId":"d005d8b4","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":13,"timestamp":"2026-01-17T16:00:05.339Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"459d622a-29cd-429e-a8ee-5d303fca34ac","spanId":"96c1f319","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.345Z"}
[32m2026-01-17T16:00:05.345Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.345Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T16:00:05.345Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"459d622a-29cd-429e-a8ee-5d303fca34ac","spanId":"96c1f319","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:05.347Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"a22896b3-c357-473a-a69a-a93dca4f0258","spanId":"079ef292","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.355Z"}
[32m2026-01-17T16:00:05.355Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.355Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T16:00:05.355Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"a22896b3-c357-473a-a69a-a93dca4f0258","spanId":"079ef292","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:05.357Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"80d71bb0-4eb1-49ac-ac57-e1752a0f0e3d","spanId":"b9c89cca","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.362Z"}
[32m2026-01-17T16:00:05.363Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.362Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T16:00:05.363Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"80d71bb0-4eb1-49ac-ac57-e1752a0f0e3d","spanId":"b9c89cca","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:05.364Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"26fe30a4-37ed-4921-a73b-064cc90aed58","spanId":"a3d1195d","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.368Z"}
[32m2026-01-17T16:00:05.369Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.369Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T16:00:05.369Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"26fe30a4-37ed-4921-a73b-064cc90aed58","spanId":"a3d1195d","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.371Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 555[2mms[22m[39m
[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T16:00:05.513Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T16:00:05.681Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"38b5b965-bf3f-442c-8231-10db306e72d3","spanId":"f5eb3514","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.797Z"}
[32m2026-01-17T16:00:05.800Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.800Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T16:00:05.813Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T16:00:05.820Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"38b5b965-bf3f-442c-8231-10db306e72d3","spanId":"f5eb3514","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":34,"timestamp":"2026-01-17T16:00:05.830Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"e8141bda-41a1-4c38-b151-0dcf4add72fb","spanId":"64d392b8","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.846Z"}
[32m2026-01-17T16:00:05.848Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.848Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T16:00:05.856Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"e8141bda-41a1-4c38-b151-0dcf4add72fb","spanId":"64d392b8","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":17,"timestamp":"2026-01-17T16:00:05.863Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"f313c163-efef-436c-8235-ca976e5d7dcc","spanId":"f07af850","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.872Z"}
[32m2026-01-17T16:00:05.872Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.872Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T16:00:05.888Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T16:00:05.862Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T16:00:05.914Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.914Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T16:00:05.873Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"f313c163-efef-436c-8235-ca976e5d7dcc","spanId":"f07af850","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":48,"timestamp":"2026-01-17T16:00:05.920Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T16:00:05.923Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"5bb1f752-054b-4306-97a9-3d6d287043cf","spanId":"760b5b9a","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.928Z"}
[32m2026-01-17T16:00:05.928Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.928Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T16:00:05.929Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"5bb1f752-054b-4306-97a9-3d6d287043cf","spanId":"760b5b9a","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.930Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"3a2ec06c-9993-440c-8ea4-921d22fcd981","spanId":"e75a055e","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.936Z"}
[32m2026-01-17T16:00:05.937Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.937Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"8ddd0573-0d8b-4b33-b8c8-6fea6787fc90","spanId":"0ccdbc62","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.936Z"}
[32m2026-01-17T16:00:05.938Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.938Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T16:00:05.939Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T16:00:05.949Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T16:00:05.959Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"8ddd0573-0d8b-4b33-b8c8-6fea6787fc90","spanId":"0ccdbc62","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:00:05.940Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T16:00:05.938Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"3a2ec06c-9993-440c-8ea4-921d22fcd981","spanId":"e75a055e","method":"GET","path":"/api/auth/user","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:00:05.946Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"b341ea63-9daa-41f2-ac0a-40bc8d71bad7","spanId":"1b555ace","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.948Z"}
[32m2026-01-17T16:00:05.948Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.948Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"b341ea63-9daa-41f2-ac0a-40bc8d71bad7","spanId":"1b555ace","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:05.950Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"804b43a9-547a-4bac-b120-af815df1b2b3","spanId":"82301d71","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.957Z"}
[32m2026-01-17T16:00:05.958Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.958Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"804b43a9-547a-4bac-b120-af815df1b2b3","spanId":"82301d71","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:05.960Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"75c8efe8-1f1d-4ab5-986b-6337870a3d6e","spanId":"cc57e368","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.977Z"}
[32m2026-01-17T16:00:05.978Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.978Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T16:00:05.980Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"75c8efe8-1f1d-4ab5-986b-6337870a3d6e","spanId":"cc57e368","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:00:05.983Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"85ce9c54-4e26-4d73-81e6-898975f4dc36","spanId":"bb7dd434","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:05.991Z"}
[32m2026-01-17T16:00:05.991Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:05.991Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T16:00:05.992Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"85ce9c54-4e26-4d73-81e6-898975f4dc36","spanId":"bb7dd434","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:00:05.994Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"68dc5e0a-399d-4e69-bc06-28d542bca7cd","spanId":"2a23c663","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.001Z"}
[32m2026-01-17T16:00:06.001Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.001Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T16:00:06.002Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"68dc5e0a-399d-4e69-bc06-28d542bca7cd","spanId":"2a23c663","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:06.003Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"896a8fbf-66f6-4e3e-a406-0f8fc11f3c66","spanId":"08aed510","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.008Z"}
[32m2026-01-17T16:00:06.009Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.009Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T16:00:06.009Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"896a8fbf-66f6-4e3e-a406-0f8fc11f3c66","spanId":"08aed510","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:06.010Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"f5b24ba9-4c45-43e0-b1e9-2b4c017dffe5","spanId":"0e2051fc","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.014Z"}
[32m2026-01-17T16:00:06.015Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.015Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T16:00:06.015Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"f5b24ba9-4c45-43e0-b1e9-2b4c017dffe5","spanId":"0e2051fc","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:06.016Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"ce8d6cbd-1b6a-4d24-9256-f0251e8994a2","spanId":"b676b0c3","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.012Z"}
[32m2026-01-17T16:00:06.015Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.015Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"2e1f91eb-ad51-4813-8852-1f3ffc643ae8","spanId":"8329c4a9","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.021Z"}
[32m2026-01-17T16:00:06.021Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.021Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T16:00:06.022Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"2e1f91eb-ad51-4813-8852-1f3ffc643ae8","spanId":"8329c4a9","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:06.023Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"01cfe29e-19d3-4eca-b99c-8161de3eba4a","spanId":"0e002e20","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.028Z"}
[32m2026-01-17T16:00:06.028Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.028Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T16:00:06.029Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T16:00:06.027Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"01cfe29e-19d3-4eca-b99c-8161de3eba4a","spanId":"0e002e20","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:06.031Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"b7aabc40-16d1-494b-b05b-a3d98c6202df","spanId":"e2e3ec62","method":"GET","path":"/api/frameworks/SOC2/required-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.085Z"}
[32m2026-01-17T16:00:06.085Z [INFO] GET /api/frameworks/SOC2/required-templates {"method":"GET","url":"/api/frameworks/SOC2/required-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.085Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T16:00:06.085Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/required-templates","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"b7aabc40-16d1-494b-b05b-a3d98c6202df","spanId":"e2e3ec62","method":"GET","path":"/api/frameworks/SOC2/required-templates","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:06.087Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 610[2mms[22m[39m
[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"dca8377d-f9ca-46ea-8cc8-2c2e99a9aa62","spanId":"7411bb14","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.111Z"}
[32m2026-01-17T16:00:06.112Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.112Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T16:00:06.113Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"dca8377d-f9ca-46ea-8cc8-2c2e99a9aa62","spanId":"7411bb14","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:00:06.116Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"2ee4c9e1-6383-4017-a229-7a0f780494fe","spanId":"96002adf","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.136Z"}
[32m2026-01-17T16:00:06.136Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.136Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T16:00:06.138Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"2ee4c9e1-6383-4017-a229-7a0f780494fe","spanId":"96002adf","method":"GET","path":"/api/documents","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:00:06.146Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"ce8d6cbd-1b6a-4d24-9256-f0251e8994a2","spanId":"b676b0c3","method":"GET","path":"/","statusCode":200,"duration":142,"timestamp":"2026-01-17T16:00:06.154Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"5b6a7670-3474-4cad-8021-c13b2ec12f03","spanId":"9eb4984f","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.167Z"}
[32m2026-01-17T16:00:06.167Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.167Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T16:00:06.168Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"5b6a7670-3474-4cad-8021-c13b2ec12f03","spanId":"9eb4984f","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:06.169Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 795[2mms[22m[39m
stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T16:00:06.196Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T16:00:06.218Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.218Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T16:00:06.222Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"3ef363ef-af85-409b-b16d-e2802a62a533","spanId":"2328436a","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.233Z"}
[32m2026-01-17T16:00:06.234Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.234Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T16:00:06.235Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"3ef363ef-af85-409b-b16d-e2802a62a533","spanId":"2328436a","method":"GET","path":"/api/auth/user","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:00:06.243Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"568a6075-2ed7-43d8-9bf9-37e26a69a3ca","spanId":"e8ca9988","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.249Z"}
[32m2026-01-17T16:00:06.250Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.250Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T16:00:06.251Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"568a6075-2ed7-43d8-9bf9-37e26a69a3ca","spanId":"e8ca9988","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:00:06.255Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"73b03bdc-749e-4350-a299-188cd4944549","spanId":"2a84e216","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.282Z"}
[32m2026-01-17T16:00:06.283Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.283Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:00:06.283Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"73b03bdc-749e-4350-a299-188cd4944549","spanId":"2a84e216","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:00:06.286Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"e64930ae-9723-453e-b873-f96ca66e69c7","spanId":"9beea4d0","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.293Z"}
[32m2026-01-17T16:00:06.293Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.293Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T16:00:06.294Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"e64930ae-9723-453e-b873-f96ca66e69c7","spanId":"9beea4d0","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:06.296Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"a4fa8665-b52f-4345-89fb-da118951b7a6","spanId":"0820458c","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.296Z"}
[32m2026-01-17T16:00:06.297Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.297Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:00:06.298Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"63b5f181-fe52-4fd6-8b8d-a1a237832690","spanId":"c94b7528","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.304Z"}
[32m2026-01-17T16:00:06.304Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.304Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T16:00:06.305Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"63b5f181-fe52-4fd6-8b8d-a1a237832690","spanId":"c94b7528","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:06.307Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"bdf2169f-b6dd-4eeb-af74-a7d32a1ae70f","spanId":"0dd5823a","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.313Z"}
[32m2026-01-17T16:00:06.313Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.313Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T16:00:06.314Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"bdf2169f-b6dd-4eeb-af74-a7d32a1ae70f","spanId":"0dd5823a","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T16:00:06.315Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"be3a5f17-e941-46f5-a28e-1bf62bc66e7e","spanId":"43347a00","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.323Z"}
[32m2026-01-17T16:00:06.324Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.324Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T16:00:06.324Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"be3a5f17-e941-46f5-a28e-1bf62bc66e7e","spanId":"43347a00","method":"GET","path":"/api/auth/user","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:00:06.327Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"a4fa8665-b52f-4345-89fb-da118951b7a6","spanId":"0820458c","method":"GET","path":"/","statusCode":200,"duration":55,"timestamp":"2026-01-17T16:00:06.351Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"7fea4409-4a92-4880-8f2a-5e5954d2d593","spanId":"21e76cdf","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.375Z"}
[32m2026-01-17T16:00:06.376Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.376Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:00:06.377Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"7fea4409-4a92-4880-8f2a-5e5954d2d593","spanId":"21e76cdf","method":"GET","path":"/iso-001","statusCode":200,"duration":4,"timestamp":"2026-01-17T16:00:06.379Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T16:00:06.379Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T16:00:06.396Z [ERROR] Database health check failed {"error":"Unknown error"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 769[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check [33m 302[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 30[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 9[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 9[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 58[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(15) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 11[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"4f2c95a4-f7d3-42a4-a875-04abcd00a116","spanId":"a65334f0","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.433Z"}
[32m2026-01-17T16:00:06.434Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.434Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:00:06.435Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"4f2c95a4-f7d3-42a4-a875-04abcd00a116","spanId":"a65334f0","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":8,"timestamp":"2026-01-17T16:00:06.441Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"13861fdd-a1c4-4467-8701-fc522b814831","spanId":"a28968df","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.448Z"}
[32m2026-01-17T16:00:06.449Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.449Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T16:00:06.449Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"13861fdd-a1c4-4467-8701-fc522b814831","spanId":"a28968df","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:06.451Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"38854ff0-084c-4156-a152-b960e398dc7e","spanId":"96e726a3","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.472Z"}
[32m2026-01-17T16:00:06.476Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.476Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T16:00:06.477Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"38854ff0-084c-4156-a152-b960e398dc7e","spanId":"96e726a3","method":"POST","path":"/export-document","statusCode":200,"duration":29,"timestamp":"2026-01-17T16:00:06.501Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"0d40d4fa-4ab2-461c-a184-3b0ac6b0e93a","spanId":"2358851b","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.550Z"}
[32m2026-01-17T16:00:06.550Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.550Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T16:00:06.551Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"0d40d4fa-4ab2-461c-a184-3b0ac6b0e93a","spanId":"2358851b","method":"POST","path":"/export-document","statusCode":400,"duration":4,"timestamp":"2026-01-17T16:00:06.554Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"93a12000-8fdf-40b4-b8ae-6a91a054f396","spanId":"e9893b09","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.564Z"}
[32m2026-01-17T16:00:06.564Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.564Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T16:00:06.565Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"93a12000-8fdf-40b4-b8ae-6a91a054f396","spanId":"e9893b09","method":"POST","path":"/api/generate-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:06.567Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"2a151b5a-add7-4a5d-bcaf-59b837ece263","spanId":"84342a36","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.584Z"}
[32m2026-01-17T16:00:06.585Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.585Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T16:00:06.586Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"2a151b5a-add7-4a5d-bcaf-59b837ece263","spanId":"84342a36","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:06.587Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"adb3b4d3-3f61-460c-aa74-90513f1c5045","spanId":"87930b03","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.595Z"}
[32m2026-01-17T16:00:06.595Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.595Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T16:00:06.596Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"adb3b4d3-3f61-460c-aa74-90513f1c5045","spanId":"87930b03","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:06.598Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"76728a80-9dc4-4c95-9f28-74f221465c84","spanId":"30a348c4","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.610Z"}
[32m2026-01-17T16:00:06.610Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.610Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T16:00:06.611Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"76728a80-9dc4-4c95-9f28-74f221465c84","spanId":"30a348c4","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:06.612Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"5f700888-16e0-4d89-bcc9-3a9d34228a43","spanId":"e4a21ba1","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.657Z"}
[32m2026-01-17T16:00:06.657Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.657Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T16:00:06.657Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"5f700888-16e0-4d89-bcc9-3a9d34228a43","spanId":"e4a21ba1","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:06.659Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"0ac23b83-3c44-48b1-9f7b-62379119c5c6","spanId":"6573175c","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.673Z"}
[32m2026-01-17T16:00:06.673Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.673Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T16:00:06.674Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"0ac23b83-3c44-48b1-9f7b-62379119c5c6","spanId":"6573175c","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:06.675Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"216c09d7-d616-48d9-aba7-18874c340933","spanId":"6c0953da","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.682Z"}
[32m2026-01-17T16:00:06.683Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.683Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T16:00:06.683Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"216c09d7-d616-48d9-aba7-18874c340933","spanId":"6c0953da","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:00:06.685Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"86e9e7b3-5581-4f71-b177-457a5c3ba3a4","spanId":"cab805ed","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:00:06.690Z"}
[32m2026-01-17T16:00:06.691Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:00:06.691Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T16:00:06.691Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"86e9e7b3-5581-4f71-b177-457a5c3ba3a4","spanId":"cab805ed","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:00:06.692Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 1053[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 2 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/2]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(15) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/2]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m66 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 08:00:00
[2m   Duration [22m 27.54s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T16:01:46.835Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"efd1c894-88c5-4a5b-9538-3df150139253","spanId":"24c32a11","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:46.949Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T16:01:46.959Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T16:01:46.972Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:01:46.959Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:46.959Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"efd1c894-88c5-4a5b-9538-3df150139253","spanId":"24c32a11","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":37,"timestamp":"2026-01-17T16:01:46.986Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"832ad8a0-e99e-4fed-8638-900fb46b1050","spanId":"17402f73","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.075Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T16:01:47.095Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T16:01:47.085Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.085Z"}[0m
[32m2026-01-17T16:01:47.088Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"d1d36e9e-12c1-49dc-8e51-faca9192703e","spanId":"97a131b5","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.128Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"832ad8a0-e99e-4fed-8638-900fb46b1050","spanId":"17402f73","method":"POST","path":"/api/organizations","statusCode":401,"duration":56,"timestamp":"2026-01-17T16:01:47.131Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T16:01:47.130Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.130Z"}[0m
[32m2026-01-17T16:01:47.131Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"d1d36e9e-12c1-49dc-8e51-faca9192703e","spanId":"97a131b5","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:01:47.134Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"0586cd16-1597-42bc-be05-ce99635067eb","spanId":"1afe75b0","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.151Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T16:01:47.154Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.154Z"}[0m
[32m2026-01-17T16:01:47.154Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"0586cd16-1597-42bc-be05-ce99635067eb","spanId":"1afe75b0","method":"GET","path":"/api/organizations","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:01:47.161Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"4231195d-98c7-4cca-8675-dcf72c2b3b23","spanId":"f11ebe70","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.201Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T16:01:47.202Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.202Z"}[0m
[32m2026-01-17T16:01:47.204Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"4231195d-98c7-4cca-8675-dcf72c2b3b23","spanId":"f11ebe70","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:01:47.206Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"9ddae6ea-06f1-48a8-8248-a3f6aa98efc5","spanId":"795ac63c","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.212Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T16:01:47.213Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.213Z"}[0m
[32m2026-01-17T16:01:47.213Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"9ddae6ea-06f1-48a8-8248-a3f6aa98efc5","spanId":"795ac63c","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:01:47.216Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"b5ea4f04-448c-4bc7-be78-ab69cc2929a3","spanId":"a4b82df1","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.226Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T16:01:47.227Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m[32m2026-01-17T16:01:47.227Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.227Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"b5ea4f04-448c-4bc7-be78-ab69cc2929a3","spanId":"a4b82df1","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.229Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"ffd6031c-a30c-48f8-85e7-83da01033f03","spanId":"314c8566","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.235Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"1d236330-aa70-4a11-bdc6-48e1e08e20f4","spanId":"4cde64f7","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.236Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T16:01:47.235Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.235Z"}[0m
[32m2026-01-17T16:01:47.236Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"ffd6031c-a30c-48f8-85e7-83da01033f03","spanId":"314c8566","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.237Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T16:01:47.237Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m[32m2026-01-17T16:01:47.237Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.237Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"1d236330-aa70-4a11-bdc6-48e1e08e20f4","spanId":"4cde64f7","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:01:47.240Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T16:01:47.238Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"2f66e393-d4d8-4fca-a5ec-85854aa9bf64","spanId":"d9abe3fa","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.244Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T16:01:47.244Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.244Z"}[0m
[32m2026-01-17T16:01:47.245Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"2f66e393-d4d8-4fca-a5ec-85854aa9bf64","spanId":"d9abe3fa","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.247Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T16:01:47.254Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.254Z"}[0m
[32m2026-01-17T16:01:47.255Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return system health status
[22m[39m[32m2026-01-17T16:01:47.264Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.264Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"2855a1a5-6c7b-496e-8336-200d8ce45f18","spanId":"24e75766","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.270Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m[32m2026-01-17T16:01:47.270Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.270Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T16:01:47.271Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"2855a1a5-6c7b-496e-8336-200d8ce45f18","spanId":"24e75766","method":"POST","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.273Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"49b7e74c-247e-47b6-9228-6554603ee2e7","spanId":"842dbb63","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.280Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m[32m2026-01-17T16:01:47.280Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.280Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T16:01:47.281Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"49b7e74c-247e-47b6-9228-6554603ee2e7","spanId":"842dbb63","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.283Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"b0944091-5c58-4ce5-8c74-9ce11faf71b1","spanId":"bf9fd922","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.288Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T16:01:47.290Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m[32m2026-01-17T16:01:47.289Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.289Z"}[0m


[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"b0944091-5c58-4ce5-8c74-9ce11faf71b1","spanId":"bf9fd922","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:01:47.292Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"4188d82c-c53a-4f99-a00a-061098896cda","spanId":"10a68ff7","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.302Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m[32m2026-01-17T16:01:47.302Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.302Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T16:01:47.302Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"4188d82c-c53a-4f99-a00a-061098896cda","spanId":"10a68ff7","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.304Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"f8687c9d-05f1-44ea-b1a3-438b7dd6c839","spanId":"6b28e9f1","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.314Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T16:01:47.315Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m[32m2026-01-17T16:01:47.315Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.315Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"f8687c9d-05f1-44ea-b1a3-438b7dd6c839","spanId":"6b28e9f1","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.317Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"bf272ab6-eece-4ec6-8b12-95b94322dfef","spanId":"974bd181","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.322Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T16:01:47.323Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.323Z"}[0m
[32m2026-01-17T16:01:47.323Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"bf272ab6-eece-4ec6-8b12-95b94322dfef","spanId":"974bd181","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.325Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"f46913e8-c803-4cd2-82a1-ee25806d9ed3","spanId":"45b7bc08","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.346Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T16:01:47.348Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m[32m2026-01-17T16:01:47.347Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.347Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"f46913e8-c803-4cd2-82a1-ee25806d9ed3","spanId":"45b7bc08","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:01:47.354Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"ab14f202-6637-40c8-9596-3e1c5e9d157f","spanId":"05fd9681","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.362Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T16:01:47.364Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m[32m2026-01-17T16:01:47.363Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.363Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"ab14f202-6637-40c8-9596-3e1c5e9d157f","spanId":"05fd9681","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.365Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"58d01fdd-12ea-4cde-bfe6-2b0efcaac610","spanId":"a4f723e0","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.377Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m[32m2026-01-17T16:01:47.377Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.377Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T16:01:47.378Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"58d01fdd-12ea-4cde-bfe6-2b0efcaac610","spanId":"a4f723e0","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.379Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T16:01:47.382Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"81c9b110-c86d-43e5-8fa9-2399e8755b96","spanId":"b1004cd0","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.406Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T16:01:47.407Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m[32m2026-01-17T16:01:47.407Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.407Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"81c9b110-c86d-43e5-8fa9-2399e8755b96","spanId":"b1004cd0","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.409Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"d512d320-66a2-410a-8a60-526b2e8f202a","spanId":"a81add30","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.414Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m[32m2026-01-17T16:01:47.414Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.414Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T16:01:47.414Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"d512d320-66a2-410a-8a60-526b2e8f202a","spanId":"a81add30","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.416Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"f43312d6-3ced-44ef-8cfb-52eadfa15166","spanId":"ec43e29d","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.420Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T16:01:47.421Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m[32m2026-01-17T16:01:47.421Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.421Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"f43312d6-3ced-44ef-8cfb-52eadfa15166","spanId":"ec43e29d","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.422Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"6e47b0fb-c6b1-4c1e-b013-0c577eeeee2f","spanId":"96208919","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.424Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m[32m2026-01-17T16:01:47.424Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.424Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T16:01:47.425Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"4430d872-9f1c-4234-b31a-5aac65b777f4","spanId":"92f9a16d","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.426Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"6e47b0fb-c6b1-4c1e-b013-0c577eeeee2f","spanId":"96208919","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.427Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:01:47.426Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.426Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T16:01:47.427Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"4430d872-9f1c-4234-b31a-5aac65b777f4","spanId":"92f9a16d","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.428Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"977683bc-06d6-4b75-acf6-f1a7cc165c47","spanId":"c09dce82","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.432Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T16:01:47.432Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.432Z"}[0m
[32m2026-01-17T16:01:47.433Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"977683bc-06d6-4b75-acf6-f1a7cc165c47","spanId":"c09dce82","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.435Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"ca5a4a5c-6f5f-43eb-91f7-1fdb4b54210c","spanId":"70ef9b5f","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.439Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T16:01:47.437Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.437Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T16:01:47.440Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.440Z"}[0m
[32m2026-01-17T16:01:47.440Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"ca5a4a5c-6f5f-43eb-91f7-1fdb4b54210c","spanId":"70ef9b5f","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.442Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"c8dcca0d-5d3f-4780-b1f1-7f8746e89cf2","spanId":"69c2bfae","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.448Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m[32m2026-01-17T16:01:47.448Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.448Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T16:01:47.449Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"c8dcca0d-5d3f-4780-b1f1-7f8746e89cf2","spanId":"69c2bfae","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.450Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"e8d13059-4967-4319-a471-7be261bc2b7f","spanId":"35e6d04d","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.456Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"8ede99eb-4d78-4e6f-b6d1-a67fe03ce9fd","spanId":"05da630f","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.457Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T16:01:47.457Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m[32m2026-01-17T16:01:47.457Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.457Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"e8d13059-4967-4319-a471-7be261bc2b7f","spanId":"35e6d04d","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.459Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T16:01:47.457Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.457Z"}[0m
[32m2026-01-17T16:01:47.458Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"8ede99eb-4d78-4e6f-b6d1-a67fe03ce9fd","spanId":"05da630f","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.460Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 864[2mms[22m[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"972e2b12-85f8-4e4e-8b81-b177c05aac31","spanId":"1f83ad4f","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.467Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T16:01:47.469Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.469Z"}[0m
[32m2026-01-17T16:01:47.469Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"972e2b12-85f8-4e4e-8b81-b177c05aac31","spanId":"1f83ad4f","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:01:47.472Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T16:01:47.472Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"1e8c7c63-fd6e-4e61-b49e-d4bf5642749e","spanId":"d30ac831","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.479Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"5786915d-c50f-4a22-a008-f85a67705ea3","spanId":"f0faffad","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.479Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T16:01:47.479Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.479Z"}[0m
[32m2026-01-17T16:01:47.480Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"1e8c7c63-fd6e-4e61-b49e-d4bf5642749e","spanId":"d30ac831","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:01:47.483Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"6959ea25-b0c6-4911-ad13-8fca385693ce","spanId":"aaaaf266","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.494Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T16:01:47.490Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.490Z"}[0m
[32m2026-01-17T16:01:47.494Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T16:01:47.495Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.495Z"}[0m
[32m2026-01-17T16:01:47.495Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"6959ea25-b0c6-4911-ad13-8fca385693ce","spanId":"aaaaf266","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.496Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T16:01:47.490Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.490Z"}[0m
[32m2026-01-17T16:01:47.495Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"64dba2de-92f6-4e06-866e-b6c60ba147e5","spanId":"443c3cae","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.502Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"5801d959-2013-49eb-a134-5a32c982553b","spanId":"c93e9c18","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.505Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m[32m2026-01-17T16:01:47.502Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.502Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T16:01:47.503Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"64dba2de-92f6-4e06-866e-b6c60ba147e5","spanId":"443c3cae","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.504Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"d5f9d83d-18fe-4a25-bf38-efb81e178b01","spanId":"050207f3","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.509Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T16:01:47.510Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m[32m2026-01-17T16:01:47.510Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.510Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"5786915d-c50f-4a22-a008-f85a67705ea3","spanId":"f0faffad","method":"GET","path":"/","statusCode":200,"duration":31,"timestamp":"2026-01-17T16:01:47.510Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"d5f9d83d-18fe-4a25-bf38-efb81e178b01","spanId":"050207f3","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.512Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T16:01:47.506Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.506Z"}[0m
[32m2026-01-17T16:01:47.507Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"5801d959-2013-49eb-a134-5a32c982553b","spanId":"c93e9c18","method":"GET","path":"/api/auth/user","statusCode":401,"duration":9,"timestamp":"2026-01-17T16:01:47.514Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"e90249e4-1aea-4d83-947f-2352040e3a2a","spanId":"dcfbb5f7","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.517Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T16:01:47.517Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.517Z"}[0m
[32m2026-01-17T16:01:47.518Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"03c036c5-c59d-463e-8171-fde4a5e17154","spanId":"10d835ed","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.519Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"e90249e4-1aea-4d83-947f-2352040e3a2a","spanId":"dcfbb5f7","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.520Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T16:01:47.520Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.520Z"}[0m
[32m2026-01-17T16:01:47.520Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"03c036c5-c59d-463e-8171-fde4a5e17154","spanId":"10d835ed","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:01:47.523Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"7f787e4e-d4d7-4134-93fd-6b48d0af6884","spanId":"6ae21901","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.529Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"3f04315a-5019-47c1-95da-243c4d2fb812","spanId":"44bcc2b3","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.531Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T16:01:47.530Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.530Z"}[0m
[32m2026-01-17T16:01:47.531Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:01:47.532Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.532Z"}[0m
[32m2026-01-17T16:01:47.533Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"7f787e4e-d4d7-4134-93fd-6b48d0af6884","spanId":"6ae21901","method":"GET","path":"/api/documents","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:01:47.534Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"3f04315a-5019-47c1-95da-243c4d2fb812","spanId":"44bcc2b3","method":"GET","path":"/","statusCode":200,"duration":11,"timestamp":"2026-01-17T16:01:47.542Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"b736e88f-9e17-495f-8aab-38a19b4fc302","spanId":"2b12e750","method":"GET","path":"/api/frameworks/SOC2/required-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.545Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T16:01:47.545Z [INFO] GET /api/frameworks/SOC2/required-templates {"method":"GET","url":"/api/frameworks/SOC2/required-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.545Z"}[0m
[32m2026-01-17T16:01:47.546Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/required-templates","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"b736e88f-9e17-495f-8aab-38a19b4fc302","spanId":"2b12e750","method":"GET","path":"/api/frameworks/SOC2/required-templates","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.547Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 1066[2mms[22m[39m
[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"ed4f4507-7ef6-43bc-a52f-08942146f444","spanId":"5a081abd","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.554Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T16:01:47.554Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.554Z"}[0m
[32m2026-01-17T16:01:47.554Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"ed4f4507-7ef6-43bc-a52f-08942146f444","spanId":"5a081abd","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.556Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 843[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"8256a23b-3de3-49f5-b2ea-3cb13d86e0ae","spanId":"3ab52fc8","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.562Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:01:47.563Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.563Z"}[0m
[32m2026-01-17T16:01:47.563Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"8256a23b-3de3-49f5-b2ea-3cb13d86e0ae","spanId":"3ab52fc8","method":"GET","path":"/iso-001","statusCode":200,"duration":3,"timestamp":"2026-01-17T16:01:47.565Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T16:01:47.596Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T16:01:47.616Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.616Z"}[0m
[32m2026-01-17T16:01:47.619Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"b9350c77-2494-4c48-b500-7dea962b1696","spanId":"f5cea87b","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.628Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T16:01:47.628Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.628Z"}[0m
[32m2026-01-17T16:01:47.629Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"b9350c77-2494-4c48-b500-7dea962b1696","spanId":"f5cea87b","method":"GET","path":"/api/auth/user","statusCode":401,"duration":9,"timestamp":"2026-01-17T16:01:47.636Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"d14cf4a7-352a-4b37-9e9d-39d54ba785cc","spanId":"913d9b7f","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.642Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T16:01:47.643Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.643Z"}[0m
[32m2026-01-17T16:01:47.643Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"d14cf4a7-352a-4b37-9e9d-39d54ba785cc","spanId":"913d9b7f","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:01:47.646Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"95750b63-ef3a-48a2-96f2-02ac269d3a37","spanId":"d79d7172","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.647Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:01:47.648Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.648Z"}[0m
[32m2026-01-17T16:01:47.649Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"95750b63-ef3a-48a2-96f2-02ac269d3a37","spanId":"d79d7172","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:01:47.654Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"16d3ce92-aeca-46dc-8334-7c2968173f6e","spanId":"f265bec8","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.665Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"9e29bcd1-febf-48cf-9cbc-c82a0aa57863","spanId":"ea07cbae","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.665Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T16:01:47.666Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.666Z"}[0m
[32m2026-01-17T16:01:47.666Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"16d3ce92-aeca-46dc-8334-7c2968173f6e","spanId":"f265bec8","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.668Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:01:47.666Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.666Z"}[0m
[32m2026-01-17T16:01:47.666Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"9e29bcd1-febf-48cf-9cbc-c82a0aa57863","spanId":"ea07cbae","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.668Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"a3c73c41-191e-4c74-960e-b9262a1ec106","spanId":"707b0f7b","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.675Z"}
stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T16:01:47.676Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T16:01:47.685Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}


[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:01:47.675Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.675Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"a3c73c41-191e-4c74-960e-b9262a1ec106","spanId":"707b0f7b","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.678Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T16:01:47.724Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T16:01:47.739Z [ERROR] Database health check failed {"error":"Unknown error"}

[22m[39m{"type":"request_start","traceId":"5af5561e-7444-44ac-9a2e-14ba64de29ea","spanId":"b6c413ed","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.683Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m[32m2026-01-17T16:01:47.684Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.684Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"5af5561e-7444-44ac-9a2e-14ba64de29ea","spanId":"b6c413ed","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.686Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"d3b38a05-66d6-4c36-84d7-38858adc3f42","spanId":"d428ba68","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.695Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T16:01:47.696Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.696Z"}[0m
[32m2026-01-17T16:01:47.697Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"d3b38a05-66d6-4c36-84d7-38858adc3f42","spanId":"d428ba68","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":3,"timestamp":"2026-01-17T16:01:47.698Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"474154a5-9dab-4e2e-bfcd-bc857225ffa0","spanId":"7e65876b","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.709Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T16:01:47.710Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.710Z"}[0m
[32m2026-01-17T16:01:47.711Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"474154a5-9dab-4e2e-bfcd-bc857225ffa0","spanId":"7e65876b","method":"GET","path":"/api/auth/user","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.712Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T16:01:47.720Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.720Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T16:01:47.734Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.734Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"bd4a796a-3a43-49c0-8407-138ea24e29dd","spanId":"9aface05","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.754Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T16:01:47.754Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.754Z"}[0m
[32m2026-01-17T16:01:47.755Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"bd4a796a-3a43-49c0-8407-138ea24e29dd","spanId":"9aface05","method":"POST","path":"/export-document","statusCode":200,"duration":3,"timestamp":"2026-01-17T16:01:47.757Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"fa30b68c-5804-44a8-b5ba-039f6f2b362b","spanId":"5876ac2b","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.765Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T16:01:47.765Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.765Z"}[0m
[32m2026-01-17T16:01:47.766Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"fa30b68c-5804-44a8-b5ba-039f6f2b362b","spanId":"5876ac2b","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T16:01:47.768Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"eacc76a7-6867-4553-9ecb-41775efb1bab","spanId":"1837017d","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.773Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T16:01:47.774Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.774Z"}[0m
[32m2026-01-17T16:01:47.774Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"eacc76a7-6867-4553-9ecb-41775efb1bab","spanId":"1837017d","method":"POST","path":"/api/generate-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.775Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 688[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 205[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 14[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 23[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 11[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 13[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 12[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 15[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 43[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"8c9d1228-cef6-4077-942a-19025faca985","spanId":"40306370","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.788Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T16:01:47.790Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.790Z"}[0m
[32m2026-01-17T16:01:47.791Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"8c9d1228-cef6-4077-942a-19025faca985","spanId":"40306370","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:01:47.794Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"6c33d33d-701d-4fe0-ab7d-4704f702a264","spanId":"dab995d3","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.800Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T16:01:47.802Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.802Z"}[0m
[32m2026-01-17T16:01:47.802Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"6c33d33d-701d-4fe0-ab7d-4704f702a264","spanId":"dab995d3","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:01:47.805Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"487082a4-c972-4157-8208-331ee1189c31","spanId":"490ac83e","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.814Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T16:01:47.815Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.815Z"}[0m
[32m2026-01-17T16:01:47.815Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"487082a4-c972-4157-8208-331ee1189c31","spanId":"490ac83e","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.817Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"9aa9e707-9165-4ceb-9839-1b819059d85a","spanId":"a56b6659","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.823Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T16:01:47.824Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.824Z"}[0m
[32m2026-01-17T16:01:47.824Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"9aa9e707-9165-4ceb-9839-1b819059d85a","spanId":"a56b6659","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.826Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"619725b4-675f-44c8-b3bd-3e686608979f","spanId":"74d7d207","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.831Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T16:01:47.832Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.832Z"}[0m
[32m2026-01-17T16:01:47.832Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"619725b4-675f-44c8-b3bd-3e686608979f","spanId":"74d7d207","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:01:47.834Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"2ee55599-97c7-4354-b97c-bad0b727df93","spanId":"3716e676","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.843Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T16:01:47.843Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.843Z"}[0m
[32m2026-01-17T16:01:47.844Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"2ee55599-97c7-4354-b97c-bad0b727df93","spanId":"3716e676","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.845Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"9a6c071a-7d35-413b-8837-3bbd60504451","spanId":"aada1e15","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:01:47.851Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T16:01:47.851Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:01:47.851Z"}[0m
[32m2026-01-17T16:01:47.852Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"9a6c071a-7d35-413b-8837-3bbd60504451","spanId":"aada1e15","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:01:47.853Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 716[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 2 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/2]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/2]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m66 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 08:01:40
[2m   Duration [22m 34.72s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T16:02:08.682Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"ce06cb0f-856c-44a7-8d9d-8a71bedb011a","spanId":"ef2bf85e","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:08.876Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T16:02:08.891Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:02:08.888Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:08.888Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"ce06cb0f-856c-44a7-8d9d-8a71bedb011a","spanId":"ef2bf85e","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":25,"timestamp":"2026-01-17T16:02:08.901Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"f80b24a4-4170-44b2-85d1-76e24c959f2e","spanId":"cb46e633","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.006Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T16:02:09.008Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.008Z"}[0m
[32m2026-01-17T16:02:09.009Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"f80b24a4-4170-44b2-85d1-76e24c959f2e","spanId":"cb46e633","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:02:09.012Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"c943c384-034c-410c-9bbc-92528701c0ef","spanId":"b3344f6d","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.019Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T16:02:09.020Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m[32m2026-01-17T16:02:09.020Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.020Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"c943c384-034c-410c-9bbc-92528701c0ef","spanId":"b3344f6d","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.022Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"03b818f4-3e4e-4856-ac73-93fa1625d887","spanId":"7d88bd79","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.029Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T16:02:09.031Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m[32m2026-01-17T16:02:09.030Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.030Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"03b818f4-3e4e-4856-ac73-93fa1625d887","spanId":"7d88bd79","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.032Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"fb58f9c7-6bc9-4f83-a223-4740b29499b9","spanId":"8c5a0600","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.038Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T16:02:09.039Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m[32m2026-01-17T16:02:09.039Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.039Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"fb58f9c7-6bc9-4f83-a223-4740b29499b9","spanId":"8c5a0600","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.041Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"3d88254d-0672-45dc-baef-de0b773f56f7","spanId":"17a86554","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.046Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T16:02:09.048Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m[32m2026-01-17T16:02:09.047Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.047Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"3d88254d-0672-45dc-baef-de0b773f56f7","spanId":"17a86554","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.050Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"5c22f089-4edc-4bf3-8559-60ffbdb7ecc8","spanId":"ba146d38","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.058Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T16:02:09.059Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m[32m2026-01-17T16:02:09.058Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.058Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"5c22f089-4edc-4bf3-8559-60ffbdb7ecc8","spanId":"ba146d38","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:09.060Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"b3e535f7-7c8e-41c1-a068-64fce1106f1c","spanId":"fd0e43e5","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.073Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T16:02:09.074Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.074Z"}[0m
[32m2026-01-17T16:02:09.075Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"b3e535f7-7c8e-41c1-a068-64fce1106f1c","spanId":"fd0e43e5","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.077Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"4fd33bd1-9107-4a24-bee4-9bc7a2f321df","spanId":"54b2b761","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.088Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T16:02:09.089Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.089Z"}[0m
[32m2026-01-17T16:02:09.090Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"4fd33bd1-9107-4a24-bee4-9bc7a2f321df","spanId":"54b2b761","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":18,"timestamp":"2026-01-17T16:02:09.106Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"15f5cf25-e5ab-4f26-aced-e091a4171205","spanId":"7a522f43","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.113Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T16:02:09.114Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.114Z"}[0m
stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T16:02:09.132Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T16:02:09.206Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[32m2026-01-17T16:02:09.114Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"15f5cf25-e5ab-4f26-aced-e091a4171205","spanId":"7a522f43","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:09.115Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"e6f6cab9-f543-4e32-8cbb-b8b3574ab238","spanId":"e5543856","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.121Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T16:02:09.122Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.122Z"}[0m
[32m2026-01-17T16:02:09.123Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"e6f6cab9-f543-4e32-8cbb-b8b3574ab238","spanId":"e5543856","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.124Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"237e920b-e538-4250-b91e-5265300f59ba","spanId":"c41bc52d","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.131Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m[32m2026-01-17T16:02:09.131Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.131Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"237e920b-e538-4250-b91e-5265300f59ba","spanId":"c41bc52d","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":45,"timestamp":"2026-01-17T16:02:09.176Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"9d35d6b8-b23e-4358-b416-fbe781b263e1","spanId":"8ded1440","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.205Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m[32m2026-01-17T16:02:09.206Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.205Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"9d35d6b8-b23e-4358-b416-fbe781b263e1","spanId":"8ded1440","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:02:09.209Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"120c2185-9966-4a36-b090-d2c9b0c24b35","spanId":"43b38608","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.225Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T16:02:09.227Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.227Z"}[0m
[32m2026-01-17T16:02:09.228Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"120c2185-9966-4a36-b090-d2c9b0c24b35","spanId":"43b38608","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:02:09.235Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"71739ca4-374a-48b3-93e0-eb98a1355e05","spanId":"0a853de5","method":"GET","path":"/api/frameworks/SOC2/required-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.245Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T16:02:09.246Z [INFO] GET /api/frameworks/SOC2/required-templates {"method":"GET","url":"/api/frameworks/SOC2/required-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.246Z"}[0m
[32m2026-01-17T16:02:09.246Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/required-templates","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"71739ca4-374a-48b3-93e0-eb98a1355e05","spanId":"0a853de5","method":"GET","path":"/api/frameworks/SOC2/required-templates","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.249Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T16:02:09.244Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 701[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T16:02:09.269Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T16:02:09.338Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T16:02:09.386Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.386Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"5b065003-3563-4e0d-a61a-aaf5a62edbaa","spanId":"96c268ee","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.403Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T16:02:09.414Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.414Z"}[0m
[32m2026-01-17T16:02:09.418Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"5b065003-3563-4e0d-a61a-aaf5a62edbaa","spanId":"96c268ee","method":"GET","path":"/","statusCode":200,"duration":31,"timestamp":"2026-01-17T16:02:09.433Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return system health status
[22m[39m[32m2026-01-17T16:02:09.462Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.462Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"971e3778-a26d-4840-b8f7-86e783bd2198","spanId":"aec169c0","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.466Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:02:09.468Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.468Z"}[0m
[32m2026-01-17T16:02:09.468Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"971e3778-a26d-4840-b8f7-86e783bd2198","spanId":"aec169c0","method":"GET","path":"/","statusCode":200,"duration":16,"timestamp":"2026-01-17T16:02:09.482Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"39a4d6c9-68ab-4867-9507-c6d249ef3ca0","spanId":"8ea03879","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.497Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:02:09.498Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.498Z"}[0m
[32m2026-01-17T16:02:09.499Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T16:02:09.498Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"39a4d6c9-68ab-4867-9507-c6d249ef3ca0","spanId":"8ea03879","method":"GET","path":"/iso-001","statusCode":200,"duration":5,"timestamp":"2026-01-17T16:02:09.502Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"ed127e84-b35a-4c70-85d5-f664f90ec4fb","spanId":"e88d999c","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.536Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T16:02:09.539Z [ERROR] Database health check failed {"error":"Unknown error"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T16:02:09.551Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:02:09.537Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.537Z"}[0m
[32m2026-01-17T16:02:09.538Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"ed127e84-b35a-4c70-85d5-f664f90ec4fb","spanId":"e88d999c","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":19,"timestamp":"2026-01-17T16:02:09.555Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"2e9dbcda-2997-4616-bfc2-caf353925479","spanId":"5c6fe1ed","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.564Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T16:02:09.560Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.560Z"}[0m
[32m2026-01-17T16:02:09.563Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T16:02:09.565Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.565Z"}[0m
[32m2026-01-17T16:02:09.566Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"2e9dbcda-2997-4616-bfc2-caf353925479","spanId":"5c6fe1ed","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.568Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T16:02:09.569Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.569Z"}[0m
[32m2026-01-17T16:02:09.572Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"7246f20e-d2c1-4677-85fb-09635853d933","spanId":"4b8aba7d","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.574Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"4191f665-54ed-4707-8ede-75a7ab2aa304","spanId":"2bd6e9a7","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.576Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T16:02:09.577Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.577Z"}[0m
[32m2026-01-17T16:02:09.577Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"4191f665-54ed-4707-8ede-75a7ab2aa304","spanId":"2bd6e9a7","method":"GET","path":"/api/auth/user","statusCode":401,"duration":9,"timestamp":"2026-01-17T16:02:09.585Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"f865d169-a3d0-4645-a2eb-1a64eda7ce58","spanId":"51287ac5","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.591Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T16:02:09.592Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.592Z"}[0m
[32m2026-01-17T16:02:09.593Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"f865d169-a3d0-4645-a2eb-1a64eda7ce58","spanId":"51287ac5","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:09.596Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"3c3b4daa-0cbf-41de-b953-69691630c9bb","spanId":"96c90637","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.616Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T16:02:09.629Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.629Z"}[0m
[32m2026-01-17T16:02:09.634Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"3c3b4daa-0cbf-41de-b953-69691630c9bb","spanId":"96c90637","method":"POST","path":"/api/organizations","statusCode":401,"duration":31,"timestamp":"2026-01-17T16:02:09.646Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"89cbfe26-a7c2-4d45-b00e-8da8c0b0a3c1","spanId":"c02deeb6","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.664Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T16:02:09.665Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.665Z"}[0m
[32m2026-01-17T16:02:09.665Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"89cbfe26-a7c2-4d45-b00e-8da8c0b0a3c1","spanId":"c02deeb6","method":"GET","path":"/api/organizations","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.668Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T16:02:09.575Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.575Z"}[0m
[32m2026-01-17T16:02:09.575Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"7246f20e-d2c1-4677-85fb-09635853d933","spanId":"4b8aba7d","method":"POST","path":"/export-document","statusCode":200,"duration":114,"timestamp":"2026-01-17T16:02:09.688Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"ff2014d8-58c5-49d0-9365-69f99305446b","spanId":"f84e87a7","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.694Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T16:02:09.695Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.695Z"}[0m
[32m2026-01-17T16:02:09.695Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"ff2014d8-58c5-49d0-9365-69f99305446b","spanId":"f84e87a7","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":8,"timestamp":"2026-01-17T16:02:09.701Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"49dfb350-0eee-4faa-ab3a-cc1ca4c041c7","spanId":"a0be7d56","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.710Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T16:02:09.710Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.710Z"}[0m
[32m2026-01-17T16:02:09.711Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"49dfb350-0eee-4faa-ab3a-cc1ca4c041c7","spanId":"a0be7d56","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.713Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"8d16de1b-7918-4380-99e9-6a28d5b44ea7","spanId":"c0e51ae3","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.714Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T16:02:09.714Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.714Z"}[0m
[32m2026-01-17T16:02:09.715Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"8d16de1b-7918-4380-99e9-6a28d5b44ea7","spanId":"c0e51ae3","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T16:02:09.717Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"8989e34d-8c2e-4256-bc35-342e1be99aeb","spanId":"1d0017f0","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.725Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T16:02:09.726Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.725Z"}[0m
[32m2026-01-17T16:02:09.726Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"8989e34d-8c2e-4256-bc35-342e1be99aeb","spanId":"1d0017f0","method":"POST","path":"/api/generate-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:09.728Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"6590657b-7f61-4fc2-a49a-ad90bf46b54a","spanId":"8ac75bfe","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.729Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T16:02:09.730Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m[32m2026-01-17T16:02:09.730Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.730Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"6590657b-7f61-4fc2-a49a-ad90bf46b54a","spanId":"8ac75bfe","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.732Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"2798f6b4-e83f-46ab-babf-01fe0907a278","spanId":"f01ab122","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.737Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"ac837ef7-a016-42eb-b77d-826c45d07a46","spanId":"c8d8702b","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.739Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T16:02:09.739Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.739Z"}[0m
[32m2026-01-17T16:02:09.740Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T16:02:09.737Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.737Z"}[0m
[32m2026-01-17T16:02:09.738Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"2798f6b4-e83f-46ab-babf-01fe0907a278","spanId":"f01ab122","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.740Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"ac837ef7-a016-42eb-b77d-826c45d07a46","spanId":"c8d8702b","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.742Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"41ca48fd-30fe-4a9a-9fa9-5a66f7b3879c","spanId":"e1aa592a","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.746Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"a71cc10d-4fc4-498c-8c88-1ff1a0487c5b","spanId":"25e68b3f","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.746Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"df16dfdf-a0b8-4b87-8dda-d05c97c40560","spanId":"f98509d8","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.748Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T16:02:09.749Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.749Z"}[0m
[32m2026-01-17T16:02:09.749Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T16:02:09.747Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.747Z"}[0m
[32m2026-01-17T16:02:09.748Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"df16dfdf-a0b8-4b87-8dda-d05c97c40560","spanId":"f98509d8","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.752Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"a71cc10d-4fc4-498c-8c88-1ff1a0487c5b","spanId":"25e68b3f","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:09.751Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T16:02:09.747Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.747Z"}[0m
[32m2026-01-17T16:02:09.747Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"41ca48fd-30fe-4a9a-9fa9-5a66f7b3879c","spanId":"e1aa592a","method":"GET","path":"/api/auth/user","statusCode":401,"duration":12,"timestamp":"2026-01-17T16:02:09.758Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"e1408bf1-6322-46fc-8432-dc32d663a0c9","spanId":"7ae727db","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.759Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T16:02:09.760Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.760Z"}[0m
[32m2026-01-17T16:02:09.771Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"e1408bf1-6322-46fc-8432-dc32d663a0c9","spanId":"7ae727db","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":14,"timestamp":"2026-01-17T16:02:09.773Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"8273a11e-5b47-4429-98f6-aa1896996623","spanId":"299a5f3a","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.783Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"b62cf84b-bbe5-492f-a709-71308f97290c","spanId":"c6533840","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.783Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T16:02:09.783Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.783Z"}[0m
[32m2026-01-17T16:02:09.783Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"b62cf84b-bbe5-492f-a709-71308f97290c","spanId":"c6533840","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:09.785Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T16:02:09.784Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.784Z"}[0m
[32m2026-01-17T16:02:09.784Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"8273a11e-5b47-4429-98f6-aa1896996623","spanId":"299a5f3a","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:09.788Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"9129be21-3394-4d90-bf15-6b7add67f57b","spanId":"2678d900","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.793Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T16:02:09.793Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.793Z"}[0m
[32m2026-01-17T16:02:09.794Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"9129be21-3394-4d90-bf15-6b7add67f57b","spanId":"2678d900","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.797Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"76f8bbe5-0c6d-4017-a0c1-8a07a62e0b61","spanId":"7e003c32","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.804Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T16:02:09.805Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.805Z"}[0m
[32m2026-01-17T16:02:09.805Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"76f8bbe5-0c6d-4017-a0c1-8a07a62e0b61","spanId":"7e003c32","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.807Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"d5ba47ec-dc3d-4aec-81ff-603359261aef","spanId":"e2ae4042","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.812Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T16:02:09.812Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.812Z"}[0m
[32m2026-01-17T16:02:09.813Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"d5ba47ec-dc3d-4aec-81ff-603359261aef","spanId":"e2ae4042","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:09.814Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"4f5b567f-7974-4d75-b3c1-147310ef7835","spanId":"05a6cd64","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.820Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:02:09.821Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.821Z"}[0m
[32m2026-01-17T16:02:09.821Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"4f5b567f-7974-4d75-b3c1-147310ef7835","spanId":"05a6cd64","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.823Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 800[2mms[22m[39m
[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"8854404d-43d7-43f7-bb64-957db80d4723","spanId":"df8fbd04","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.833Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T16:02:09.834Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:02:09.834Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.834Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"8854404d-43d7-43f7-bb64-957db80d4723","spanId":"df8fbd04","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.836Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"c4734cd2-fb77-4d6f-81d9-9cb113a919e6","spanId":"0aa4bb73","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.844Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T16:02:09.845Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.845Z"}[0m
[32m2026-01-17T16:02:09.846Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"c4734cd2-fb77-4d6f-81d9-9cb113a919e6","spanId":"0aa4bb73","method":"GET","path":"/api/documents","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:09.849Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"083558ec-9aec-4ed0-ac4e-e534de6fd026","spanId":"a1e9e657","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.847Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T16:02:09.852Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m[32m2026-01-17T16:02:09.851Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.851Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"083558ec-9aec-4ed0-ac4e-e534de6fd026","spanId":"a1e9e657","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:02:09.854Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"57db627b-f0cc-438b-8e7e-3203e1cc2e1e","spanId":"19b68f15","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.866Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T16:02:09.867Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.867Z"}[0m
[32m2026-01-17T16:02:09.867Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"57db627b-f0cc-438b-8e7e-3203e1cc2e1e","spanId":"19b68f15","method":"POST","path":"/setup","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.870Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T16:02:09.872Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.872Z"}[0m
[32m2026-01-17T16:02:09.873Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"3f6422f9-e658-452c-b56b-7bd67a818c77","spanId":"be9505c7","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.877Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T16:02:09.880Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.880Z"}[0m
[32m2026-01-17T16:02:09.880Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"3f6422f9-e658-452c-b56b-7bd67a818c77","spanId":"be9505c7","method":"GET","path":"/api/auth/user","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:09.882Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"ef709bf7-31c1-4597-b10f-2ade4d5974f7","spanId":"f32d7575","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.890Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T16:02:09.892Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.892Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T16:02:09.891Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m[32m2026-01-17T16:02:09.891Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.891Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"ef709bf7-31c1-4597-b10f-2ade4d5974f7","spanId":"f32d7575","method":"POST","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.894Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"126f60c0-8f8b-4b80-ab03-be8f93f9a8d1","spanId":"90a412ca","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.900Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T16:02:09.901Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m[32m2026-01-17T16:02:09.901Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.901Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"126f60c0-8f8b-4b80-ab03-be8f93f9a8d1","spanId":"90a412ca","method":"GET","path":"/api/evidence","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:09.905Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"cf7206e3-6fae-4e90-b0ff-f392b586b26f","spanId":"cfb27c4b","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.916Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T16:02:09.917Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m[32m2026-01-17T16:02:09.917Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.917Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"cf7206e3-6fae-4e90-b0ff-f392b586b26f","spanId":"cfb27c4b","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":20,"timestamp":"2026-01-17T16:02:09.937Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"c5a8cd55-3eab-4611-9c96-7bc59be0755c","spanId":"bfa7812c","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.952Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T16:02:09.954Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m[32m2026-01-17T16:02:09.953Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.953Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"696c87b4-ea63-4757-b9dc-311a8dfde047","spanId":"426fbbb4","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.955Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"c5a8cd55-3eab-4611-9c96-7bc59be0755c","spanId":"bfa7812c","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:09.956Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T16:02:09.956Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.956Z"}[0m
[32m2026-01-17T16:02:09.956Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"696c87b4-ea63-4757-b9dc-311a8dfde047","spanId":"426fbbb4","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:09.958Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"c686be41-6fe0-4bf5-bbf5-a58af19b4adb","spanId":"0aa3204c","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:09.962Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T16:02:09.963Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m[32m2026-01-17T16:02:09.963Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:09.963Z"}[0m

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 827[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"c686be41-6fe0-4bf5-bbf5-a58af19b4adb","spanId":"0aa3204c","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":13,"timestamp":"2026-01-17T16:02:09.974Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T16:02:09.990Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T16:02:10.022Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.022Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"2f12182e-fdbd-48b4-bf79-c3d0e541cca3","spanId":"351a690e","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:10.024Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T16:02:10.025Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.025Z"}[0m
[32m2026-01-17T16:02:10.035Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"2f12182e-fdbd-48b4-bf79-c3d0e541cca3","spanId":"351a690e","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":13,"timestamp":"2026-01-17T16:02:10.037Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T16:02:10.038Z [ERROR] Database health check failed {"error":"Unknown error"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 1057[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check[32m 210[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 11[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 230[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[32m 16[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 14[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 131[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 25[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"19780df9-20b3-4109-addd-cafb5c6af445","spanId":"88746e4e","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:10.067Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T16:02:10.068Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m[32m2026-01-17T16:02:10.068Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.068Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"19780df9-20b3-4109-addd-cafb5c6af445","spanId":"88746e4e","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:10.069Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"5ebcc993-cf63-418f-bb3e-c37f7404b99b","spanId":"bc667eca","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:10.080Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T16:02:10.081Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m[32m2026-01-17T16:02:10.081Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.081Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"5ebcc993-cf63-418f-bb3e-c37f7404b99b","spanId":"bc667eca","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:10.083Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"231ba325-75b7-4def-9e11-25316ba16b0b","spanId":"b18799a9","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:10.128Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m[32m2026-01-17T16:02:10.128Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.128Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T16:02:10.129Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"231ba325-75b7-4def-9e11-25316ba16b0b","spanId":"b18799a9","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:10.130Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"596df966-44df-4a29-b47d-f1bc88db0fb8","spanId":"a8903997","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:10.146Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:02:10.146Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.146Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T16:02:10.147Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"596df966-44df-4a29-b47d-f1bc88db0fb8","spanId":"a8903997","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:10.148Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"36501bd8-d74e-485f-95eb-53455a95fa9b","spanId":"ea664706","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:10.153Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T16:02:10.154Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.154Z"}[0m
[32m2026-01-17T16:02:10.154Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"36501bd8-d74e-485f-95eb-53455a95fa9b","spanId":"ea664706","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:10.155Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"ef9d5af5-6d01-43dd-9d4e-08fe54964fc3","spanId":"61debf99","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:10.161Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T16:02:10.162Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.162Z"}[0m
[32m2026-01-17T16:02:10.162Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"ef9d5af5-6d01-43dd-9d4e-08fe54964fc3","spanId":"61debf99","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:10.164Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"e58c5db1-72cd-418d-96dc-41f21d9e6fc3","spanId":"e65dddbb","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:10.168Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m[32m2026-01-17T16:02:10.168Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.168Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T16:02:10.168Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"e58c5db1-72cd-418d-96dc-41f21d9e6fc3","spanId":"e65dddbb","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":27,"timestamp":"2026-01-17T16:02:10.195Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"8ea9ffd4-87ac-4f59-b6af-7e912939bbe1","spanId":"3358691e","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:10.207Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m[32m2026-01-17T16:02:10.207Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:10.207Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T16:02:10.207Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"8ea9ffd4-87ac-4f59-b6af-7e912939bbe1","spanId":"3358691e","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:10.209Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 1065[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 1 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/1]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m67 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 08:02:02
[2m   Duration [22m 32.81s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T16:02:23.154Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"4945f02a-5be9-4ef4-ac6d-8f9259c5c520","spanId":"ea855569","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.469Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T16:02:23.495Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.495Z"}[0m
[32m2026-01-17T16:02:23.502Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T16:02:23.571Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"4945f02a-5be9-4ef4-ac6d-8f9259c5c520","spanId":"ea855569","method":"POST","path":"/api/organizations","statusCode":401,"duration":118,"timestamp":"2026-01-17T16:02:23.586Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T16:02:23.677Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"467bae11-b864-4312-8355-a38751e02b77","spanId":"5a5748a4","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.688Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T16:02:23.687Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T16:02:23.691Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.691Z"}[0m
[32m2026-01-17T16:02:23.692Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"467bae11-b864-4312-8355-a38751e02b77","spanId":"5a5748a4","method":"GET","path":"/api/organizations","statusCode":401,"duration":8,"timestamp":"2026-01-17T16:02:23.696Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"a2109486-826b-480c-81ed-fd084c03e670","spanId":"77f6d059","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.722Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T16:02:23.723Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.723Z"}[0m
[32m2026-01-17T16:02:23.723Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"a2109486-826b-480c-81ed-fd084c03e670","spanId":"77f6d059","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.725Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"511e046b-9ca5-472d-b02c-934ac8d52281","spanId":"ae893937","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.733Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T16:02:23.734Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.734Z"}[0m
[32m2026-01-17T16:02:23.734Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"511e046b-9ca5-472d-b02c-934ac8d52281","spanId":"ae893937","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.736Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"9a22342a-9b37-4e20-9d10-c5f89fc8657e","spanId":"8f7837a0","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.777Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"27ffca13-9a00-4bff-8bff-a444f571e2da","spanId":"f12aa37e","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.777Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T16:02:23.778Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m[32m2026-01-17T16:02:23.778Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.778Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"9a22342a-9b37-4e20-9d10-c5f89fc8657e","spanId":"8f7837a0","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.780Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"1cac5283-af9a-4ed8-9849-af6846e61c15","spanId":"0124a0c4","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.786Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T16:02:23.787Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.787Z"}[0m
[32m2026-01-17T16:02:23.787Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"1cac5283-af9a-4ed8-9849-af6846e61c15","spanId":"0124a0c4","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.789Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"1ef3e25c-f2ec-4dfd-bb9b-c81ea8b19b85","spanId":"bb2838cb","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.792Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"d2719f8b-45e4-40c2-a4ad-f2bf1d1f80d6","spanId":"8572f1b0","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.794Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T16:02:23.795Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.795Z"}[0m
[32m2026-01-17T16:02:23.795Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"d2719f8b-45e4-40c2-a4ad-f2bf1d1f80d6","spanId":"8572f1b0","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.797Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T16:02:23.805Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.805Z"}[0m
[32m2026-01-17T16:02:23.809Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T16:02:23.812Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.812Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"1ef3e25c-f2ec-4dfd-bb9b-c81ea8b19b85","spanId":"bb2838cb","method":"GET","path":"/","statusCode":200,"duration":32,"timestamp":"2026-01-17T16:02:23.823Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T16:02:23.848Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.848Z"}[0m
[32m2026-01-17T16:02:23.850Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"950f56eb-2e3a-4047-96e1-bb47efb64a25","spanId":"6cd723be","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.856Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:02:23.857Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.857Z"}[0m
[32m2026-01-17T16:02:23.857Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T16:02:23.847Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:02:23.842Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.842Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"27ffca13-9a00-4bff-8bff-a444f571e2da","spanId":"f12aa37e","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":83,"timestamp":"2026-01-17T16:02:23.860Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"950f56eb-2e3a-4047-96e1-bb47efb64a25","spanId":"6cd723be","method":"GET","path":"/","statusCode":200,"duration":16,"timestamp":"2026-01-17T16:02:23.871Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"9f7636db-a8e9-4e1f-9ad9-0ea681d35c4e","spanId":"7b91f1fe","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.878Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"9e778b72-8ec0-49f9-bdf5-84d4c7392296","spanId":"6cd7f88a","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.879Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T16:02:23.880Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m[32m2026-01-17T16:02:23.879Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.879Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"9f7636db-a8e9-4e1f-9ad9-0ea681d35c4e","spanId":"7b91f1fe","method":"POST","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:23.882Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T16:02:23.880Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.880Z"}[0m
[32m2026-01-17T16:02:23.881Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"9e778b72-8ec0-49f9-bdf5-84d4c7392296","spanId":"6cd7f88a","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:23.884Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"51ad3fa1-eb4e-412d-b1a0-49ce6d980d46","spanId":"7a1ceb4e","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.888Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:02:23.889Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.889Z"}[0m
[32m2026-01-17T16:02:23.890Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"51ad3fa1-eb4e-412d-b1a0-49ce6d980d46","spanId":"7a1ceb4e","method":"GET","path":"/iso-001","statusCode":200,"duration":5,"timestamp":"2026-01-17T16:02:23.893Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"841dc6d5-21e2-4314-bf19-d48b022e12c7","spanId":"3e948fb2","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.894Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T16:02:23.896Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m[32m2026-01-17T16:02:23.895Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.895Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"841dc6d5-21e2-4314-bf19-d48b022e12c7","spanId":"3e948fb2","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":12,"timestamp":"2026-01-17T16:02:23.906Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"8cc11fa6-0d6f-4c09-bd62-526bd25bf728","spanId":"fdea6555","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.918Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T16:02:23.920Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m[32m2026-01-17T16:02:23.919Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.919Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"8cc11fa6-0d6f-4c09-bd62-526bd25bf728","spanId":"fdea6555","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.921Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"f05cf61e-19e4-4083-81b2-33d47708c49c","spanId":"82ec91c7","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.930Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T16:02:23.931Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m[32m2026-01-17T16:02:23.931Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.931Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"f05cf61e-19e4-4083-81b2-33d47708c49c","spanId":"82ec91c7","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.933Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"ee87946e-fd19-4cea-a55e-fc7a58414043","spanId":"fda99231","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.934Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T16:02:23.935Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m[32m2026-01-17T16:02:23.934Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.934Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"ee87946e-fd19-4cea-a55e-fc7a58414043","spanId":"fda99231","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.937Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"18431196-1d75-42c1-b787-4d89fd79e282","spanId":"19831cf6","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.939Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m[32m2026-01-17T16:02:23.939Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.939Z"}[0m
stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T16:02:23.940Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}


[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"18431196-1d75-42c1-b787-4d89fd79e282","spanId":"19831cf6","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:23.941Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"57edb7e5-eb65-4b35-a466-d9efbe442ce3","spanId":"6a8f4a21","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.951Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T16:02:23.952Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m[32m2026-01-17T16:02:23.952Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.952Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"57edb7e5-eb65-4b35-a466-d9efbe442ce3","spanId":"6a8f4a21","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:23.953Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"4967a07a-8850-4392-891b-142e59575fa5","spanId":"d71f1f24","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.953Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T16:02:23.954Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m[32m2026-01-17T16:02:23.954Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.954Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"4967a07a-8850-4392-891b-142e59575fa5","spanId":"d71f1f24","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.956Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"24fcec8f-3ab1-4e3a-914d-2e97d386fa03","spanId":"d477011c","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.959Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T16:02:23.960Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.960Z"}[0m
[32m2026-01-17T16:02:23.960Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"24fcec8f-3ab1-4e3a-914d-2e97d386fa03","spanId":"d477011c","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:23.963Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"651df632-3c3d-40ea-9c58-fb3b6b3dd935","spanId":"ce319c96","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.962Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T16:02:23.963Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m[32m2026-01-17T16:02:23.963Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.963Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"651df632-3c3d-40ea-9c58-fb3b6b3dd935","spanId":"ce319c96","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.965Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"d9ee312e-b5e0-4bf5-8c3d-3d3eaeb2cea7","spanId":"05c580d5","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.970Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"a854dbec-c4f9-4a07-b763-44f9382f1bc3","spanId":"8b5f2702","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.970Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m[32m2026-01-17T16:02:23.970Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.970Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T16:02:23.971Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"a854dbec-c4f9-4a07-b763-44f9382f1bc3","spanId":"8b5f2702","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:23.972Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T16:02:23.971Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.971Z"}[0m
[32m2026-01-17T16:02:23.971Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"d9ee312e-b5e0-4bf5-8c3d-3d3eaeb2cea7","spanId":"05c580d5","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:23.974Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"249735e3-ab35-42c2-8eff-d720abe388a0","spanId":"3e40b3c5","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.977Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T16:02:23.977Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.977Z"}[0m
[32m2026-01-17T16:02:23.978Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"249735e3-ab35-42c2-8eff-d720abe388a0","spanId":"3e40b3c5","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:23.980Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"a833d3a2-40d4-40d0-a6b7-f1b64e74a1ef","spanId":"e1f07828","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.986Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T16:02:23.987Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m[32m2026-01-17T16:02:23.986Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.986Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"a833d3a2-40d4-40d0-a6b7-f1b64e74a1ef","spanId":"e1f07828","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:23.988Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"a228f132-f1cc-4ceb-aa20-6167c9ec7b55","spanId":"5c982807","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.994Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"bb743f99-7494-468d-9d41-928784025e84","spanId":"7e5d49f9","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:23.994Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T16:02:23.995Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m[32m2026-01-17T16:02:23.994Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.994Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"bb743f99-7494-468d-9d41-928784025e84","spanId":"7e5d49f9","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:23.996Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"4ca56864-7b3a-48aa-8342-3418eca7cd59","spanId":"20f6364d","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.002Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m[32m2026-01-17T16:02:24.002Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.002Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T16:02:24.003Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"4ca56864-7b3a-48aa-8342-3418eca7cd59","spanId":"20f6364d","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:24.004Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"2e200d24-866d-4ffe-a4f7-52c7a4dd1479","spanId":"02f3ed63","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.009Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T16:02:24.010Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:02:24.010Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.009Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"2e200d24-866d-4ffe-a4f7-52c7a4dd1479","spanId":"02f3ed63","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.012Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"f820d53d-b977-4262-80ff-067afaf5ca00","spanId":"4b70da7d","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.029Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T16:02:24.031Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.031Z"}[0m
[32m2026-01-17T16:02:24.031Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"f820d53d-b977-4262-80ff-067afaf5ca00","spanId":"4b70da7d","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:24.033Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T16:02:23.994Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:23.994Z"}[0m
[32m2026-01-17T16:02:23.995Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T16:02:23.992Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"a228f132-f1cc-4ceb-aa20-6167c9ec7b55","spanId":"5c982807","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":55,"timestamp":"2026-01-17T16:02:24.049Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"2201ed61-9f2a-48ef-9e27-9d1026954f18","spanId":"355b278b","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.054Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T16:02:24.054Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.054Z"}[0m
[32m2026-01-17T16:02:24.055Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"2201ed61-9f2a-48ef-9e27-9d1026954f18","spanId":"355b278b","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:24.056Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"67218c67-99c6-468c-b632-97ae4656634a","spanId":"67477ded","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.066Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m[32m2026-01-17T16:02:24.066Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.066Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T16:02:24.067Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"d384cb82-ed56-453c-8bd8-f90f0fba00b8","spanId":"2d662005","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.098Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:02:24.099Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.099Z"}[0m
[32m2026-01-17T16:02:24.099Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"d384cb82-ed56-453c-8bd8-f90f0fba00b8","spanId":"2d662005","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:02:24.108Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"77269d22-6102-44bc-a6eb-c06f0d4911f0","spanId":"22ed0eff","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.116Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T16:02:24.117Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.117Z"}[0m
[32m2026-01-17T16:02:24.117Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"77269d22-6102-44bc-a6eb-c06f0d4911f0","spanId":"22ed0eff","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:24.120Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"67218c67-99c6-468c-b632-97ae4656634a","spanId":"67477ded","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":58,"timestamp":"2026-01-17T16:02:24.124Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"a11fbb34-c5f1-4296-8c97-84a2b046cbc6","spanId":"16dc3de5","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.130Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"2c4f3ecd-28cb-49ca-8098-2ec4d28aaa46","spanId":"1d4d5e20","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.132Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T16:02:24.134Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m[32m2026-01-17T16:02:24.133Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.133Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"2c4f3ecd-28cb-49ca-8098-2ec4d28aaa46","spanId":"1d4d5e20","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:24.137Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T16:02:24.131Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.131Z"}[0m
[32m2026-01-17T16:02:24.131Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"a11fbb34-c5f1-4296-8c97-84a2b046cbc6","spanId":"16dc3de5","method":"POST","path":"/export-document","statusCode":200,"duration":9,"timestamp":"2026-01-17T16:02:24.139Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 1170[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation [33m 342[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"c8e72318-a144-4bd9-9983-1729692645e5","spanId":"0e1a9567","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.149Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T16:02:24.150Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.150Z"}[0m
[32m2026-01-17T16:02:24.150Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"c8e72318-a144-4bd9-9983-1729692645e5","spanId":"0e1a9567","method":"POST","path":"/export-document","statusCode":400,"duration":5,"timestamp":"2026-01-17T16:02:24.154Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T16:02:24.158Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"10a45088-3ca5-4ab6-b963-9effd1c7fa7f","spanId":"2496599b","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.166Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T16:02:24.167Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.167Z"}[0m
[32m2026-01-17T16:02:24.168Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"10a45088-3ca5-4ab6-b963-9effd1c7fa7f","spanId":"2496599b","method":"POST","path":"/api/generate-document","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:24.171Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T16:02:24.177Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.177Z"}[0m
[32m2026-01-17T16:02:24.180Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"50bd80f7-50cf-492f-8443-01480df4c758","spanId":"e73c6a13","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.184Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T16:02:24.185Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.185Z"}[0m
[32m2026-01-17T16:02:24.186Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"50bd80f7-50cf-492f-8443-01480df4c758","spanId":"e73c6a13","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:24.188Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"72f67275-3bec-4ab3-9566-7501f4d27cd7","spanId":"c5408829","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.192Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"1ad39569-5d18-4e4c-86a7-9d49aa59731e","spanId":"1bc8d395","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.198Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T16:02:24.193Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.193Z"}[0m
[32m2026-01-17T16:02:24.194Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T16:02:24.199Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.199Z"}[0m
[32m2026-01-17T16:02:24.199Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"1ad39569-5d18-4e4c-86a7-9d49aa59731e","spanId":"1bc8d395","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:24.202Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"72f67275-3bec-4ab3-9566-7501f4d27cd7","spanId":"c5408829","method":"GET","path":"/api/auth/user","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:02:24.202Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"61c774a9-066d-4c9b-aa71-2a509675b846","spanId":"edbd42df","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.212Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"37ebf095-9c2b-48ff-a2fb-ab6b07adb1c9","spanId":"be59d479","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.212Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T16:02:24.213Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.213Z"}[0m
[32m2026-01-17T16:02:24.214Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"61c774a9-066d-4c9b-aa71-2a509675b846","spanId":"edbd42df","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:02:24.218Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T16:02:24.216Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.216Z"}[0m
[32m2026-01-17T16:02:24.218Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"37ebf095-9c2b-48ff-a2fb-ab6b07adb1c9","spanId":"be59d479","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:02:24.222Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return system health status
[22m[39m[32m2026-01-17T16:02:24.227Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.227Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"e87baee5-a0bd-49a3-855f-58e34335bdb9","spanId":"f4907ea0","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.234Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T16:02:24.235Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.235Z"}[0m
[32m2026-01-17T16:02:24.235Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"e87baee5-a0bd-49a3-855f-58e34335bdb9","spanId":"f4907ea0","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:24.236Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"d0b07944-cbeb-441d-94ae-c9cce476c0da","spanId":"00d1f5dd","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.248Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"3e93bcb5-8832-4fc2-9760-d7128a26260f","spanId":"db9d128c","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.249Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:02:24.248Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.248Z"}[0m
[32m2026-01-17T16:02:24.249Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"f04fbbc8-c6e0-4a42-9d75-135c7422e3fc","spanId":"8eb5b2a1","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.250Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"d0b07944-cbeb-441d-94ae-c9cce476c0da","spanId":"00d1f5dd","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.250Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T16:02:24.249Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.249Z"}[0m
[32m2026-01-17T16:02:24.250Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"3e93bcb5-8832-4fc2-9760-d7128a26260f","spanId":"db9d128c","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:24.251Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T16:02:24.251Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.251Z"}[0m
[32m2026-01-17T16:02:24.251Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"f04fbbc8-c6e0-4a42-9d75-135c7422e3fc","spanId":"8eb5b2a1","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:02:24.255Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"27c39150-1f51-43e1-a834-cbe02195c2d4","spanId":"539dcba1","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.260Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"7479f91a-c9da-402d-a37e-9eaf3548ed2d","spanId":"85fce319","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.261Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T16:02:24.262Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"f06f611b-d689-4abe-8e30-1107a6f4bb25","spanId":"ec6a30cb","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.262Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m[32m2026-01-17T16:02:24.261Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.261Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:02:24.262Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.262Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T16:02:24.263Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"7479f91a-c9da-402d-a37e-9eaf3548ed2d","spanId":"85fce319","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.264Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T16:02:24.263Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.263Z"}[0m
[32m2026-01-17T16:02:24.264Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"f06f611b-d689-4abe-8e30-1107a6f4bb25","spanId":"ec6a30cb","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.265Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"05f62a4e-b35b-400f-b9c5-eae69235004f","spanId":"6b2a4ff4","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.274Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T16:02:24.274Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.274Z"}[0m
[32m2026-01-17T16:02:24.274Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"05f62a4e-b35b-400f-b9c5-eae69235004f","spanId":"6b2a4ff4","method":"POST","path":"/api/save-document","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:02:24.276Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 813[2mms[22m[39m
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"27c39150-1f51-43e1-a834-cbe02195c2d4","spanId":"539dcba1","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":48,"timestamp":"2026-01-17T16:02:24.308Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T16:02:24.311Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"62e44106-11c3-47fd-bbbe-6c1f7d6da11c","spanId":"ee460617","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.317Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"296f52a8-5594-4ac7-8be5-f04029189d12","spanId":"f89c7f74","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.318Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T16:02:24.318Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m[32m2026-01-17T16:02:24.318Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.318Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"62e44106-11c3-47fd-bbbe-6c1f7d6da11c","spanId":"ee460617","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.320Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T16:02:24.319Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m[32m2026-01-17T16:02:24.319Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.319Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"296f52a8-5594-4ac7-8be5-f04029189d12","spanId":"f89c7f74","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.321Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"74981257-bac2-429c-9268-296a4393edb8","spanId":"fd54b916","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.328Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"ba0afef1-72c2-4348-ad7d-96f7212d951e","spanId":"dee9f3d9","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.328Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T16:02:24.328Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.328Z"}[0m
[32m2026-01-17T16:02:24.329Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T16:02:24.329Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.328Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"74981257-bac2-429c-9268-296a4393edb8","spanId":"fd54b916","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.331Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"ba0afef1-72c2-4348-ad7d-96f7212d951e","spanId":"dee9f3d9","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T16:02:24.330Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"5578b7c9-528b-46dd-8429-2fa4b168a5ec","spanId":"0e60b100","method":"GET","path":"/api/frameworks/SOC2/required-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.337Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T16:02:24.337Z [INFO] GET /api/frameworks/SOC2/required-templates {"method":"GET","url":"/api/frameworks/SOC2/required-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.337Z"}[0m
[32m2026-01-17T16:02:24.338Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/required-templates","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"3a380d94-44d4-4a2e-879b-98b9d730dcb9","spanId":"2817940b","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.338Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"5578b7c9-528b-46dd-8429-2fa4b168a5ec","spanId":"0e60b100","method":"GET","path":"/api/frameworks/SOC2/required-templates","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.340Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T16:02:24.340Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.340Z"}[0m
[32m2026-01-17T16:02:24.341Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 1022[2mms[22m[39m
[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"3a380d94-44d4-4a2e-879b-98b9d730dcb9","spanId":"2817940b","method":"GET","path":"/api/auth/user","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:02:24.344Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T16:02:24.351Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.351Z"}[0m
[32m2026-01-17T16:02:24.354Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"be7e4171-04af-4b48-a663-ce5f85f0c37e","spanId":"2d65e789","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.365Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T16:02:24.371Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.371Z"}[0m
[32m2026-01-17T16:02:24.390Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"be7e4171-04af-4b48-a663-ce5f85f0c37e","spanId":"2d65e789","method":"GET","path":"/api/auth/user","statusCode":401,"duration":34,"timestamp":"2026-01-17T16:02:24.399Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T16:02:24.400Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.400Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T16:02:24.404Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"a6904635-02d7-46f7-af51-995f7a4211ea","spanId":"75fd061e","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.409Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T16:02:24.410Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.410Z"}[0m
[32m2026-01-17T16:02:24.410Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"a6904635-02d7-46f7-af51-995f7a4211ea","spanId":"75fd061e","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:02:24.413Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T16:02:24.415Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.415Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T16:02:24.418Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"6de08fb4-6145-4d3c-ad33-417b9c026be9","spanId":"76f1d046","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.421Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 1214[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check [33m 407[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 15[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 34[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 55[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 10[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 10[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 62[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 16[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 11[2mms[22m[39m
[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T16:02:24.422Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.422Z"}[0m
[32m2026-01-17T16:02:24.422Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"6de08fb4-6145-4d3c-ad33-417b9c026be9","spanId":"76f1d046","method":"GET","path":"/api/documents","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.424Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"a9e31acc-d929-49df-8b3b-9b9d0f0ec8ee","spanId":"37774688","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:02:24.449Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T16:02:24.450Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:02:24.450Z"}[0m
[32m2026-01-17T16:02:24.451Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"a9e31acc-d929-49df-8b3b-9b9d0f0ec8ee","spanId":"37774688","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:02:24.452Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 536[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 2 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/2]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/2]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m66 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 08:02:16
[2m   Duration [22m 34.71s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/middleware/security.ts [22m[39m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T16:03:56.244Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T16:03:56.259Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T16:03:56.305Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T16:03:56.336Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"877b1d6a-47d5-4678-95e2-30ceb4508ab7","spanId":"158a0f72","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.346Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T16:03:56.357Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.356Z"}[0m
[32m2026-01-17T16:03:56.360Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"877b1d6a-47d5-4678-95e2-30ceb4508ab7","spanId":"158a0f72","method":"GET","path":"/","statusCode":200,"duration":30,"timestamp":"2026-01-17T16:03:56.376Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"fa7cfc93-71e0-44b8-b474-cc23661afa06","spanId":"3237925c","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.383Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"ea0be951-8435-4ad1-9cc6-108aeb27b942","spanId":"a53d018d","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.409Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:03:56.410Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.410Z"}[0m
[32m2026-01-17T16:03:56.411Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return system health status
[22m[39m[32m2026-01-17T16:03:56.413Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.413Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"ea0be951-8435-4ad1-9cc6-108aeb27b942","spanId":"a53d018d","method":"GET","path":"/","statusCode":200,"duration":11,"timestamp":"2026-01-17T16:03:56.420Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"903af7d2-570c-46c2-95a3-2cb53c044875","spanId":"6e74c77e","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.435Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:03:56.436Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.436Z"}[0m
[32m2026-01-17T16:03:56.436Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"903af7d2-570c-46c2-95a3-2cb53c044875","spanId":"6e74c77e","method":"GET","path":"/iso-001","statusCode":200,"duration":4,"timestamp":"2026-01-17T16:03:56.439Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T16:03:56.456Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.456Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T16:03:56.400Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:03:56.395Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.395Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"fa7cfc93-71e0-44b8-b474-cc23661afa06","spanId":"3237925c","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":92,"timestamp":"2026-01-17T16:03:56.475Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"347f4149-01cf-482b-b041-6157775ea179","spanId":"b39ea2fd","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.487Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T16:03:56.489Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.489Z"}[0m
[32m2026-01-17T16:03:56.490Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"347f4149-01cf-482b-b041-6157775ea179","spanId":"b39ea2fd","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:03:56.493Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T16:03:56.490Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"1f39ca1e-0bc7-43f6-8165-ebfd0e1c640b","spanId":"b2c09db0","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.501Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T16:03:56.503Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m[32m2026-01-17T16:03:56.502Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.502Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"1f39ca1e-0bc7-43f6-8165-ebfd0e1c640b","spanId":"b2c09db0","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:03:56.505Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"ab481836-1d26-4593-aeb2-c3876c99217d","spanId":"0a86bad5","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.515Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T16:03:56.517Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m[32m2026-01-17T16:03:56.516Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.516Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"ab481836-1d26-4593-aeb2-c3876c99217d","spanId":"0a86bad5","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.518Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"7e6cdb6c-5c79-48ec-87d6-93162d3919ee","spanId":"5282f765","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.526Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T16:03:56.527Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m[32m2026-01-17T16:03:56.527Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.527Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"7e6cdb6c-5c79-48ec-87d6-93162d3919ee","spanId":"5282f765","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.529Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"bb53441b-1219-4787-b643-6483cbd0db2f","spanId":"e3244305","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.629Z"}
stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T16:03:56.631Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T16:03:56.651Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}


[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m[32m2026-01-17T16:03:56.630Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.630Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"bb53441b-1219-4787-b643-6483cbd0db2f","spanId":"e3244305","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:03:56.633Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"9da3ecc8-428e-4883-8990-389dd45ac4e4","spanId":"c1ea5624","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.650Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m[32m2026-01-17T16:03:56.651Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.651Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"9da3ecc8-428e-4883-8990-389dd45ac4e4","spanId":"c1ea5624","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.653Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"93ded4cc-55f3-4724-80a6-96f8fe260da0","spanId":"6641411d","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.659Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T16:03:56.659Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.659Z"}[0m
[32m2026-01-17T16:03:56.660Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"93ded4cc-55f3-4724-80a6-96f8fe260da0","spanId":"6641411d","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.662Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"403c4a0f-720b-46ea-abf6-d5ca80febf7d","spanId":"bc665823","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.664Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"aaef0a7b-5c59-4717-bcd9-69412a8de7fd","spanId":"197f3b17","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.678Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T16:03:56.678Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.678Z"}[0m
[32m2026-01-17T16:03:56.683Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T16:03:56.679Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.679Z"}[0m
[32m2026-01-17T16:03:56.680Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"403c4a0f-720b-46ea-abf6-d5ca80febf7d","spanId":"bc665823","method":"POST","path":"/api/organizations","statusCode":401,"duration":31,"timestamp":"2026-01-17T16:03:56.695Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"280862cf-a431-41b1-acd1-4ed8ca933c74","spanId":"7fcd4a51","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.733Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"aaef0a7b-5c59-4717-bcd9-69412a8de7fd","spanId":"197f3b17","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:03:56.683Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:03:56.733Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.733Z"}[0m
[32m2026-01-17T16:03:56.734Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"256367df-25ce-43ea-9b88-0e1c5883e6e5","spanId":"5d1f9853","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.689Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"964bab71-1cde-46b1-8337-54a29350ecac","spanId":"9a87d505","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.717Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"280862cf-a431-41b1-acd1-4ed8ca933c74","spanId":"7fcd4a51","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:03:56.739Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T16:03:56.690Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.690Z"}[0m
[32m2026-01-17T16:03:56.690Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T16:03:56.719Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.719Z"}[0m
[32m2026-01-17T16:03:56.720Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"256367df-25ce-43ea-9b88-0e1c5883e6e5","spanId":"5d1f9853","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.692Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"964bab71-1cde-46b1-8337-54a29350ecac","spanId":"9a87d505","method":"GET","path":"/api/organizations","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:03:56.724Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"18acbf2d-02e9-4cd3-958e-1a451c2d71aa","spanId":"97855e4b","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.764Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"521d8726-990b-497d-ae4e-c7821182c972","spanId":"8e2c5cab","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.698Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"423017fc-d8ea-47f2-b5ae-802a44d8f577","spanId":"96d88bf3","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.795Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T16:03:56.765Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.765Z"}[0m
[32m2026-01-17T16:03:56.766Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T16:03:56.699Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.699Z"}[0m
[32m2026-01-17T16:03:56.699Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T16:03:56.796Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.796Z"}[0m
[32m2026-01-17T16:03:56.796Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"18acbf2d-02e9-4cd3-958e-1a451c2d71aa","spanId":"97855e4b","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":8,"timestamp":"2026-01-17T16:03:56.769Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"521d8726-990b-497d-ae4e-c7821182c972","spanId":"8e2c5cab","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.701Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"423017fc-d8ea-47f2-b5ae-802a44d8f577","spanId":"96d88bf3","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.798Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"8fe08f30-1c8e-4922-85a0-b408032a7015","spanId":"7c81750a","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.781Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"bc5262e9-18ba-4edb-bbf5-d5ac94cbca7a","spanId":"6b8a82a7","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.709Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T16:03:56.782Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.782Z"}[0m
[32m2026-01-17T16:03:56.782Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m[32m2026-01-17T16:03:56.709Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.709Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"4ec34d53-4466-4259-9a14-094ded6e819c","spanId":"5cf44400","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.803Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"8fe08f30-1c8e-4922-85a0-b408032a7015","spanId":"7c81750a","method":"POST","path":"/export-document","statusCode":200,"duration":4,"timestamp":"2026-01-17T16:03:56.785Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
2026-01-17T16:03:56.710Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T16:03:56.804Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.804Z"}[0m
[32m2026-01-17T16:03:56.805Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"2ad80ab3-ae2d-4970-8955-3e4eb308c083","spanId":"183428e5","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.791Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"bc5262e9-18ba-4edb-bbf5-d5ac94cbca7a","spanId":"6b8a82a7","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.712Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"4ec34d53-4466-4259-9a14-094ded6e819c","spanId":"5cf44400","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":8,"timestamp":"2026-01-17T16:03:56.811Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T16:03:56.792Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.792Z"}[0m
[32m2026-01-17T16:03:56.792Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"651b52e2-ae2e-46ee-999c-9aac1c05f55f","spanId":"df54fd95","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.720Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"bfaded5b-d7c0-44ef-bdfb-b50252600e6f","spanId":"81a90384","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.818Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"2ad80ab3-ae2d-4970-8955-3e4eb308c083","spanId":"183428e5","method":"POST","path":"/export-document","statusCode":400,"duration":4,"timestamp":"2026-01-17T16:03:56.795Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T16:03:56.721Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T16:03:56.819Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"0dbddadf-6926-4c36-b06b-a2c7a5379d92","spanId":"e8a850b3","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.803Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m[32m2026-01-17T16:03:56.721Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.721Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m[32m2026-01-17T16:03:56.819Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.819Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T16:03:56.804Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.804Z"}[0m
[32m2026-01-17T16:03:56.804Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"651b52e2-ae2e-46ee-999c-9aac1c05f55f","spanId":"df54fd95","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:03:56.724Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"bfaded5b-d7c0-44ef-bdfb-b50252600e6f","spanId":"81a90384","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.821Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"0dbddadf-6926-4c36-b06b-a2c7a5379d92","spanId":"e8a850b3","method":"POST","path":"/api/generate-document","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:03:56.810Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"162f834b-ecda-4085-ac29-189e528a8126","spanId":"b90eb0c6","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.831Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"8371ba29-ee96-4b1a-9b69-02dd700025e7","spanId":"3584dfb3","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.829Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"dcd58db8-47df-464a-a554-fc58106669c1","spanId":"58798c87","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.732Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T16:03:56.840Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.840Z"}[0m
[32m2026-01-17T16:03:56.840Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T16:03:56.829Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.829Z"}[0m
[32m2026-01-17T16:03:56.830Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T16:03:56.732Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.732Z"}[0m
[32m2026-01-17T16:03:56.733Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"162f834b-ecda-4085-ac29-189e528a8126","spanId":"b90eb0c6","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":11,"timestamp":"2026-01-17T16:03:56.842Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"8371ba29-ee96-4b1a-9b69-02dd700025e7","spanId":"3584dfb3","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":13,"timestamp":"2026-01-17T16:03:56.841Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"dcd58db8-47df-464a-a554-fc58106669c1","spanId":"58798c87","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.735Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"2bad48b0-a7e9-404d-aa71-2d11acdff987","spanId":"3a985096","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.853Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"c29b5b34-fead-4830-9b4c-382ba9638a41","spanId":"607df71b","method":"GET","path":"/api/frameworks/SOC2/required-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.740Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T16:03:56.858Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.858Z"}[0m
[32m2026-01-17T16:03:56.859Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"074fea2f-88c7-4079-996b-6fa316891a36","spanId":"9998accf","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.898Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T16:03:56.743Z [INFO] GET /api/frameworks/SOC2/required-templates {"method":"GET","url":"/api/frameworks/SOC2/required-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.743Z"}[0m
[32m2026-01-17T16:03:56.744Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/required-templates","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"2bad48b0-a7e9-404d-aa71-2d11acdff987","spanId":"3a985096","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":8,"timestamp":"2026-01-17T16:03:56.861Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T16:03:56.899Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.899Z"}[0m
[32m2026-01-17T16:03:56.899Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"c29b5b34-fead-4830-9b4c-382ba9638a41","spanId":"607df71b","method":"GET","path":"/api/frameworks/SOC2/required-templates","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:03:56.745Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"074fea2f-88c7-4079-996b-6fa316891a36","spanId":"9998accf","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.901Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"8a73177a-f554-4ff8-a8f9-db8c13f7662d","spanId":"1264d221","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.909Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 649[2mms[22m[39m
[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T16:03:56.909Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.909Z"}[0m
[32m2026-01-17T16:03:56.910Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"8a73177a-f554-4ff8-a8f9-db8c13f7662d","spanId":"1264d221","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.912Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"d3132426-6693-4c8d-9eaa-68032638b539","spanId":"e1375ba3","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.917Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T16:03:56.918Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.918Z"}[0m
[32m2026-01-17T16:03:56.918Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"d3132426-6693-4c8d-9eaa-68032638b539","spanId":"e1375ba3","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:03:56.919Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"13bf2ac8-76af-4e64-b7e3-6abcaf376b1e","spanId":"64d1b3ed","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.925Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T16:03:56.926Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.926Z"}[0m
[32m2026-01-17T16:03:56.926Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"13bf2ac8-76af-4e64-b7e3-6abcaf376b1e","spanId":"64d1b3ed","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.928Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"380e7870-7f9d-4043-ae02-f11569b5f9ba","spanId":"d926b3d6","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.934Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T16:03:56.934Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.934Z"}[0m
[32m2026-01-17T16:03:56.935Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"380e7870-7f9d-4043-ae02-f11569b5f9ba","spanId":"d926b3d6","method":"POST","path":"/api/save-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:56.936Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"9a5292c7-d9d6-4bd6-b775-70143dae09ba","spanId":"3c2e5eb7","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:56.945Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T16:03:56.945Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.945Z"}[0m
[32m2026-01-17T16:03:56.945Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"9a5292c7-d9d6-4bd6-b775-70143dae09ba","spanId":"3c2e5eb7","method":"POST","path":"/api/save-document","statusCode":401,"duration":1,"timestamp":"2026-01-17T16:03:56.946Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 974[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation [33m 303[2mms[22m[39m
stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T16:03:56.989Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T16:03:56.989Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:56.989Z"}[0m
[32m2026-01-17T16:03:56.989Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"c06700a0-ddae-453c-b4c7-21cf1699f38a","spanId":"275178d0","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.001Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T16:03:57.002Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m[32m2026-01-17T16:03:57.002Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.002Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"c06700a0-ddae-453c-b4c7-21cf1699f38a","spanId":"275178d0","method":"POST","path":"/api/evidence","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:03:57.005Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T16:03:57.008Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.008Z"}[0m
[32m2026-01-17T16:03:57.011Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"bc4f6e0d-fe78-401d-b2de-c552229f4c21","spanId":"ae51977e","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.015Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T16:03:57.017Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m[32m2026-01-17T16:03:57.017Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.017Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"bc4f6e0d-fe78-401d-b2de-c552229f4c21","spanId":"ae51977e","method":"GET","path":"/api/evidence","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:03:57.019Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"3b1363dd-f497-4b71-8d3e-d3df045d5764","spanId":"3bed20d5","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.021Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"0691d6c4-0bf9-4198-b91a-80e2a4ae8046","spanId":"7d2ef290","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.029Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T16:03:57.022Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.022Z"}[0m
[32m2026-01-17T16:03:57.023Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T16:03:57.030Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m[32m2026-01-17T16:03:57.029Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.029Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"3b1363dd-f497-4b71-8d3e-d3df045d5764","spanId":"3bed20d5","method":"GET","path":"/api/auth/user","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:03:57.031Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"0691d6c4-0bf9-4198-b91a-80e2a4ae8046","spanId":"7d2ef290","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:03:57.031Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"68f3291d-6fd7-49ed-ad79-d071e5c6d13c","spanId":"8e9183b7","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.038Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"82d1f268-71dd-4157-bee3-1c8830f7b744","spanId":"42e3a709","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.041Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T16:03:57.040Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T16:03:57.042Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.042Z"}[0m
[32m2026-01-17T16:03:57.042Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m[32m2026-01-17T16:03:57.039Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.039Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"82d1f268-71dd-4157-bee3-1c8830f7b744","spanId":"42e3a709","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:03:57.046Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"68f3291d-6fd7-49ed-ad79-d071e5c6d13c","spanId":"8e9183b7","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:57.041Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"dff6eed2-d9a3-4f5a-b851-d9373da054ee","spanId":"13568dbe","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.048Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m[32m2026-01-17T16:03:57.049Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.049Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T16:03:57.049Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"dff6eed2-d9a3-4f5a-b851-d9373da054ee","spanId":"13568dbe","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:57.051Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"5293fb2d-1b25-4a84-8893-5e1d53a85204","spanId":"c93df9cd","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.080Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"038745dc-6885-44fa-9875-89bb8f24a321","spanId":"1e912c8d","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.080Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:03:57.081Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.081Z"}[0m
[32m2026-01-17T16:03:57.082Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"5293fb2d-1b25-4a84-8893-5e1d53a85204","spanId":"c93df9cd","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:03:57.084Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"f81c2dce-ec2b-44df-a8b1-09dcde7545b0","spanId":"f1aabee5","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.094Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T16:03:57.096Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:03:57.095Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.095Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"f81c2dce-ec2b-44df-a8b1-09dcde7545b0","spanId":"f1aabee5","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:57.097Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T16:03:57.096Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.096Z"}[0m
[32m2026-01-17T16:03:57.098Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"038745dc-6885-44fa-9875-89bb8f24a321","spanId":"1e912c8d","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":19,"timestamp":"2026-01-17T16:03:57.099Z"}

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T16:03:57.108Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"14d32783-0d64-41fa-9241-0e4e5d07b86f","spanId":"23f21e67","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.109Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T16:03:57.113Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m[32m2026-01-17T16:03:57.112Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.112Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"14d32783-0d64-41fa-9241-0e4e5d07b86f","spanId":"23f21e67","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:03:57.114Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"894f3100-4b53-4b75-8779-5a8bfad1094b","spanId":"99de9c26","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.119Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T16:03:57.119Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.119Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"894f3100-4b53-4b75-8779-5a8bfad1094b","spanId":"99de9c26","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":1,"timestamp":"2026-01-17T16:03:57.120Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"559bf8e8-4154-430a-9934-5f8d866e5ce0","spanId":"af986d2a","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.126Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T16:03:57.128Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.128Z"}[0m
[32m2026-01-17T16:03:57.129Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"559bf8e8-4154-430a-9934-5f8d866e5ce0","spanId":"af986d2a","method":"GET","path":"/api/auth/user","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:03:57.130Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T16:03:57.129Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.129Z"}[0m
[32m2026-01-17T16:03:57.132Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T16:03:57.138Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.138Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"9cc63773-e784-4189-a6d3-eb2dd079141c","spanId":"510151a5","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.145Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T16:03:57.146Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.146Z"}[0m
[32m2026-01-17T16:03:57.147Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"9cc63773-e784-4189-a6d3-eb2dd079141c","spanId":"510151a5","method":"GET","path":"/api/auth/user","statusCode":401,"duration":20,"timestamp":"2026-01-17T16:03:57.165Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"bb7f49bb-5ff9-414e-ba3d-578d5ff3186f","spanId":"cf95df20","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.168Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"e25d9382-afc4-43bd-b5ef-cfc91b78cd0d","spanId":"886cf10c","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.171Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T16:03:57.172Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m[32m2026-01-17T16:03:57.168Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.168Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T16:03:57.172Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.172Z"}[0m
[32m2026-01-17T16:03:57.173Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"bb7f49bb-5ff9-414e-ba3d-578d5ff3186f","spanId":"cf95df20","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:03:57.175Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"e25d9382-afc4-43bd-b5ef-cfc91b78cd0d","spanId":"886cf10c","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:03:57.176Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"8bde2c46-adb5-4768-8f03-ac876969734a","spanId":"83e66ea1","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.182Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T16:03:57.188Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.188Z"}[0m
[32m2026-01-17T16:03:57.190Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"8bde2c46-adb5-4768-8f03-ac876969734a","spanId":"83e66ea1","method":"GET","path":"/api/documents","statusCode":401,"duration":11,"timestamp":"2026-01-17T16:03:57.192Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"ec5bcbf3-bbf3-4ed4-b48b-e31eda098af6","spanId":"8d14cacf","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.222Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
[22m[39m[32m2026-01-17T16:03:57.223Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.223Z"}[0m
2026-01-17T16:03:57.223Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}


[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"ec5bcbf3-bbf3-4ed4-b48b-e31eda098af6","spanId":"8d14cacf","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:57.225Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T16:03:57.245Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"70599543-ae5f-4369-bedc-06feb72d9fb3","spanId":"47c775cb","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.271Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T16:03:57.272Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.272Z"}[0m
[32m2026-01-17T16:03:57.272Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"70599543-ae5f-4369-bedc-06feb72d9fb3","spanId":"47c775cb","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:57.274Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"278ece22-6f23-4015-b8e8-822da3a2288b","spanId":"e803ee2d","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.280Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T16:03:57.281Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m[32m2026-01-17T16:03:57.281Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.281Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"278ece22-6f23-4015-b8e8-822da3a2288b","spanId":"e803ee2d","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:57.283Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 1176[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return system health status [33m 743[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"4ca4e799-bea1-4a2b-9d1f-0675df5140f9","spanId":"a4c661c2","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.290Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:03:57.290Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.290Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T16:03:57.291Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"4ca4e799-bea1-4a2b-9d1f-0675df5140f9","spanId":"a4c661c2","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:03:57.295Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"3b053266-0a0b-4506-ad6a-2df0a39b0810","spanId":"bfa08b07","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.299Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T16:03:57.299Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.299Z"}[0m
[32m2026-01-17T16:03:57.300Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"3b053266-0a0b-4506-ad6a-2df0a39b0810","spanId":"bfa08b07","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:03:57.301Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T16:03:57.301Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.301Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"abe0ba01-9c40-4514-8b7b-5efd59e9ce9d","spanId":"3e4be681","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.305Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T16:03:57.305Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T16:03:57.305Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.305Z"}[0m
[32m2026-01-17T16:03:57.305Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"abe0ba01-9c40-4514-8b7b-5efd59e9ce9d","spanId":"3e4be681","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:03:57.307Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"e62d860b-3968-48da-9740-57ce3858c59c","spanId":"26256b6c","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.319Z"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[33m 1126[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check [33m 584[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 18[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 42[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 12[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 15[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 6[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 10[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[39m[32m 164[2mms[22m[39m
[31m     Î“Ã¥Ã† expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 21[2mms[22m[39m
stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T16:03:57.321Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m[32m2026-01-17T16:03:57.320Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.320Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"e62d860b-3968-48da-9740-57ce3858c59c","spanId":"26256b6c","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":11,"timestamp":"2026-01-17T16:03:57.330Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"4ca61671-e87b-47b0-a493-b99f36c8d91c","spanId":"a9dcd183","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:03:57.336Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T16:03:57.337Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m[32m2026-01-17T16:03:57.337Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:03:57.337Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"4ca61671-e87b-47b0-a493-b99f36c8d91c","spanId":"a9dcd183","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:03:57.339Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 995[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 2 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/2]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
AssertionError: expected { 'x-powered-by': 'Express', Î“Ã‡Âª(17) } to have property "x-ratelimit-limit"
 Î“Â¥Â» tests/integration/auth.test.ts:101:32
     99|         .get('/health');
    100| 
    101|       expect(response.headers).toHaveProperty('x-ratelimit-limit');
       |                                ^
    102|       expect(response.headers).toHaveProperty('x-ratelimit-remaining');
    103|     });

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/2]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m66 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 08:03:49
[2m   Duration [22m 36.05s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m | [22m[33m15 skipped[39m[2m)[22m[32m 9[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication for gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Creation[2m > [22mshould require authentication to update recommendations
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Analysis Endpoint[2m > [22mshould analyze compliance gaps
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle SOC2 framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle ISO27001 framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle FedRAMP framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Frameworks[2m > [22mshould handle NIST framework gap analysis request
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mDocument Quality for Compliance[2m > [22mshould analyze document quality against framework
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for report access
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mGap Analysis Reports[2m > [22mshould require authentication for specific report
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mRemediation Tracking[2m > [22mshould require authentication for remediation updates
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mRisk Assessment[2m > [22mshould handle risk assessment requests
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mCompliance Scoring[2m > [22mshould calculate compliance score
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mAI-Powered Analysis[2m > [22mshould require authentication for AI gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Gap Analysis Integration Tests[2m > [22mFramework Requirements[2m > [22mshould return framework control requirements
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m | [22m[33m22 skipped[39m[2m)[22m[32m 9[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication for organization creation
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mOrganization Setup[2m > [22mshould require authentication to list organizations
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication for company profile creation
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mCompany Profile Creation[2m > [22mshould require authentication to get company profile
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mOnboarding Flow[2m > [22mInitial Framework Selection[2m > [22mshould require authentication to update framework preferences
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document generation
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould require authentication for AI document analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mDocument Generation[2m > [22mshould return AI service health status
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication for evidence upload
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mEvidence Upload[2m > [22mshould require authentication to list evidence
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to list pending approvals
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAI Generation Flow[2m > [22mControl Approvals[2m > [22mshould require authentication to approve a control
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to view audit trail
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAudit Trail Access[2m > [22mshould require authentication to get audit entry details
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication for auditor workspace access
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to view compliance overview
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mAuditor Workspace[2m > [22mshould require authentication to export audit reports
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mAudit Flow[2m > [22mGap Analysis[2m > [22mshould require authentication for gap analysis by framework
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mDocument to Audit Trail[2m > [22mshould require authentication to track document changes
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mEvidence to Control Mapping[2m > [22mshould require authentication to map evidence to controls
   [2m[90mÎ“Ã¥Ã´[39m[22m E2E Flow Tests[2m > [22mCross-Flow Integration[2m > [22mAI Hub Stats[2m > [22mshould require authentication for AI stats
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m | [22m[33m14 skipped[39m[2m)[22m[32m 10[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document generation
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Generation Endpoints[2m > [22mshould require authentication for document upload
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould export document as markdown
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Export[2m > [22mshould handle export without content
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument AI Generation[2m > [22mshould reject generation request without framework
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Quality Analysis[2m > [22mshould require authentication for document quality analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version history
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version creation
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Versioning[2m > [22mshould require authentication for version restore
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Comparison[2m > [22mshould require authentication for version comparison
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould save a document with valid data
   [2m[90mÎ“Ã¥Ã´[39m[22m Document Integration Tests[2m > [22mDocument Saving[2m > [22mshould reject save request without required fields
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m | [22m[33m6 skipped[39m[2m)[22m[32m 9[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return system health status
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return AI health status
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for user profile
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for company profiles
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mAuthentication Required Endpoints[2m > [22mshould require authentication for documents
   [2m[90mÎ“Ã¥Ã´[39m[22m API Integration Tests[2m > [22mData Validation[2m > [22mshould validate company profile creation payload
 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[33m11 skipped[39m[2m)[22m[32m 8[2mms[22m[39m
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers
   [2m[90mÎ“Ã¥Ã´[39m[22m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Suites 5 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/documents.test.ts > Document Integration Tests
ReferenceError: healthCheckHandler is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:73:22
     71| 
     72|   // 3. Basic health checks
     73|   app.get('/health', healthCheckHandler);
       |                      ^
     74|   app.get('/ready', readinessCheckHandler);
     75|   app.get('/live', livenessCheckHandler);
 Î“Â¥Â» tests/integration/documents.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/5]Î“Ã„Â»

 FAIL   unit  tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests
ReferenceError: healthCheckHandler is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:73:22
     71| 
     72|   // 3. Basic health checks
     73|   app.get('/health', healthCheckHandler);
       |                      ^
     74|   app.get('/ready', readinessCheckHandler);
     75|   app.get('/live', livenessCheckHandler);
 Î“Â¥Â» tests/integration/gap-analysis.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/5]Î“Ã„Â»

 FAIL   unit  tests/integration/e2e-flows.test.ts > E2E Flow Tests
ReferenceError: healthCheckHandler is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:73:22
     71| 
     72|   // 3. Basic health checks
     73|   app.get('/health', healthCheckHandler);
       |                      ^
     74|   app.get('/ready', readinessCheckHandler);
     75|   app.get('/live', livenessCheckHandler);
 Î“Â¥Â» tests/integration/e2e-flows.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[3/5]Î“Ã„Â»

 FAIL   unit  tests/integration/api.test.ts > API Integration Tests
ReferenceError: healthCheckHandler is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:73:22
     71| 
     72|   // 3. Basic health checks
     73|   app.get('/health', healthCheckHandler);
       |                      ^
     74|   app.get('/ready', readinessCheckHandler);
     75|   app.get('/live', livenessCheckHandler);
 Î“Â¥Â» tests/integration/api.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[4/5]Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests
ReferenceError: healthCheckHandler is not defined
 Î“Â¥Â» registerRoutes server/routes.ts:73:22
     71| 
     72|   // 3. Basic health checks
     73|   app.get('/health', healthCheckHandler);
       |                      ^
     74|   app.get('/ready', readinessCheckHandler);
     75|   app.get('/live', livenessCheckHandler);
 Î“Â¥Â» tests/integration/auth.test.ts:13:20

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[5/5]Î“Ã„Â»


[2m Test Files [22m [1m[31m5 failed[39m[22m[90m (5)[39m
[2m      Tests [22m [33m68 skipped[39m[90m (68)[39m
[2m   Start at [22m 08:05:35
[2m   Duration [22m 35.54s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mserver/routes.ts [22m[39m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests
[22m[39m[32m2026-01-17T16:06:17.416Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"c301f55a-1736-4979-97fd-e7d8a73ff614","spanId":"6f6ee561","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.529Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Gap Analysis Creation > should require authentication for gap analysis
2026-01-17T16:06:17.537Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:06:17.532Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.532Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"c301f55a-1736-4979-97fd-e7d8a73ff614","spanId":"6f6ee561","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":17,"timestamp":"2026-01-17T16:06:17.546Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_start","traceId":"03639b33-2a80-4ca3-9c7c-780e662e5f11","spanId":"12e192b2","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.558Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m[32m2026-01-17T16:06:17.559Z [INFO] PATCH /api/gap-analysis/recommendations/test-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.559Z"}[0m
[32m2026-01-17T16:06:17.560Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Creation[2m > [22m[2mshould require authentication to update recommendations
[22m[39m{"type":"request_end","traceId":"03639b33-2a80-4ca3-9c7c-780e662e5f11","spanId":"12e192b2","method":"PATCH","path":"/api/gap-analysis/recommendations/test-id","statusCode":401,"duration":21,"timestamp":"2026-01-17T16:06:17.579Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_start","traceId":"acf52b56-54d0-41da-9ddc-13bfbe264da1","spanId":"d4d53a9c","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.589Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Analysis Endpoint > should analyze compliance gaps
2026-01-17T16:06:17.590Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m[32m2026-01-17T16:06:17.590Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.590Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Analysis Endpoint[2m > [22m[2mshould analyze compliance gaps
[22m[39m{"type":"request_end","traceId":"acf52b56-54d0-41da-9ddc-13bfbe264da1","spanId":"d4d53a9c","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:17.593Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"cc28ddb5-5816-43ae-a4a7-e23091d14d7e","spanId":"444f8e5f","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.600Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle SOC2 framework gap analysis request
2026-01-17T16:06:17.601Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m[32m2026-01-17T16:06:17.601Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.601Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle SOC2 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"cc28ddb5-5816-43ae-a4a7-e23091d14d7e","spanId":"444f8e5f","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:17.603Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_start","traceId":"ef3e20e8-8b54-4b87-a20f-537a3ca69fc1","spanId":"be24f800","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.610Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle ISO27001 framework gap analysis request
2026-01-17T16:06:17.611Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m[32m2026-01-17T16:06:17.610Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.610Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle ISO27001 framework gap analysis request
[22m[39m{"type":"request_end","traceId":"ef3e20e8-8b54-4b87-a20f-537a3ca69fc1","spanId":"be24f800","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:17.613Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_start","traceId":"30889fc3-48dd-41cc-946a-decab7d8e37d","spanId":"8c9b93d0","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.620Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m[32m2026-01-17T16:06:17.620Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.620Z"}[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle FedRAMP framework gap analysis request
2026-01-17T16:06:17.621Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle FedRAMP framework gap analysis request
[22m[39m{"type":"request_end","traceId":"30889fc3-48dd-41cc-946a-decab7d8e37d","spanId":"8c9b93d0","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:17.623Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_start","traceId":"9b91d280-107b-494c-93f0-22c051e3e738","spanId":"81262593","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.629Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Frameworks > should handle NIST framework gap analysis request
2026-01-17T16:06:17.630Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m[32m2026-01-17T16:06:17.630Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.630Z"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests
[22m[39m[32m2026-01-17T16:06:17.765Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Frameworks[2m > [22m[2mshould handle NIST framework gap analysis request
[22m[39m{"type":"request_end","traceId":"9b91d280-107b-494c-93f0-22c051e3e738","spanId":"81262593","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":150,"timestamp":"2026-01-17T16:06:17.779Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_start","traceId":"1bf08ac4-5394-4363-96c1-6da21ab14187","spanId":"acfedd57","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.785Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m[32m2026-01-17T16:06:17.786Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.786Z"}[0m
[32m2026-01-17T16:06:17.786Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mDocument Quality for Compliance[2m > [22m[2mshould analyze document quality against framework
[22m[39m{"type":"request_end","traceId":"1bf08ac4-5394-4363-96c1-6da21ab14187","spanId":"acfedd57","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:17.788Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_start","traceId":"4fd5d4b1-dc9f-4586-9833-0f917380851f","spanId":"113a42ea","method":"GET","path":"/api/gap-analysis/reports","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.806Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m[32m2026-01-17T16:06:17.807Z [INFO] GET /api/gap-analysis/reports {"method":"GET","url":"/api/gap-analysis/reports","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.807Z"}[0m
[32m2026-01-17T16:06:17.808Z [INFO] API route accessed {"path":"/api/gap-analysis/reports","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for report access
[22m[39m{"type":"request_end","traceId":"4fd5d4b1-dc9f-4586-9833-0f917380851f","spanId":"113a42ea","method":"GET","path":"/api/gap-analysis/reports","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:06:17.811Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_start","traceId":"0b83ca7f-e5e8-4d28-836a-1e20ac14ec35","spanId":"9d89b193","method":"GET","path":"/api/gap-analysis/reports/test-report-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.841Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m[32m2026-01-17T16:06:17.842Z [INFO] GET /api/gap-analysis/reports/test-report-id {"method":"GET","url":"/api/gap-analysis/reports/test-report-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.842Z"}[0m
[32m2026-01-17T16:06:17.843Z [INFO] API route accessed {"path":"/api/gap-analysis/reports/test-report-id","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mGap Analysis Reports[2m > [22m[2mshould require authentication for specific report
[22m[39m{"type":"request_end","traceId":"0b83ca7f-e5e8-4d28-836a-1e20ac14ec35","spanId":"9d89b193","method":"GET","path":"/api/gap-analysis/reports/test-report-id","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:17.845Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_start","traceId":"9013acd9-ff06-46ab-b9f6-65dd0c8be02d","spanId":"b3d36844","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.852Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m[32m2026-01-17T16:06:17.853Z [INFO] PATCH /api/gap-analysis/recommendations/test-rec-id {"method":"PATCH","url":"/api/gap-analysis/recommendations/test-rec-id","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.853Z"}[0m
[32m2026-01-17T16:06:17.854Z [INFO] API route accessed {"path":"/api/gap-analysis/recommendations/test-rec-id","method":"PATCH","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRemediation Tracking[2m > [22m[2mshould require authentication for remediation updates
[22m[39m{"type":"request_end","traceId":"9013acd9-ff06-46ab-b9f6-65dd0c8be02d","spanId":"b3d36844","method":"PATCH","path":"/api/gap-analysis/recommendations/test-rec-id","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:17.856Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_start","traceId":"1d2d9a76-9a36-4d5d-8f24-a6d0f8ec769b","spanId":"b9cc62bb","method":"POST","path":"/api/risk-assessment","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.866Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_start","traceId":"9a92041d-2f8d-4c03-a7cb-9746d42a3c06","spanId":"e939dff8","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.865Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m[32m2026-01-17T16:06:17.868Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.868Z"}[0m
[32m2026-01-17T16:06:17.872Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould return document templates
[22m[39m{"type":"request_end","traceId":"9a92041d-2f8d-4c03-a7cb-9746d42a3c06","spanId":"e939dff8","method":"GET","path":"/","statusCode":200,"duration":25,"timestamp":"2026-01-17T16:06:17.889Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests
[22m[39m[32m2026-01-17T16:06:17.953Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Risk Assessment > should handle risk assessment requests
[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m[32m2026-01-17T16:06:17.866Z [INFO] POST /api/risk-assessment {"method":"POST","url":"/api/risk-assessment","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.866Z"}[0m
2026-01-17T16:06:17.866Z [WARN] Unknown API route accessed {"path":"/api/risk-assessment","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}


[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mRisk Assessment[2m > [22m[2mshould handle risk assessment requests
[22m[39m{"type":"request_end","traceId":"1d2d9a76-9a36-4d5d-8f24-a6d0f8ec769b","spanId":"b9cc62bb","method":"POST","path":"/api/risk-assessment","statusCode":401,"duration":116,"timestamp":"2026-01-17T16:06:17.982Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_start","traceId":"6ecdcab5-4420-4e4f-bacb-f8cb363bfecf","spanId":"f6e9c044","method":"POST","path":"/api/analyze-compliance-gaps","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:17.987Z"}

stderr | tests/integration/gap-analysis.test.ts > Gap Analysis Integration Tests > Compliance Scoring > should calculate compliance score
2026-01-17T16:06:17.988Z [WARN] Unknown API route accessed {"path":"/api/analyze-compliance-gaps","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m[32m2026-01-17T16:06:17.988Z [INFO] POST /api/analyze-compliance-gaps {"method":"POST","url":"/api/analyze-compliance-gaps","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:17.988Z"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mCompliance Scoring[2m > [22m[2mshould calculate compliance score
[22m[39m{"type":"request_end","traceId":"6ecdcab5-4420-4e4f-bacb-f8cb363bfecf","spanId":"f6e9c044","method":"POST","path":"/api/analyze-compliance-gaps","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:17.990Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return system health status
[22m[39m[32m2026-01-17T16:06:18.053Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.053Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests
[22m[39m[32m2026-01-17T16:06:18.060Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_start","traceId":"edac5878-78e8-495b-8e3d-c26475f2db2a","spanId":"7b16f157","method":"POST","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.186Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m[32m2026-01-17T16:06:18.189Z [INFO] POST /api/organizations {"method":"POST","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.189Z"}[0m
[32m2026-01-17T16:06:18.193Z [INFO] API route accessed {"path":"/api/organizations","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_start","traceId":"c7b84008-216d-4152-bdc7-40e9d970b35f","spanId":"01d5f69d","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.198Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m[32m2026-01-17T16:06:18.199Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.199Z"}[0m
[32m2026-01-17T16:06:18.199Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mAI-Powered Analysis[2m > [22m[2mshould require authentication for AI gap analysis
[22m[39m{"type":"request_end","traceId":"c7b84008-216d-4152-bdc7-40e9d970b35f","spanId":"01d5f69d","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":10,"timestamp":"2026-01-17T16:06:18.208Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_start","traceId":"f71922f0-8973-4165-80a6-e4ede5505952","spanId":"770c477e","method":"GET","path":"/api/frameworks/SOC2/required-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.216Z"}

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m[32m2026-01-17T16:06:18.216Z [INFO] GET /api/frameworks/SOC2/required-templates {"method":"GET","url":"/api/frameworks/SOC2/required-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.216Z"}[0m
[32m2026-01-17T16:06:18.217Z [INFO] API route accessed {"path":"/api/frameworks/SOC2/required-templates","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/gap-analysis.test.ts[2m > [22m[2mGap Analysis Integration Tests[2m > [22m[2mFramework Requirements[2m > [22m[2mshould return framework control requirements
[22m[39m{"type":"request_end","traceId":"f71922f0-8973-4165-80a6-e4ede5505952","spanId":"770c477e","method":"GET","path":"/api/frameworks/SOC2/required-templates","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:06:18.222Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/gap-analysis.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 956[2mms[22m[39m
[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication for organization creation
[22m[39m{"type":"request_end","traceId":"edac5878-78e8-495b-8e3d-c26475f2db2a","spanId":"7b16f157","method":"POST","path":"/api/organizations","statusCode":401,"duration":194,"timestamp":"2026-01-17T16:06:18.380Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_start","traceId":"685127cf-2c9d-4552-bec0-3ba8e05d8131","spanId":"ff439068","method":"GET","path":"/api/organizations","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.392Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m[32m2026-01-17T16:06:18.394Z [INFO] GET /api/organizations {"method":"GET","url":"/api/organizations","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.394Z"}[0m
[32m2026-01-17T16:06:18.395Z [INFO] API route accessed {"path":"/api/organizations","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mOrganization Setup[2m > [22m[2mshould require authentication to list organizations
[22m[39m{"type":"request_end","traceId":"685127cf-2c9d-4552-bec0-3ba8e05d8131","spanId":"ff439068","method":"GET","path":"/api/organizations","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:06:18.399Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"d201d3ef-b692-4d73-b696-e56c2da771e6","spanId":"c68993bc","method":"GET","path":"/api/document-templates","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.431Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:06:18.433Z [INFO] GET /api/document-templates {"method":"GET","url":"/api/document-templates","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.433Z"}[0m
[32m2026-01-17T16:06:18.434Z [INFO] API route accessed {"path":"/api/document-templates","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T16:06:18.435Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_start","traceId":"1c4858f3-6366-4f6f-a1ba-0a815683f295","spanId":"2ddb0646","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.450Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m[32m2026-01-17T16:06:18.451Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.451Z"}[0m
[32m2026-01-17T16:06:18.452Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication for company profile creation
[22m[39m{"type":"request_end","traceId":"1c4858f3-6366-4f6f-a1ba-0a815683f295","spanId":"2ddb0646","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.453Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_start","traceId":"dcc1814c-293c-43c8-aa61-51a088511cdb","spanId":"b000fe39","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.459Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m[32m2026-01-17T16:06:18.460Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.460Z"}[0m
[32m2026-01-17T16:06:18.461Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mCompany Profile Creation[2m > [22m[2mshould require authentication to get company profile
[22m[39m{"type":"request_end","traceId":"dcc1814c-293c-43c8-aa61-51a088511cdb","spanId":"b000fe39","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:18.463Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"d201d3ef-b692-4d73-b696-e56c2da771e6","spanId":"c68993bc","method":"GET","path":"/","statusCode":200,"duration":35,"timestamp":"2026-01-17T16:06:18.466Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_start","traceId":"32768177-1e5f-4624-8616-4623dd89ab34","spanId":"9bcab64b","method":"PATCH","path":"/api/company-profiles/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.473Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m[32m2026-01-17T16:06:18.473Z [INFO] PATCH /api/company-profiles/1 {"method":"PATCH","url":"/api/company-profiles/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.473Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Onboarding Flow > Initial Framework Selection > should require authentication to update framework preferences
2026-01-17T16:06:18.474Z [WARN] Unknown API route accessed {"path":"/api/company-profiles/1","method":"PATCH","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mOnboarding Flow[2m > [22m[2mInitial Framework Selection[2m > [22m[2mshould require authentication to update framework preferences
[22m[39m{"type":"request_end","traceId":"32768177-1e5f-4624-8616-4623dd89ab34","spanId":"9bcab64b","method":"PATCH","path":"/api/company-profiles/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.476Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_start","traceId":"b91515e6-f9ce-4ab3-aed7-ca766c20e8a4","spanId":"3ad02ea6","method":"GET","path":"/api/document-templates/iso-001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.485Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m[32m2026-01-17T16:06:18.486Z [INFO] GET /api/document-templates/iso-001 {"method":"GET","url":"/api/document-templates/iso-001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.486Z"}[0m
[32m2026-01-17T16:06:18.487Z [INFO] API route accessed {"path":"/api/document-templates/iso-001","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Templates[2m > [22m[2mshould get a specific template by ID
[22m[39m{"type":"request_end","traceId":"b91515e6-f9ce-4ab3-aed7-ca766c20e8a4","spanId":"3ad02ea6","method":"GET","path":"/iso-001","statusCode":200,"duration":5,"timestamp":"2026-01-17T16:06:18.490Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_start","traceId":"5534a545-b3d9-44f0-9010-c66056ea7bda","spanId":"a0e3d621","method":"POST","path":"/api/ai/generate-compliance-docs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.509Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m[32m2026-01-17T16:06:18.510Z [INFO] POST /api/ai/generate-compliance-docs {"method":"POST","url":"/api/ai/generate-compliance-docs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.510Z"}[0m
[32m2026-01-17T16:06:18.510Z [INFO] API route accessed {"path":"/api/ai/generate-compliance-docs","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document generation
[22m[39m{"type":"request_end","traceId":"5534a545-b3d9-44f0-9010-c66056ea7bda","spanId":"a0e3d621","method":"POST","path":"/api/ai/generate-compliance-docs","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.512Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_start","traceId":"04e9b1fd-d4c6-4299-8218-e9b3c8838889","spanId":"4e8f0f61","method":"POST","path":"/api/ai/analyze-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.521Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m[32m2026-01-17T16:06:18.521Z [INFO] POST /api/ai/analyze-document {"method":"POST","url":"/api/ai/analyze-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.521Z"}[0m
[32m2026-01-17T16:06:18.522Z [INFO] API route accessed {"path":"/api/ai/analyze-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould require authentication for AI document analysis
[22m[39m{"type":"request_end","traceId":"04e9b1fd-d4c6-4299-8218-e9b3c8838889","spanId":"4e8f0f61","method":"POST","path":"/api/ai/analyze-document","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:18.525Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mDocument Generation[2m > [22m[2mshould return AI service health status
[22m[39m[32m2026-01-17T16:06:18.537Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.537Z"}[0m
[32m2026-01-17T16:06:18.537Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T16:06:18.540Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.540Z"}[0m

stderr | tests/integration/api.test.ts > API Integration Tests > Health Endpoints > should return system health status
2026-01-17T16:06:18.547Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_start","traceId":"5d80a362-7f1a-4706-9e79-e54c9f5d559f","spanId":"63eabd97","method":"POST","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.548Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication for evidence upload
2026-01-17T16:06:18.549Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m[32m2026-01-17T16:06:18.549Z [INFO] POST /api/evidence {"method":"POST","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.549Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication for evidence upload
[22m[39m{"type":"request_end","traceId":"5d80a362-7f1a-4706-9e79-e54c9f5d559f","spanId":"63eabd97","method":"POST","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.551Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_start","traceId":"b270cbd1-2bcf-4ed1-b54c-6c7ae29c9e1d","spanId":"2951980a","method":"GET","path":"/api/evidence","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.561Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m[32m2026-01-17T16:06:18.561Z [INFO] GET /api/evidence {"method":"GET","url":"/api/evidence","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.561Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Evidence Upload > should require authentication to list evidence
2026-01-17T16:06:18.562Z [WARN] Unknown API route accessed {"path":"/api/evidence","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mEvidence Upload[2m > [22m[2mshould require authentication to list evidence
[22m[39m{"type":"request_end","traceId":"b270cbd1-2bcf-4ed1-b54c-6c7ae29c9e1d","spanId":"2951980a","method":"GET","path":"/api/evidence","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.564Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_start","traceId":"87a3186d-fda6-4df2-9ba8-4c350d4bfd43","spanId":"4ddb9a31","method":"GET","path":"/api/controls/approvals","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.569Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mHealth Endpoints[2m > [22m[2mshould return AI health status
[22m[39m[32m2026-01-17T16:06:18.566Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.566Z"}[0m
[32m2026-01-17T16:06:18.569Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m[32m2026-01-17T16:06:18.569Z [INFO] GET /api/controls/approvals {"method":"GET","url":"/api/controls/approvals","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.569Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to list pending approvals
2026-01-17T16:06:18.569Z [WARN] Unknown API route accessed {"path":"/api/controls/approvals","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to list pending approvals
[22m[39m{"type":"request_end","traceId":"87a3186d-fda6-4df2-9ba8-4c350d4bfd43","spanId":"4ddb9a31","method":"GET","path":"/api/controls/approvals","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.571Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_start","traceId":"9e41769b-5d21-4a2e-bb7c-e6d57fc0051f","spanId":"3a4100d2","method":"POST","path":"/api/controls/1/approve","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.576Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m[32m2026-01-17T16:06:18.576Z [INFO] POST /api/controls/1/approve {"method":"POST","url":"/api/controls/1/approve","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.576Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > AI Generation Flow > Control Approvals > should require authentication to approve a control
2026-01-17T16:06:18.577Z [WARN] Unknown API route accessed {"path":"/api/controls/1/approve","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAI Generation Flow[2m > [22m[2mControl Approvals[2m > [22m[2mshould require authentication to approve a control
[22m[39m{"type":"request_end","traceId":"9e41769b-5d21-4a2e-bb7c-e6d57fc0051f","spanId":"3a4100d2","method":"POST","path":"/api/controls/1/approve","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.579Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_start","traceId":"b7ee5743-63b9-4274-8627-287ea14b65ab","spanId":"f6050e3f","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.581Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Audit Trail Access > should require authentication to view audit trail
2026-01-17T16:06:18.641Z [WARN] Unknown API route accessed {"path":"/api/audit-trail","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_start","traceId":"f4c91f56-ba97-4f47-be01-e3b33eb5760a","spanId":"f4601a4a","method":"GET","path":"/api/audit-trail","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.638Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m[32m2026-01-17T16:06:18.639Z [INFO] GET /api/audit-trail {"method":"GET","url":"/api/audit-trail","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.639Z"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m[32m2026-01-17T16:06:18.583Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.583Z"}[0m
[32m2026-01-17T16:06:18.583Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for user profile
[22m[39m{"type":"request_end","traceId":"b7ee5743-63b9-4274-8627-287ea14b65ab","spanId":"f6050e3f","method":"GET","path":"/api/auth/user","statusCode":401,"duration":67,"timestamp":"2026-01-17T16:06:18.648Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_start","traceId":"a4f50e5e-3471-48e8-9fd6-10e07cc8d54a","spanId":"0dbee82d","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.671Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"8239ee85-cb17-4fb4-8fa3-1edf22cb2b18","spanId":"a1b7cd5e","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.672Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m[32m2026-01-17T16:06:18.671Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.671Z"}[0m
[32m2026-01-17T16:06:18.672Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for company profiles
[22m[39m{"type":"request_end","traceId":"a4f50e5e-3471-48e8-9fd6-10e07cc8d54a","spanId":"0dbee82d","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:18.675Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:06:18.672Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.672Z"}[0m
[32m2026-01-17T16:06:18.673Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_start","traceId":"8dc8fd56-071b-4dbf-9e8b-3a8281322f8f","spanId":"5946f6cf","method":"GET","path":"/api/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.681Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"8239ee85-cb17-4fb4-8fa3-1edf22cb2b18","spanId":"a1b7cd5e","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:06:18.679Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m[32m2026-01-17T16:06:18.682Z [INFO] GET /api/documents {"method":"GET","url":"/api/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.682Z"}[0m
[32m2026-01-17T16:06:18.683Z [INFO] API route accessed {"path":"/api/documents","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to view audit trail
[22m[39m{"type":"request_end","traceId":"f4c91f56-ba97-4f47-be01-e3b33eb5760a","spanId":"f4601a4a","method":"GET","path":"/api/audit-trail","statusCode":401,"duration":8,"timestamp":"2026-01-17T16:06:18.646Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_start","traceId":"f96665c3-3a05-4273-ac40-b2b5d8804c31","spanId":"84624a7d","method":"POST","path":"/api/documents/upload-and-extract","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.686Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mAuthentication Required Endpoints[2m > [22m[2mshould require authentication for documents
[22m[39m{"type":"request_end","traceId":"8dc8fd56-071b-4dbf-9e8b-3a8281322f8f","spanId":"5946f6cf","method":"GET","path":"/api/documents","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:18.685Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m[32m2026-01-17T16:06:18.686Z [INFO] POST /api/documents/upload-and-extract {"method":"POST","url":"/api/documents/upload-and-extract","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.686Z"}[0m
[32m2026-01-17T16:06:18.687Z [INFO] API route accessed {"path":"/api/documents/upload-and-extract","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_start","traceId":"5680b7e1-79cc-4eba-9cec-ebc4ab3fc35e","spanId":"817e1f08","method":"GET","path":"/api/audit-trail/1","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.733Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Generation Endpoints[2m > [22m[2mshould require authentication for document upload
[22m[39m{"type":"request_end","traceId":"f96665c3-3a05-4273-ac40-b2b5d8804c31","spanId":"84624a7d","method":"POST","path":"/api/documents/upload-and-extract","statusCode":401,"duration":48,"timestamp":"2026-01-17T16:06:18.738Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m[32m2026-01-17T16:06:18.733Z [INFO] GET /api/audit-trail/1 {"method":"GET","url":"/api/audit-trail/1","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.733Z"}[0m
[32m2026-01-17T16:06:18.734Z [INFO] API route accessed {"path":"/api/audit-trail/1","method":"GET","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAudit Trail Access[2m > [22m[2mshould require authentication to get audit entry details
[22m[39m{"type":"request_end","traceId":"5680b7e1-79cc-4eba-9cec-ebc4ab3fc35e","spanId":"817e1f08","method":"GET","path":"/api/audit-trail/1","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.736Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_start","traceId":"ef2a94c2-f409-4786-825c-22b1598dfa0b","spanId":"5ea4a05b","method":"GET","path":"/api/auditor/documents","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.740Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication for auditor workspace access
2026-01-17T16:06:18.741Z [WARN] Unknown API route accessed {"path":"/api/auditor/documents","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m[32m2026-01-17T16:06:18.741Z [INFO] GET /api/auditor/documents {"method":"GET","url":"/api/auditor/documents","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.741Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication for auditor workspace access
[22m[39m{"type":"request_end","traceId":"ef2a94c2-f409-4786-825c-22b1598dfa0b","spanId":"5ea4a05b","method":"GET","path":"/api/auditor/documents","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:06:18.742Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_start","traceId":"c77d2290-ce9a-4b00-8aa1-3076b6787d24","spanId":"1f2154d3","method":"GET","path":"/api/auditor/overview","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.747Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to view compliance overview
2026-01-17T16:06:18.748Z [WARN] Unknown API route accessed {"path":"/api/auditor/overview","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m[32m2026-01-17T16:06:18.747Z [INFO] GET /api/auditor/overview {"method":"GET","url":"/api/auditor/overview","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.747Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to view compliance overview
[22m[39m{"type":"request_end","traceId":"c77d2290-ce9a-4b00-8aa1-3076b6787d24","spanId":"1f2154d3","method":"GET","path":"/api/auditor/overview","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:06:18.749Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_start","traceId":"b98806d8-db52-40a9-81fe-863d4adb89db","spanId":"8d91fbce","method":"GET","path":"/api/auditor/export","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.753Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m[32m2026-01-17T16:06:18.753Z [INFO] GET /api/auditor/export {"method":"GET","url":"/api/auditor/export","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.753Z"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Auditor Workspace > should require authentication to export audit reports
2026-01-17T16:06:18.754Z [WARN] Unknown API route accessed {"path":"/api/auditor/export","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mAuditor Workspace[2m > [22m[2mshould require authentication to export audit reports
[22m[39m{"type":"request_end","traceId":"b98806d8-db52-40a9-81fe-863d4adb89db","spanId":"8d91fbce","method":"GET","path":"/api/auditor/export","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.756Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"8d0771ec-7267-48c0-afe5-f4d5685ab316","spanId":"328697d6","method":"GET","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.760Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Audit Flow > Gap Analysis > should require authentication for gap analysis
2026-01-17T16:06:18.764Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:06:18.763Z [INFO] GET /api/gap-analysis {"method":"GET","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.763Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"8d0771ec-7267-48c0-afe5-f4d5685ab316","spanId":"328697d6","method":"GET","path":"/api/gap-analysis","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:06:18.766Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_start","traceId":"a6f3df61-6a3a-4cb5-aa1b-572908bd19d3","spanId":"8504f7d3","method":"GET","path":"/api/gap-analysis/ISO27001","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.772Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m[32m2026-01-17T16:06:18.772Z [INFO] GET /api/gap-analysis/ISO27001 {"method":"GET","url":"/api/gap-analysis/ISO27001","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.772Z"}[0m
[32m2026-01-17T16:06:18.773Z [INFO] API route accessed {"path":"/api/gap-analysis/ISO27001","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mAudit Flow[2m > [22m[2mGap Analysis[2m > [22m[2mshould require authentication for gap analysis by framework
[22m[39m{"type":"request_end","traceId":"a6f3df61-6a3a-4cb5-aa1b-572908bd19d3","spanId":"8504f7d3","method":"GET","path":"/api/gap-analysis/ISO27001","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:06:18.774Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_start","traceId":"dfc55391-1ea8-464b-ab74-a931b9133ad9","spanId":"ece7f7ea","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.803Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m[32m2026-01-17T16:06:18.804Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.804Z"}[0m
[32m2026-01-17T16:06:18.804Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould export document as markdown
[22m[39m{"type":"request_end","traceId":"dfc55391-1ea8-464b-ab74-a931b9133ad9","spanId":"ece7f7ea","method":"POST","path":"/export-document","statusCode":200,"duration":4,"timestamp":"2026-01-17T16:06:18.807Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_start","traceId":"b33831ce-fc06-4a29-b679-5122e6dc78cc","spanId":"8071553d","method":"POST","path":"/api/export-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.822Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_start","traceId":"8e46e9ad-5d09-4c87-a886-ba6e36969629","spanId":"829fef32","method":"POST","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.822Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m[32m2026-01-17T16:06:18.822Z [INFO] POST /api/export-document {"method":"POST","url":"/api/export-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.822Z"}[0m
[32m2026-01-17T16:06:18.823Z [INFO] API route accessed {"path":"/api/export-document","method":"POST","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Export[2m > [22m[2mshould handle export without content
[22m[39m{"type":"request_end","traceId":"b33831ce-fc06-4a29-b679-5122e6dc78cc","spanId":"8071553d","method":"POST","path":"/export-document","statusCode":400,"duration":3,"timestamp":"2026-01-17T16:06:18.825Z"}

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m[32m2026-01-17T16:06:18.823Z [INFO] POST /api/company-profiles {"method":"POST","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.823Z"}[0m
[32m2026-01-17T16:06:18.824Z [INFO] API route accessed {"path":"/api/company-profiles","method":"POST","requiresAuth":true,"requiresMfa":true,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/api.test.ts[2m > [22m[2mAPI Integration Tests[2m > [22m[2mData Validation[2m > [22m[2mshould validate company profile creation payload
[22m[39m{"type":"request_end","traceId":"8e46e9ad-5d09-4c87-a886-ba6e36969629","spanId":"829fef32","method":"POST","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:18.826Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/api.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 1016[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m API Integration Tests[2m > [22mHealth Endpoints[2m > [22mshould return system health status [33m 536[2mms[22m[39m
stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T16:06:18.850Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_start","traceId":"2fdd55f6-f32f-4bb7-8c0b-488865012b82","spanId":"33bf303d","method":"GET","path":"/api/documents/1/history","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.858Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m[32m2026-01-17T16:06:18.858Z [INFO] GET /api/documents/1/history {"method":"GET","url":"/api/documents/1/history","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.858Z"}[0m
[32m2026-01-17T16:06:18.859Z [INFO] API route accessed {"path":"/api/documents/1/history","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mDocument to Audit Trail[2m > [22m[2mshould require authentication to track document changes
[22m[39m{"type":"request_end","traceId":"2fdd55f6-f32f-4bb7-8c0b-488865012b82","spanId":"33bf303d","method":"GET","path":"/api/documents/1/history","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.861Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_start","traceId":"131b0bc4-85c3-4497-b870-8143eb8ea4ba","spanId":"8ba3e56a","method":"POST","path":"/api/evidence/1/controls","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.868Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T16:06:18.866Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.866Z"}[0m
[32m2026-01-17T16:06:18.869Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > Evidence to Control Mapping > should require authentication to map evidence to controls
2026-01-17T16:06:18.872Z [WARN] Unknown API route accessed {"path":"/api/evidence/1/controls","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m[32m2026-01-17T16:06:18.868Z [INFO] POST /api/evidence/1/controls {"method":"POST","url":"/api/evidence/1/controls","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.868Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mEvidence to Control Mapping[2m > [22m[2mshould require authentication to map evidence to controls
[22m[39m{"type":"request_end","traceId":"131b0bc4-85c3-4497-b870-8143eb8ea4ba","spanId":"8ba3e56a","method":"POST","path":"/api/evidence/1/controls","statusCode":401,"duration":5,"timestamp":"2026-01-17T16:06:18.873Z"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_start","traceId":"d0a8e0f4-60c8-4aae-a57c-959e1439d840","spanId":"7959cd27","method":"GET","path":"/api/ai/stats","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.878Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"ddaefc64-3d38-4e2e-bd66-b951097acb54","spanId":"29454c54","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.878Z"}

stderr | tests/integration/e2e-flows.test.ts > E2E Flow Tests > Cross-Flow Integration > AI Hub Stats > should require authentication for AI stats
2026-01-17T16:06:18.879Z [WARN] Unknown API route accessed {"path":"/api/ai/stats","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m[32m2026-01-17T16:06:18.879Z [INFO] GET /api/ai/stats {"method":"GET","url":"/api/ai/stats","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.879Z"}[0m

[90mstdout[2m | tests/integration/e2e-flows.test.ts[2m > [22m[2mE2E Flow Tests[2m > [22m[2mCross-Flow Integration[2m > [22m[2mAI Hub Stats[2m > [22m[2mshould require authentication for AI stats
[22m[39m{"type":"request_end","traceId":"d0a8e0f4-60c8-4aae-a57c-959e1439d840","spanId":"7959cd27","method":"GET","path":"/api/ai/stats","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.881Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/e2e-flows.test.ts [2m([22m[2m22 tests[22m[2m)[22m[33m 1067[2mms[22m[39m
[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T16:06:18.879Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.879Z"}[0m
[32m2026-01-17T16:06:18.879Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"ddaefc64-3d38-4e2e-bd66-b951097acb54","spanId":"29454c54","method":"GET","path":"/api/auth/user","statusCode":401,"duration":11,"timestamp":"2026-01-17T16:06:18.889Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_start","traceId":"ff58780e-3cf7-4fa3-913c-564a0094b275","spanId":"1973c88e","method":"POST","path":"/api/generate-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.892Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m[32m2026-01-17T16:06:18.893Z [INFO] POST /api/generate-document {"method":"POST","url":"/api/generate-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.893Z"}[0m
[32m2026-01-17T16:06:18.893Z [INFO] API route accessed {"path":"/api/generate-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"41cd3bb3-8f4c-4aba-81a6-b762a9677d01","spanId":"d0a5540c","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.894Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument AI Generation[2m > [22m[2mshould reject generation request without framework
[22m[39m{"type":"request_end","traceId":"ff58780e-3cf7-4fa3-913c-564a0094b275","spanId":"1973c88e","method":"POST","path":"/api/generate-document","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.895Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T16:06:18.894Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.894Z"}[0m
[32m2026-01-17T16:06:18.894Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"41cd3bb3-8f4c-4aba-81a6-b762a9677d01","spanId":"d0a5540c","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.897Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_start","traceId":"b9fbdff7-761f-49f9-85cb-a93371367480","spanId":"ace8d851","method":"POST","path":"/api/analyze-document-quality","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.906Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m[32m2026-01-17T16:06:18.907Z [INFO] POST /api/analyze-document-quality {"method":"POST","url":"/api/analyze-document-quality","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.907Z"}[0m
[32m2026-01-17T16:06:18.907Z [INFO] API route accessed {"path":"/api/analyze-document-quality","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Quality Analysis[2m > [22m[2mshould require authentication for document quality analysis
[22m[39m{"type":"request_end","traceId":"b9fbdff7-761f-49f9-85cb-a93371367480","spanId":"ace8d851","method":"POST","path":"/api/analyze-document-quality","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.909Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_start","traceId":"73f68efc-03db-439d-988e-8e993ea4e5e6","spanId":"d1975d5f","method":"GET","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.920Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m[32m2026-01-17T16:06:18.920Z [INFO] GET /api/documents/test-id/versions {"method":"GET","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.920Z"}[0m
[32m2026-01-17T16:06:18.921Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version history
[22m[39m{"type":"request_end","traceId":"73f68efc-03db-439d-988e-8e993ea4e5e6","spanId":"d1975d5f","method":"GET","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.923Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_start","traceId":"45245775-66a3-4fb5-9175-52e789256065","spanId":"46c63f84","method":"POST","path":"/api/documents/test-id/versions","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.929Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m[32m2026-01-17T16:06:18.930Z [INFO] POST /api/documents/test-id/versions {"method":"POST","url":"/api/documents/test-id/versions","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.930Z"}[0m
[32m2026-01-17T16:06:18.930Z [INFO] API route accessed {"path":"/api/documents/test-id/versions","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version creation
[22m[39m{"type":"request_end","traceId":"45245775-66a3-4fb5-9175-52e789256065","spanId":"46c63f84","method":"POST","path":"/api/documents/test-id/versions","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:18.932Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_start","traceId":"fc54015b-02aa-4497-940e-90ca0649019c","spanId":"10ed8b71","method":"POST","path":"/api/documents/123/versions/1/restore","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.943Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m[32m2026-01-17T16:06:18.944Z [INFO] POST /api/documents/123/versions/1/restore {"method":"POST","url":"/api/documents/123/versions/1/restore","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.944Z"}[0m
[32m2026-01-17T16:06:18.947Z [INFO] API route accessed {"path":"/api/documents/123/versions/1/restore","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Versioning[2m > [22m[2mshould require authentication for version restore
[22m[39m{"type":"request_end","traceId":"fc54015b-02aa-4497-940e-90ca0649019c","spanId":"10ed8b71","method":"POST","path":"/api/documents/123/versions/1/restore","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:06:18.949Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_start","traceId":"1ac0e921-88a4-4591-9630-4f58e65707cd","spanId":"e09a4343","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.954Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m[32m2026-01-17T16:06:18.954Z [INFO] GET /api/documents/test-id/versions/1/compare/2 {"method":"GET","url":"/api/documents/test-id/versions/1/compare/2","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.954Z"}[0m
[32m2026-01-17T16:06:18.955Z [INFO] API route accessed {"path":"/api/documents/test-id/versions/1/compare/2","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Comparison[2m > [22m[2mshould require authentication for version comparison
[22m[39m{"type":"request_end","traceId":"1ac0e921-88a4-4591-9630-4f58e65707cd","spanId":"e09a4343","method":"GET","path":"/api/documents/test-id/versions/1/compare/2","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:06:18.956Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_start","traceId":"bd58f8f2-04d4-4de6-b82c-09fd32d93d7f","spanId":"80f1e2b3","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.961Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m[32m2026-01-17T16:06:18.962Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.962Z"}[0m
[32m2026-01-17T16:06:18.962Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould save a document with valid data
[22m[39m{"type":"request_end","traceId":"bd58f8f2-04d4-4de6-b82c-09fd32d93d7f","spanId":"80f1e2b3","method":"POST","path":"/api/save-document","statusCode":401,"duration":6,"timestamp":"2026-01-17T16:06:18.967Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_start","traceId":"29d57e65-a58a-4414-89d3-fe0301a190b3","spanId":"47c263b5","method":"POST","path":"/api/save-document","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:18.972Z"}

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m[32m2026-01-17T16:06:18.972Z [INFO] POST /api/save-document {"method":"POST","url":"/api/save-document","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:18.972Z"}[0m
[32m2026-01-17T16:06:18.973Z [INFO] API route accessed {"path":"/api/save-document","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/documents.test.ts[2m > [22m[2mDocument Integration Tests[2m > [22m[2mDocument Saving[2m > [22m[2mshould reject save request without required fields
[22m[39m{"type":"request_end","traceId":"29d57e65-a58a-4414-89d3-fe0301a190b3","spanId":"47c263b5","method":"POST","path":"/api/save-document","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:06:18.979Z"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/documents.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 1283[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould return document templates [33m 322[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Document Integration Tests[2m > [22mDocument Templates[2m > [22mshould get a specific template by ID [33m 331[2mms[22m[39m
[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"c266b484-fbfb-4f81-a797-2b0153200683","spanId":"a194b863","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:19.018Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:06:19.019Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:19.019Z"}[0m
[32m2026-01-17T16:06:19.020Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"c266b484-fbfb-4f81-a797-2b0153200683","spanId":"a194b863","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:19.022Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"c784181b-ebe6-43d7-9083-9e2757f4ad41","spanId":"525a28f7","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:19.029Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T16:06:19.030Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:06:19.030Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:19.030Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"c784181b-ebe6-43d7-9083-9e2757f4ad41","spanId":"525a28f7","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:06:19.032Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"903b900f-35e8-4fa9-911e-d8e2caa725e3","spanId":"f23f7381","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:19.061Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m[32m2026-01-17T16:06:19.061Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:19.061Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T16:06:19.062Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"903b900f-35e8-4fa9-911e-d8e2caa725e3","spanId":"f23f7381","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":7,"timestamp":"2026-01-17T16:06:19.067Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"fcdc709e-1dd1-4f76-b6d6-7b9546f8c30a","spanId":"9d66d34b","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:19.076Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T16:06:19.077Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:19.077Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"fcdc709e-1dd1-4f76-b6d6-7b9546f8c30a","spanId":"9d66d34b","method":"POST","path":"/api/auth/mfa/setup","statusCode":400,"duration":2,"timestamp":"2026-01-17T16:06:19.078Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"d47e09ca-19d7-4e18-bd7c-4051e5bd6d12","spanId":"dd107ca3","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:06:19.085Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T16:06:19.086Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:19.086Z"}[0m
[32m2026-01-17T16:06:19.087Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"d47e09ca-19d7-4e18-bd7c-4051e5bd6d12","spanId":"dd107ca3","method":"GET","path":"/api/auth/user","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:06:19.089Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T16:06:19.168Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:19.168Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T16:06:19.178Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T16:06:19.183Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:06:19.183Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T16:06:19.227Z [ERROR] Database health check failed {"error":"Unknown error"}

 [31mÎ“Â¥Â»[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m | [22m[31m1 failed[39m[2m)[22m[33m 1099[2mms[22m[39m
   [33m[2mÎ“Â£Ã´[22m[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to health check [33m 344[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mPublic Endpoints[2m > [22mshould allow access to AI health endpoint[32m 13[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/auth/user[32m 17[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for /api/company-profiles[32m 7[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for document generation[32m 127[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for gap analysis[32m 9[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for audit logs[32m 36[2mms[22m[39m
[31m   [31mâ”œÃ¹[31m Authentication Integration Tests[2m > [22mProtected Endpoints[2m > [22mshould require authentication for MFA setup[39m[32m 11[2mms[22m[39m
[31m     Î“Ã¥Ã† expected 401 "Unauthorized", got 400 "Bad Request"[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSession Handling[2m > [22mshould return 401 for invalid session[32m 79[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mRate Limiting[2m > [22mshould include rate limit headers[32m 19[2mms[22m[39m
   [32mÎ“Â£Ã´[39m Authentication Integration Tests[2m > [22mSecurity Headers[2m > [22mshould include security headers[32m 53[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 1 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL   unit  tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for MFA setup
Error: expected 401 "Unauthorized", got 400 "Bad Request"
 Î“Â¥Â» tests/integration/auth.test.ts:83:10
     81|       await request(app)
     82|         .post('/api/auth/mfa/setup')
     83|         .expect(401);
       |          ^
     84|     });
     85|   });
 Î“Â¥Â» Test._assertStatus node_modules/supertest/lib/test.js:309:14
 Î“Â¥Â» node_modules/supertest/lib/test.js:365:13
 Î“Â¥Â» Test._assertFunction node_modules/supertest/lib/test.js:342:13
 Î“Â¥Â» Test.assert node_modules/supertest/lib/test.js:195:23
 Î“Â¥Â» localAssert node_modules/supertest/lib/test.js:138:14
 Î“Â¥Â» Server.<anonymous> node_modules/supertest/lib/test.js:152:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/1]Î“Ã„Â»


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m4 passed[39m[22m[90m (5)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m67 passed[39m[22m[90m (68)[39m
[2m   Start at [22m 08:06:09
[2m   Duration [22m 42.59s

[1m[41m FAIL [49m[22m [31mTests failed. Watching for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
c[3J[1m[44m RERUN [49m[22m [34m[2mtests/integration/auth.test.ts [22m[34mx28 [34m[39m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests
[22m[39m[32m2026-01-17T16:07:57.075Z [INFO] API documentation disabled in production (set ENABLE_SWAGGER=true to enable)[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to health check
[22m[39m[32m2026-01-17T16:07:57.159Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.159Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Public Endpoints > should allow access to health check
2026-01-17T16:07:57.224Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mPublic Endpoints[2m > [22m[2mshould allow access to AI health endpoint
[22m[39m[32m2026-01-17T16:07:57.240Z [INFO] GET /api/ai/health {"method":"GET","url":"/api/ai/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.240Z"}[0m
[32m2026-01-17T16:07:57.242Z [INFO] API route accessed {"path":"/api/ai/health","method":"GET","requiresAuth":false,"requiresMfa":false,"rateLimitTier":"low","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_start","traceId":"4260c321-bbad-4069-a66f-1c1477cc3988","spanId":"c6eafbe2","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:07:57.249Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m[32m2026-01-17T16:07:57.250Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.250Z"}[0m
[32m2026-01-17T16:07:57.250Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/auth/user
[22m[39m{"type":"request_end","traceId":"4260c321-bbad-4069-a66f-1c1477cc3988","spanId":"c6eafbe2","method":"GET","path":"/api/auth/user","statusCode":401,"duration":8,"timestamp":"2026-01-17T16:07:57.257Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_start","traceId":"fd8388ed-e862-46ac-8541-d066e97b55e9","spanId":"7faa1735","method":"GET","path":"/api/company-profiles","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:07:57.262Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m[32m2026-01-17T16:07:57.263Z [INFO] GET /api/company-profiles {"method":"GET","url":"/api/company-profiles","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.263Z"}[0m
[32m2026-01-17T16:07:57.263Z [INFO] API route accessed {"path":"/api/company-profiles","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for /api/company-profiles
[22m[39m{"type":"request_end","traceId":"fd8388ed-e862-46ac-8541-d066e97b55e9","spanId":"7faa1735","method":"GET","path":"/api/company-profiles","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:07:57.266Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_start","traceId":"7f2b8650-8e99-419d-af8b-9ad7c882e44c","spanId":"4d1d8ae8","method":"POST","path":"/api/documents/generate","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:07:57.281Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m[32m2026-01-17T16:07:57.281Z [INFO] POST /api/documents/generate {"method":"POST","url":"/api/documents/generate","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.281Z"}[0m
[32m2026-01-17T16:07:57.282Z [INFO] API route accessed {"path":"/api/documents/generate","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for document generation
[22m[39m{"type":"request_end","traceId":"7f2b8650-8e99-419d-af8b-9ad7c882e44c","spanId":"4d1d8ae8","method":"POST","path":"/api/documents/generate","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:07:57.284Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_start","traceId":"83cf2b4f-feca-4375-98e4-a66234d72773","spanId":"868e845d","method":"POST","path":"/api/gap-analysis","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:07:57.289Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for gap analysis
2026-01-17T16:07:57.290Z [WARN] Unknown API route accessed {"path":"/api/gap-analysis","method":"POST","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m[32m2026-01-17T16:07:57.290Z [INFO] POST /api/gap-analysis {"method":"POST","url":"/api/gap-analysis","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.290Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for gap analysis
[22m[39m{"type":"request_end","traceId":"83cf2b4f-feca-4375-98e4-a66234d72773","spanId":"868e845d","method":"POST","path":"/api/gap-analysis","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:07:57.292Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_start","traceId":"d1404fbb-5948-48b2-b4ab-1fec6942730b","spanId":"a0994826","method":"GET","path":"/api/audit-logs","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:07:57.297Z"}

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Protected Endpoints > should require authentication for audit logs
2026-01-17T16:07:57.298Z [WARN] Unknown API route accessed {"path":"/api/audit-logs","method":"GET","ip":"[IP_REDACTED]:[IP_REDACTED]"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m[32m2026-01-17T16:07:57.298Z [INFO] GET /api/audit-logs {"method":"GET","url":"/api/audit-logs","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.298Z"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for audit logs
[22m[39m{"type":"request_end","traceId":"d1404fbb-5948-48b2-b4ab-1fec6942730b","spanId":"a0994826","method":"GET","path":"/api/audit-logs","statusCode":401,"duration":3,"timestamp":"2026-01-17T16:07:57.300Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_start","traceId":"b4251c22-65d7-4928-8d2e-aeda52fb41ed","spanId":"c063e3bd","method":"POST","path":"/api/auth/mfa/setup","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:07:57.304Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m[32m2026-01-17T16:07:57.305Z [INFO] POST /api/auth/mfa/setup {"method":"POST","url":"/api/auth/mfa/setup","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.305Z"}[0m
[32m2026-01-17T16:07:57.305Z [INFO] API route accessed {"path":"/api/auth/mfa/setup","method":"POST","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"high","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mProtected Endpoints[2m > [22m[2mshould require authentication for MFA setup
[22m[39m{"type":"request_end","traceId":"b4251c22-65d7-4928-8d2e-aeda52fb41ed","spanId":"c063e3bd","method":"POST","path":"/setup","statusCode":401,"duration":2,"timestamp":"2026-01-17T16:07:57.306Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_start","traceId":"805ccc5b-b7fb-47d3-9247-8c8fc92e7410","spanId":"ab6cc016","method":"GET","path":"/api/auth/user","ip":"::ffff:127.0.0.1","timestamp":"2026-01-17T16:07:57.310Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m[32m2026-01-17T16:07:57.312Z [INFO] GET /api/auth/user {"method":"GET","url":"/api/auth/user","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.312Z"}[0m
[32m2026-01-17T16:07:57.312Z [INFO] API route accessed {"path":"/api/auth/user","method":"GET","requiresAuth":true,"requiresMfa":false,"rateLimitTier":"medium","ip":"[IP_REDACTED]:[IP_REDACTED]"}[0m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSession Handling[2m > [22m[2mshould return 401 for invalid session
[22m[39m{"type":"request_end","traceId":"805ccc5b-b7fb-47d3-9247-8c8fc92e7410","spanId":"ab6cc016","method":"GET","path":"/api/auth/user","statusCode":401,"duration":4,"timestamp":"2026-01-17T16:07:57.314Z"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mRate Limiting[2m > [22m[2mshould include rate limit headers
[22m[39m[32m2026-01-17T16:07:57.319Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.319Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Rate Limiting > should include rate limit headers
2026-01-17T16:07:57.323Z [ERROR] Database health check failed {"error":"Unknown error"}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuthentication Integration Tests[2m > [22m[2mSecurity Headers[2m > [22m[2mshould include security headers
[22m[39m[32m2026-01-17T16:07:57.330Z [INFO] GET /health {"method":"GET","url":"/health","ip":"[IP_REDACTED]:[IP_REDACTED]","timestamp":"2026-01-17T16:07:57.330Z"}[0m

stderr | tests/integration/auth.test.ts > Authentication Integration Tests > Security Headers > should include security headers
2026-01-17T16:07:57.333Z [ERROR] Database health check failed {"error":"Unknown error"}

 [32mÎ“Â£Ã´[39m [30m[42m unit [49m[39m tests/integration/auth.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 299[2mms[22m[39m

[2m Test Files [22m [1m[32m1 passed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[32m11 passed[39m[22m[90m (11)[39m
[2m   Start at [22m 08:07:54
[2m   Duration [22m 2.70s

[1m[42m PASS [49m[22m [32mWaiting for file changes...[39m
       [2mpress [22m[1mh[22m[2m to show help[22m[2m, [22m[2mpress [22m[1mq[22m[2m to quit[22m
